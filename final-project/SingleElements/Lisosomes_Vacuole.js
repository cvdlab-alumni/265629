
/*Domains*/
var domain1 = INTERVALS(1)(100);
var domain2 = DOMAIN([[0,1],[0,1]])([100,100]);
var domain3 = DOMAIN([[0,1],[0,1],[0,1]])([25,25,1]);


/*Color*/
var mattLightYellow = [255/255, 215/255, 0,1]; 
var mattGold = [218/255, 165/255, 32/255,1];
var mattOrange = [255/255, 165/255, 0, 1];
var mattDarkOrange = [255/255, 140/255, 0, 1];

/*Function*/

/* This function creates an array of knots used by the function nubs. The function takes as input an array of control points. It returns an array of knots. 

   INPUT - An array of points

   OUTPUT - An array of knots.

*/
function knots (point) {
  var k = 2; 
  var m =point.length;
  var n = (m + k + 1);
  var first = 1;
  var last = n - 3;

  var knots = [];

  for (var i = 0; i < 3; i++) {
     knots[i] = 0;
    };

  for (var i = 3; i < last; i++,first++) {
     knots[i] = first;

    };

  for (var i = last; i < n; i++) {
     knots[i] = first;
    };

  return knots;
};

/* This function creates a curve with the function Nubs. The function takes as input an array of control points. It returns to the curve. 

   INPUT - An array of points
   
   OUTPUT - A curve built with the function NUBS

*/
function createNubs (point) {
  
  var knots1 = knots(point);
  var c1 = NUBS(S0)(2)(knots1)(point);
  var curve1 = MAP(c1)(domain1);
  //DRAW(curve1);
  return c1;
}

/* This function creates a 1 grade Bezier curve. The function takes as input an array of curves. It returns to the Bezier curve. 

   INPUT - An array of curves

   OUTPUT - A 1 grade Bezier curve

*/
function createBezierS1(curves) {
  var b1 = BEZIER(S1)(curves);
  var b1Map = MAP(b1)(domain2);
  //DRAW(b1Map);
   return b1;
}

/* This function creates a 1 grade Bezier curve. It takes in input an initial point, a final point and an array of points. It returns the 1 grade Bezier curve. 
 
   INPUT - An initial point, a final point and an array of points.

   OUTPUT - A 1 grade Bezier curve. 

*/
function createCurveSurface(pointStart, pointFinal,points) {
  var nubs = [];
  nubs.push(pointStart);
  var j = 1;
  for(var i=0; i<points.length; i++) {
      nubs[j] = createNubs(points[i]);
      //DRAW(nubs[j]);
      j++;
  }
  nubs.push(pointFinal);

  return createBezierS1(nubs);
    }

/*************************************************************LySOSOME TO THE LEFT OF THE PAIR OF MITHOCONDRIA**********************************************/

//Outer Control point 
  var cp1 =  [[162.1141815185547, 103.88532257080078, 0],[166.30323791503906, 103.75019073486328, 0],[172.2489776611328, 103.75019073486328, 0],[177.24880981445312, 103.75019073486328, 0]];
  var cp2 =  [[154.4117431640625, 107.93923950195312, 0],[164.00601196289062, 107.80410766601562, -9],[175.2218475341797, 107.80410766601562, -9],[184.14047241210938, 108.07437133789062, 0]];
  var cp3 =  [[149.9524383544922, 111.85802459716797, 0],[162.1141815185547, 111.99315643310547, -16],[176.7082977294922, 111.85802459716797, -16],[189.0051727294922, 112.26341247558594, 0]];
  var cp4 =  [[146.5741729736328, 116.99298858642578, 0],[159.9521026611328, 117.26324462890625, -19],[178.87037658691406, 116.85785675048828, -19],[192.38343811035156, 116.99298858642578, 0]];
  var cp5 =  [[144.27694702148438, 122.80360412597656, 0],[158.60079956054688, 123.07386016845703, -20],[181.302734375, 123.34412384033203, -20],[195.35630798339844, 123.47925567626953, 0]];
  var cp6 =  [[144.27694702148438, 130.77630615234375, 0],[158.46566772460938, 130.64117431640625, -20],[181.302734375, 130.91143798828125, -20],[195.49143981933594, 131.45196533203125, 0]];
  var cp7 =  [[146.7093048095703, 136.9923095703125, 0],[160.49261474609375, 137.2625732421875, -19],[179.00550842285156, 137.938232421875, -19],[192.92396545410156, 139.01927185058594, 0]];
  var cp8 =  [[149.5470428466797, 143.61370849609375, 0],[163.1952362060547, 143.61370849609375, -16],[176.5731658935547, 143.61370849609375, -16],[189.1403045654297, 144.9650115966797, 0]];
  var cp9 =  [[154.276611328125, 147.80276489257812, 0],[165.35731506347656, 148.07302856445312, -9],[173.87054443359375, 148.07302856445312, -9],[184.95126342773438, 148.74867248535156, 0]];
  var cp10 =  [[162.5195770263672, 152.66746520996094, 0],[167.38427734375, 152.66746520996094, 0],[172.7895050048828, 152.53233337402344, 0],[177.24880981445312, 152.26206970214844, 0]];

var volumeOut = createCurveSurface([169.41123962402344, 103.88532257080078, 0],[169.95176696777344, 152.66746520996094, 0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10]);
DRAW(COLOR(mattGold)(MAP(volumeOut)(domain2)));

 //Inner Control point 

  var cp1 =  [[162.5195770263672, 106.45279693603516, 0],[167.5194091796875, 106.45279693603516, 0],[171.84359741210938, 106.58792877197266, 0],[176.97854614257812, 106.58792877197266, 0]];
  var cp2 =  [[154.817138671875, 111.99315643310547, 0],[162.1141815185547, 111.99315643310547, -7],[176.7082977294922, 111.85802459716797, -7],[184.95126342773438, 111.99315643310547, 0]];
  var cp3 =  [[150.3578338623047, 117.39837646484375, 0],[159.9521026611328, 117.26324462890625, -15],[179.54603576660156, 117.53350830078125, -15],[190.08621215820312, 117.80377197265625, 0]];
  var cp4 =  [[147.92547607421875, 123.34412384033203, 0],[159.1413116455078, 123.74951934814453, -18],[181.1676025390625, 124.1549072265625, -18],[192.38343811035156, 124.019775390625, 0]];
  var cp5 =  [[147.92547607421875, 130.91143798828125, 0],[158.46566772460938, 130.64117431640625, -18],[181.302734375, 130.91143798828125, -18],[192.11317443847656, 131.04656982421875, 0]];
  var cp6 =  [[150.0875701904297, 136.7220458984375, 0],[160.49261474609375, 137.2625732421875, -16],[179.00550842285156, 137.938232421875, -16],[189.6808319091797, 138.34361267089844, 0]];
  var cp7 =  [[154.1414794921875, 143.61370849609375, 0],[163.73574829101562, 144.15423583984375, -7],[175.7623748779297, 144.42449951171875, -7],[185.08639526367188, 144.69476318359375, 0]];
  var cp8 =  [[163.0601043701172, 149.28919982910156, 0],[167.2491455078125, 149.42433166503906, 0],[171.9787139892578, 149.42433166503906, 0],[176.1677703857422, 149.42433166503906, 0]];
  
var volumeIn = createCurveSurface([169.81663513183594, 106.45279693603516, 0],[169.54637145996094, 149.28919982910156, 0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8]);
//DRAW(volumeIn);

var lysosome3D = MAP(BEZIER(S2)([volumeIn,volumeOut]))(domain3);
DRAW(COLOR(mattLightYellow)(lysosome3D));

/******************************************************************PAIR OF LYSOSOMES ABOVE THE CENTRIOLE*****************************************************/
//Outer Control point 
  var cp1 =  [[78.77911376953125, 153.96864318847656, 0],[82.96263885498047, 153.9113311767578, 0],[86.5157699584961, 153.85401916503906, 0],[90.98583221435547, 153.85401916503906, 0]];
  var cp2 =  [[74.13711547851562, 156.9486846923828, 0],[81.07145690917969, 156.8340606689453, -8],[88.52156829833984, 156.66213989257812, -8],[94.88282012939453, 156.37559509277344, 0]];
  var cp3 =  [[71.50092315673828, 159.69949340820312, 0],[78.7218017578125, 159.4702606201172, -14],[90.58467864990234, 159.35565185546875, -14],[97.46170043945312, 159.1837158203125, 0]];
  var cp4 =  [[69.89628601074219, 163.0233917236328, 0],[77.1171646118164, 162.96607971191406, -18],[92.36124420166016, 162.5076141357422, -18],[99.52481079101562, 162.45030212402344, 0]];
  var cp5 =  [[69.20858001708984, 166.6338348388672, 0],[76.20022583007812, 166.28997802734375, -20],[93.79395294189453, 166.00343322753906, -20],[100.6136703491211, 165.94613647460938, 0]];
  var cp6 =  [[69.2658920288086, 170.35888671875, 0],[76.14291381835938, 170.1869659423828, -20],[93.73664855957031, 169.78579711914062, -20],[100.7282943725586, 169.5565643310547, 0]];
  var cp7 =  [[70.60904693603516, 174.27346801757812, 0],[77.2890853881836, 174.25587463378906, -18],[92.53316497802734, 173.74009704589844, -18],[99.69673919677734, 173.45355224609375, 0]];
  var cp8 =  [[72.24593353271484, 177.5224609375, 0],[78.60718536376953, 177.57977294921875, -14],[90.8712158203125, 177.4078369140625, -14],[97.86286163330078, 177.12130737304688, 0]];
  var cp9 =  [[74.710205078125, 180.559814453125, 0],[81.01414489746094, 180.6744384765625, -8],[88.57887268066406, 180.559814453125, -8],[94.88282012939453, 180.559814453125, 0]];
  var cp10 =  [[78.95103454589844, 183.4825439453125, 0],[83.07725524902344, 183.53985595703125, 0],[86.34384155273438, 183.59716796875, 0],[90.92852783203125, 183.53985595703125, 0],];

var volumeOut = createCurveSurface([84.84607696533203, 153.96864318847656, 0],[84.74455261230469, 183.4825439453125, 0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10]);
var volumeOutMap=(COLOR(mattGold)(MAP(volumeOut)(domain2)));
DRAW(volumeOutMap);

 //Inner Control point 

  var cp1 =  [[80.1759033203125, 156.49356079101562, 0],[83.32319641113281, 156.49356079101562, 0],[86.77506256103516, 156.49356079101562, 0],[90.83609008789062, 156.49356079101562, 0]];
  var cp2 =  [[76.21640014648438, 160.53933715820312, 0],[81.69878387451172, 160.23475646972656, -6],[87.48574829101562, 160.1332244873047, -6],[93.272705078125, 160.93017578125, 0]];
  var cp3 =  [[73.67826080322266, 162.88967895507812, 0],[80.1759033203125, 162.68663024902344, -10],[89.00862884521484, 162.48358154296875, -10],[96.21694946289062, 162.1790008544922, 0]];
  var cp4 =  [[73.06910705566406, 166.24002075195312, 0],[78.95759582519531, 166.03697204589844, -14],[90.02388763427734, 165.83392333984375, -14],[97.13067626953125, 165.73239135742188, 0]];
  var cp5 =  [[72.96758270263672, 170.09799194335938, 0],[78.95759582519531, 170.09799194335938, -14],[89.92235565185547, 169.79342651367188, -14],[97.53678131103516, 169.8949432373047, 0]];
  var cp6 =  [[74.49046325683594, 174.0574951171875, 0],[80.1759033203125, 173.8544464111328, -10],[88.9071044921875, 173.44834899902344, -10],[96.623046875, 173.54986572265625, 0]];
  var cp7 =  [[76.82555389404297, 177.50936889648438, 0],[82.00336456298828, 177.2047882080078, -6],[87.79032135009766, 177.2047882080078, -6],[93.78033447265625, 177.103271484375, 0]];
  var cp8 =  [[78.7545394897461, 179.53988647460938, 0],[83.62776947021484, 179.6414031982422, 0],[86.87659454345703, 179.6414031982422, 0],[90.32846069335938, 179.4383544921875, 0]];
  
var volumeIn = createCurveSurface([85.04913330078125, 156.49356079101562, 0],[85.35370635986328, 179.53988647460938, 0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8]);
//DRAW(volumeIn);

var lysosome3D = MAP(BEZIER(S2)([volumeIn,volumeOut]))(domain3);
var lysosome3Dmap=(COLOR(mattLightYellow)(lysosome3D));
DRAW (lysosome3Dmap);

var lysosome3Dstructure = STRUCT ([volumeOutMap,lysosome3Dmap,]);
var lysosome3DstructureT =  T([0,1])([45,23])(lysosome3Dstructure);
DRAW(lysosome3DstructureT);

/********************************************************************LYSOSOME SMALLER ABOVE THE CENTRIOLE******************************************************/
//Outer Control point 
  var cp1 =  [[55.283721923828125, 185.0208282470703, 0],[58.72223663330078, 184.9062042236328, 0],[60.49879837036133, 184.84889221191406, 0],[64.39578247070312, 184.9062042236328, 0]];
  var cp2 =  [[51.44404602050781, 187.31317138671875-1, 0],[56.48720169067383, 187.02662658691406-1, -8],[62.73383331298828, 186.91200256347656-1, -8],[67.71968078613281, 187.02662658691406-1, 0]];
  var cp3 =  [[49.14259719848633, 191.255126953125, 0],[53.33523178100586, 191.21014404296875, -13],[65.54195404052734, 191.2674560546875, -13],[70.52780151367188, 191.2674560546875, 0]];
  var cp4 =  [[48.4640007019043, 194.87789916992188, 0],[52.360984802246094, 194.82058715820312, -14],[67.37582397460938, 194.5913543701172, -14],[70.81433868408203, 194.5913543701172, 0]];
  var cp5 =  [[49.15170669555664, 198.94680786132812, 0],[54.53871154785156, 198.83218383789062, -13],[65.4846420288086, 198.7175750732422, -13],[70.35587310791016, 198.77487182617188, 0]];
  var cp6 =  [[51.673282623291016, 202.84378051757812, 0],[56.716434478759766, 202.90109252929688, -8],[63.13499450683594, 202.90109252929688, -8],[68.6366195678711, 202.84378051757812, 0]];
  var cp7 =  [[56.20065689086914, 205.7665252685547, 0],[59.23801040649414, 205.7665252685547, 0],[60.61341857910156, 205.82383728027344, 0],[63.30691909790039, 205.7665252685547, 0]];
  
var volumeOut = createCurveSurface([59.663516998291016, 183.93405151367188+0.5, 0],[59.93377685546875, 206.635986328125-1, 0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7]);
//DRAW(COLOR(mattGold)(MAP(volumeOut)(domain2)));

 //Inner Control point 

  var cp1 =  [[56.15011978149414, 187.98797607421875, 0],[58.17707824707031, 187.98797607421875, 0],[60.87969207763672, 187.98797607421875, 0],[63.04178237915039, 187.98797607421875, 0]];
  var cp2 =  [[53.042118072509766, 190.96084594726562, 0],[56.28525161743164, 190.82571411132812, -9],[62.636390686035156, 190.69058227539062, -9],[66.55517578125, 190.69058227539062, 0]];
  var cp3 =  [[51.96107482910156, 194.4742431640625, 0],[55.33933639526367, 194.4742431640625, -11],[63.312042236328125, 194.06884765625, -11],[67.90647888183594, 193.9337158203125, 0]];
  var cp4 =  [[52.50159454345703, 198.5281524658203+2, 0],[57.77168655395508, 198.12277221679688+2, -9],[62.09586715698242, 198.12277221679688+2, -9],[67.36595916748047, 198.12277221679688+2, 0]];
  var cp5 =  [[55.60960006713867, 201.23077392578125+2, 0],[58.98786544799805, 201.36590576171875+2, 0],[61.01482391357422, 201.36590576171875+2, 0],[64.3930892944336, 201.23077392578125+2, 0]];
  
var volumeIn = createCurveSurface([59.663516998291016, 187.17718505859375+0.5, 0],[60.06890869140625, 202.1766815185547-1, 0],[cp1,cp2,cp3,cp4]);
//DRAW(volumeIn);

var lysosome3D = MAP(BEZIER(S2)([volumeIn,volumeOut]))(domain3);
var Tlysosome3D = T ([1])([+80])(lysosome3D);
DRAW(COLOR(mattLightYellow)(Tlysosome3D));

/******************************************************************LYSOSOME UNDER BIG MITHOCONDRION***********************************************************/
 //Outer Control point 
  var cp1 =  [[117.40863800048828,  481.0681457519531-1,  0],[120.78690338134766,  481.9330139160156-1,  0],[124.03003692626953,  481.933013916015-1,  0],[127.6785659790039,  481.7978820800781-1,  0]];
  var cp2 =  [[112.67906951904297,  484.1761474609375,  0],[119.43560028076172,  483.50048828125,  -10],[126.05699920654297,  483.50048828125,  -10],[132.4081268310547,  483.230224609375,  0]];
  var cp3 =  [[110.38185119628906,  486.6084899902344,  0],[117.27350616455078,  486.4733581542969,  -11],[127.81369018554688,  486.3382263183594,  -11],[134.97561645507812,  485.9328308105469,  0]];
  var cp4 =  [[108.08462524414062,  490.12188720703125,  0],[115.78707122802734,  490.12188720703125,  -15],[129.7055206298828,  489.31109619140625,  -15],[136.73231506347656,  489.04083251953125,  0]];
  var cp5 =  [[107.27384185791016,  493.7704162597656,  0],[115.11141967773438,  493.2298889160156,  -16],[130.5163116455078,  492.5542297363281,  -16],[138.0836181640625,  492.2839660644531,  0]];
  var cp6 =  [[107.27871765136719,  497.689208984375,  0],[115.24655151367188,  497.5540771484375,  -16],[130.1109161376953,  497.148681640625,  -16],[138.6241455078125,  497.0135498046875,  0]];
  var cp7 =  [[108.08950103759766,  501.7431335449219,  0],[116.32759094238281,  501.7431335449219,  -15],[129.5703887939453,  501.6080017089844,  -15],[137.13771057128906,  502.55389404296875,  0]];
  var cp8 =  [[110.24671936035156,  505.2565002441406,  0],[117.40863800048828,  505.6618957519531,  -11],[128.21908569335938,  505.5267639160156,  -11],[135.38101196289062,  505.6618957519531,  0]];
  var cp9 =  [[112.67958923339844,  508.905029296875,  0],[119.16533660888672,  509.0401611328125,  -10],[126.46238708496094,  508.905029296875,  -10],[132.8135223388672,  509.0401611328125,  0]];
  var cp10 =  [[117.67890167236328,  510.796875,  0],[120.78690338134766,  510.796875,  0],[124.16516876220703,  510.796875,  0],[128.08395385742188,  510.6617431640625,  0]];

var volumeOut = createCurveSurface([122.5436019897461, 480.8519592285156+0.5, 0],[122.6787338256836, 511.148193359375-0.5, 0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10]);
DRAW(COLOR(mattGold)(MAP(volumeOut)(domain2)));

 //Inner Control point 

  var cp1 =  [[117.70804595947266,  483.8537902832031+0.5,  0],[120.68287658691406,  483.7774963378906+1,  0],[124.42047882080078,  483.70123291015625+1,  0],[127.70042419433594,  483.70123291015625+1,  0]];
  var cp2 =  [[113.9704360961914,  486.52349853515625,  0],[118.9284896850586,  486.44720458984375,  -8],[126.17487335205078,  486.1421203613281,  -8],[130.8278045654297,  486.0658264160156,  0]];
  var cp3 =  [[111.30072021484375,  490.1085510253906,  0],[117.25038146972656,  489.87969970703125,  -13],[127.92926025390625,  489.42205810546875,  -13],[134.18402099609375,  489.42205810546875,  0]];
  var cp4 =  [[110.38538360595703,  493.38848876953125,  0],[115.11141967773438,  493.2298889160156,  -14],[129.83619689941406,  492.85455322265625,  -14],[135.63330078125,  492.77825927734375,  0]];
  var cp5 =  [[110.38538360595703,  497.5837707519531,  0],[115.24655151367188,  497.5540771484375,  -14],[129.83619689941406,  496.9735412597656,  -14],[135.32818603515625,  496.8972473144531,  0]];
  var cp6 =  [[112.36860656738281,  501.62646484375,  0],[117.63176727294922,  501.47393798828125,  -13],[128.31063842773438,  501.2450866699219,  -13],[133.87892150878906,  501.092529296875,  0]];
  var cp7 =  [[114.80949401855469,  504.90643310546875,  0],[119.15731811523438,  505.13525390625,  -8],[126.70881652832031,  505.13525390625,  -8],[130.75152587890625,  504.9826965332031,  0]];
  var cp8 =  [[118.4708251953125,  507.4998474121094,  0],[121.29309844970703,  507.4998474121094,  0],[124.6493148803711,  507.3473205566406,  0],[128.08181762695312,  507.19476318359375,  0]];
  
var volumeIn = createCurveSurface([122.5898208618164,  483.1672668457031+0.5,  0],[123.0474853515625,  508.0338134765625-0.5,  0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8]);
//DRAW(volumeIn);

var lisosome3D = MAP(BEZIER(S2)([volumeIn,volumeOut]))(domain3);
DRAW(COLOR(mattLightYellow)(lisosome3D));

/****************************************************************************LYSOSOME ABOVE BIG MITHOCONDRION******************************************/

 //Outer Control point 
  var cp1 =  [[31.58462142944336, 302.5011901855469-1, 0],[34.16350555419922, 302.5011901855469-1, 0],[36.22661590576172, 302.5011901855469-1, 0],[39.14935302734375, 302.3865661621094-1,  0]];
  var cp2 =  [[28.08880043029785, 304.4496765136719, 0],[32.90271759033203, 304.4496765136719, -8],[37.37278747558594, 304.27777099609375, -8],[42.53055953979492, 304.6216125488281,  0]];
  var cp3 =  [[25.28067970275879, 307.08587646484375, 0],[31.12615394592285, 307.1431884765625, -9],[38.86280822753906, 306.97125244140625, -9],[45.3959846496582, 307.20050048828125,  0]];
  var cp4 =  [[23.160263061523438, 310.23785400390625, 0],[29.979982376098633, 309.89398193359375, -12],[40.12359619140625, 309.5501403808594, -12],[47.11524200439453,  309.9512939453125,  0]];
  var cp5 =  [[22.300634384155273, 313.5044250488281, 0],[28.719194412231445, 313.16058349609375, -13],[41.556312561035156, 312.8740539550781, -13],[48.03218078613281,  313.103271484375,  0]];
  var cp6 =  [[22.47256088256836, 316.7710266113281, 0],[28.661884307861328, 316.4844665527344, -13],[41.49900436401367, 315.9114074707031, -13],[48.37602996826172, 315.9114074707031,  0]];
  var cp7 =  [[23.618730545043945, 319.9230041503906, 0],[29.979982376098633, 319.6364440917969, -12],[40.238216400146484, 319.00604248046875, -12],[47.97487258911133,  318.6622009277344,  0]];
  var cp8 =  [[25.395296096801758, 322.38726806640625, 0],[31.47000503540039, 322.15802001953125, -9],[38.80550003051758, 321.8714904785156, -9],[46.82870101928711, 321.6995544433594,  0]];
  var cp9 =  [[27.74494743347168, 324.9088439941406, 0],[33.2465705871582, 324.7942199707031, -8],[37.143550872802734, 324.6795959472656, -8],[43.39018630981445, 324.45037841796875,  0]];
  var cp10 =  [[31.35538673400879, 327.0865783691406, 0],[34.27812576293945, 327.0292663574219, 0],[36.34123229980469, 327.0292663574219, 0],[38.748191833496094, 326.9719543457031,  0]];

var volumeOut = createCurveSurface([35.19506072998047,  301.9281005859375+0.1,  0],[35.36698532104492,  327.5450439453125-0.5,  0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10]);
DRAW(COLOR(mattGold)(MAP(volumeOut)(domain2)));

 //Inner Control point 

  var cp1 =  [[31.97028923034668, 305.44268798828125, 0],[34.09070587158203, 305.3853759765625, 0],[36.612281799316406, 305.32806396484375, 0],[39.42040252685547, 305.21343994140625,  0]];
  var cp2 =  [[29.448713302612305, 307.3338623046875, 0],[32.42875671386719, 307.0473327636719, -5],[38.04499816894531, 307.0473327636719, -5],[42.11390686035156, 307.1046447753906,  0]];
  var cp3 =  [[27.21367835998535, 310.0273742675781, 0],[31.339895248413086, 310.0846862792969, -10],[40.05079650878906, 309.56890869140625, -10],[44.005088806152344, 309.45428466796875,  0]];
  var cp4 =  [[26.525976181030273, 313.2366638183594, 0],[29.620637893676758, 313.2366638183594, -11],[41.556312561035156, 312.8740539550781, -11],[45.781654357910156, 312.8927917480469,  0]];
  var cp5 =  [[26.583284378051758, 316.1593933105469, 0],[29.563329696655273, 316.1020812988281, -11],[41.48351287841797, 315.700927734375, -11],[45.6097297668457, 315.64361572265625,  0]];
  var cp6 =  [[27.500221252441406, 318.6236572265625, 0],[30.365650177001953, 318.68096923828125, -10],[40.91042709350586, 318.45172119140625,-10],[45.15126037597656, 318.2225036621094,  0]];
  var cp7 =  [[29.39140510559082, 320.9159851074219, 0],[32.829917907714844, 321.0879211425781, -5],[39.19116973876953, 321.0306091308594, -5],[43.317386627197266, 320.85870361328125,  0]];
  var cp8 =  [[31.74105453491211, 322.9790954589844, 0],[34.721099853515625, 323.0937194824219, 0],[37.58652877807617, 323.0937194824219, 0],[40.56657409667969, 322.9790954589844,  0]];
  
var volumeIn = createCurveSurface([35.294185638427734, 304.9842224121094+0.5, 0],[36.211124420166016, 323.55218505859375-0.5, 0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8]);
//DRAW(volumeIn);

var lysosome3D = MAP(BEZIER(S2)([volumeIn,volumeOut]))(domain3);
DRAW(COLOR(mattLightYellow)(lysosome3D)); 

/************************************************************************ VACUOLE **********************************************************/
//Outer Control point 
  var cp1 =  [[151.8223114013672, 372.81591796875, 0],[154.36044311523438, 372.81591796875, 0],[156.59400939941406, 372.81591796875, 0],[158.82757568359375, 372.81591796875, 0]];
  var cp2 =  [[147.5582275390625, 376.36932373046875, 0],[151.4162139892578, 376.36932373046875, -10],[156.1879119873047, 376.36932373046875, -10],[161.26419067382812, 376.36932373046875, 0]];
  var cp3 =  [[145.22314453125, 380.02423095703125, 0],[149.89332580566406, 379.71966552734375, -14],[156.1879119873047, 379.6181335449219, -14],[161.6702880859375, 379.3135681152344, 0]];
  var cp4 =  [[143.0911102294922, 384.1867980957031, 0],[148.06585693359375, 383.7806701660156, -15],[156.39096069335938, 383.4761047363281, -15],[160.3504638671875, 383.4761047363281, 0]];
  var cp5 =  [[141.16212463378906, 388.8569641113281, 0],[146.13687133789062, 388.45086669921875, -19],[155.27418518066406, 387.9432373046875, -19],[159.03062438964844, 387.9432373046875, 0]];
  var cp6 =  [[140.75601196289062, 392.9179992675781, 0],[145.62924194335938, 392.81646728515625, -20],[154.66502380371094, 392.4103698730469, -20],[158.92910766601562, 392.2073059082031, 0]];
  var cp7 =  [[141.0605926513672, 397.8927307128906, 0],[146.74603271484375, 397.48663330078125, -19],[156.1879119873047, 396.97900390625, -19],[161.5687713623047, 396.5729064941406, 0]];
  var cp8 =  [[142.0758514404297, 402.2583312988281, 0],[147.65975952148438, 401.750732421875, -15],[158.01536560058594, 401.4461364746094, -15],[163.80233764648438, 401.3446044921875, 0]];
  var cp9 =  [[143.39569091796875, 406.3193664550781, 0],[149.69027709960938, 406.0148010253906, -14],[157.71080017089844, 405.5071716308594, -14],[163.7008056640625, 404.89801025390625, 0]];
  var cp10 =  [[146.74603271484375, 409.56817626953125, 0],[152.32994079589844, 409.4666748046875, -10],[156.49249267578125, 409.3651428222656, -10],[162.27944946289062, 409.060546875, 0]];
  var cp11 =  [[149.89332580566406, 412.2078552246094, 0],[153.44671630859375, 412.2078552246094, 0],[155.88333129882812, 412.1063232421875, 0],[159.03062438964844, 412.0047912597656, 0]];

var volumeOut = createCurveSurface([155.57875061035156, 372.00372314453125+0.5, 0],[154.66502380371094, 413.32464599609375-1, 0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp11]);
DRAW(COLOR(mattDarkOrange)(MAP(volumeOut)(domain2)));

 //Inner Control point 
  var cp0 = [[153.1421356201172,374.846435546875,0],[154.66502380371094,375.0494689941406,0],[155.7818145751953,375.1510009765625,0],[157.0001220703125,375.2525329589844,0]]
  var cp1 =  [[151.11163330078125, 376.876953125, 0],[153.04061889648438, 376.97845458984375, -8],[155.1726531982422, 377.0799865722656, -8],[158.01536560058594, 377.38458251953125, 0]];
  var cp2 =  [[148.3704376220703, 380.227294921875, 0],[151.923828125, 379.71966552734375, -9],[154.66502380371094, 379.8211975097656, -9],[158.5229949951172, 379.71966552734375, 0]];
  var cp3 =  [[147.253662109375, 383.57763671875, 0],[150.19790649414062, 383.57763671875, -15],[154.56350708007812, 383.57763671875, -15],[158.3199462890625, 383.57763671875, 0]];
  var cp4 =  [[145.12161254882812, 388.45086669921875, 0],[148.3704376220703, 388.45086669921875, -16],[155.27418518066406, 387.9432373046875, -16],[157.91384887695312, 388.0447692871094, 0]];
  var cp5 =  [[144.0048370361328, 392.9179992675781, 0],[145.62924194335938, 392.81646728515625, -16],[154.66502380371094, 392.4103698730469, -16],[157.91384887695312, 392.2073059082031, 0]];
  var cp6 =  [[144.2078857421875, 397.689697265625, 0],[146.74603271484375, 397.48663330078125, -15],[156.1879119873047, 396.97900390625, -15],[158.72605895996094, 396.87750244140625, 0]];
  var cp7 =  [[144.51246643066406, 401.85223388671875, 0],[147.65975952148438, 401.750732421875, -9],[158.01536560058594, 401.4461364746094, -9],[161.06114196777344, 401.24310302734375, 0]];
  var cp8 =  [[145.62924194335938, 406.1163330078125, 0],[149.69027709960938, 406.0148010253906, -8],[157.71080017089844, 405.5071716308594, -8],[161.4672393798828, 405.20257568359375, 0]];
  var cp9 =  [[148.87806701660156, 409.56817626953125, 0],[152.32994079589844, 409.4666748046875, 0],[156.49249267578125, 409.3651428222656, 0],[160.1474151611328, 409.26361083984375, 0]];

var volumeIn = createCurveSurface([155.1726531982422-1,374.4403381347656+1.5,0],[154.66502380371094, 410.27886962890625, 0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9]);
//DRAW(volumeIn);

var vacuole3D = MAP(BEZIER(S2)([volumeIn,volumeOut]))(domain3);
DRAW(COLOR(mattOrange)(vacuole3D));