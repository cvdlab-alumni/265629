/*Domain*/
var domain1 = INTERVALS(1)(100);
var domain2 = DOMAIN([[0,1],[0,1]])([100,100]);
var domain3 = DOMAIN([[0,1],[0,1],[0,1]])([15,15,1]);
var domainCircle = DOMAIN([[0,1],[0,2*PI]])([15,15]);


/*Color*/
var mattLightYellow = [255/255, 215/255, 0,1]; 
var mattAquaMarine = [127/255, 255/255, 212/255,1]; 
var mattDarkOrchid = [153/255, 50/255, 204/255, 1];
var mattDarkSeaGreen =[143/255, 188/255, 143/255, 0.8];
var mattLightSeaGreen = [32/255, 178/255, 170/255,1];

/*Function*/

/* This function creates an array of knots used by the function nubs. The function takes as input an array of control points. It returns an array of knots. 

   INPUT - An array of points

   OUTPUT - An array of knots.

*/

function knots (point) {
  var k = 2; 
  var m =point.length;
  var n = (m + k + 1);
  var first = 1;
  var last = n - 3;

  var knots = [];

  for (var i = 0; i < 3; i++) {
     knots[i] = 0;
    };

  for (var i = 3; i < last; i++,first++) {
     knots[i] = first;

    };

  for (var i = last; i < n; i++) {
     knots[i] = first;
    };

  return knots;
};


/* This function creates a curve with the function Nubs. The function takes as input an array of control points. It returns to the curve. 

   INPUT - An array of points
   
   OUTPUT - A curve built with the function NUBS

*/

function createNubs (point) {
  
  var knots1 = knots(point);
  var c1 = NUBS(S0)(2)(knots1)(point);
  var curve1 = MAP(c1)(domain1);
  //DRAW(curve1);
  return c1;
}

/* This function creates a 1 grade Bezier curve. The function takes as input an array of curves. It returns to the Bezier curve. 

   INPUT - An array of curves

   OUTPUT - A 1 grade Bezier curve

*/
function createBezierS1(curves) {
  var b1 = BEZIER(S1)(curves);
  var b1Map = MAP(b1)(domain2);
  //DRAW(b1Map);
   return b1;
}
/* This function creates a 2 grade Bezier curve. The function takes as input an array of curves and a color. It returns to the drawing of curves. 

   INPUT - An array of curves and a color

   OUTPUT - A 2 grade Bezier curve

*/
function createBezierS2 (curves, color) {
  var b1 = BEZIER(S2)(curves);
  var b1Map = MAP(b1)(domain3);
  return DRAW(COLOR(color)(b1Map));
}


/* This function takes an array as input and reverses it. It returns the reversed array. 
   
   INPUT - An array 

   OUTPUT - A reversed array 

*/
function reverseR(array) {
  var arrayReturn = [];
  var j = 0;
  for(var i = array.length-1; i>=0; i--) {
        
        arrayReturn[j] = array[i];
        j++;
  }
  return arrayReturn;
}



/********************************************************************* NUCLEOLUS ******************************************************************/
var nucleolus = BEZIER(S0)([[0,0,0],[30,0,0],[30,0,45],[0,0,45]]);
//var curve0 = MAP(nucleolus)(domain1);
var mapping = ROTATIONAL_SURFACE(nucleolus);
var nucleolusMap = COLOR(mattLightSeaGreen) (T([0,1,2])([280,297,-25]) ((MAP(mapping)(domainCircle))));
DRAW (nucleolusMap)


/********************************************************************* NUCLEUS ******************************************************************/
var nucleus = BEZIER(S0)([[0,0,0],[65,0,0],[65,0,97.5],[0,0,97.5]]);
//var curve0 = MAP(nucleus)(domain1);
var mapping = ROTATIONAL_SURFACE(nucleus);
var nucleusMap = COLOR(mattDarkSeaGreen) (T([0,1,2])([280,297,-60]) ((MAP(mapping)(domainCircle))));
DRAW (nucleusMap)


 //---------------------------------------------------------------ROUGH ENDOPLASMATIC RETICULUM PART 1 DX-----------------------------------------------------------------------


var controlsUpper = [[187.6236114501953, 248.28280639648438, 0],[187.6236114501953, 248.28280639648438, 0],[190.86106872558594, 249.18209838867188, 0],[194.81796264648438, 248.46266174316406, 0],[198.055419921875, 246.12449645996094, 0],[200.75331115722656, 243.78634643554688, 0],[204.35047912597656, 240.00930786132812, 0],[206.6886444091797, 237.31141662597656, 0],[208.84695434570312, 234.97325134277344, 0],[211.90455627441406, 233.71424865722656, 0],[213.88299560546875, 235.1531219482422, 0],[211.90455627441406, 237.8509979248047, 0],[207.2282257080078, 241.62803649902344, 0],[202.01231384277344, 245.76478576660156, 0],[200.93316650390625, 249.7216796875, 0],[202.55189514160156, 253.1389923095703, 0],[206.3289337158203, 255.6570281982422, 0],[212.08441162109375, 256.0167236328125, 0],[215.32186889648438, 254.93759155273438, 0],[218.19961547851562, 253.49871826171875, 0],[220.89749145507812, 251.3404083251953, 0],[223.41551208496094, 249.7216796875, 0],[225.76597595214844, 247.8705596923828, 0],[227.37240600585938, 246.48422241210938, 0],[229.52243041992188, 244.41868591308594, 0],[231.68902587890625, 242.52732849121094, 0],[233.84732055664062, 240.3690185546875, 0],[237.4445037841797, 237.13156127929688, 0],[239.57347106933594, 234.976806640625, 0],[243.0253448486328, 232.43865966796875, 0],[248.2360382080078, 229.2177734375, 0],[255.43038940429688, 226.5198974609375, 0],[262.21368408203125, 224.11355590820312, 0],[269.99896240234375, 222.92271423339844, 0],[274.49542236328125, 222.20327758789062, 0],[280.79046630859375, 222.20327758789062, 0],[286.9056701660156, 222.3831329345703, 0],[292.4812927246094, 223.28244018554688, 0],[298.9562072753906, 223.64215087890625, 0],[303.9922790527344, 223.64215087890625, 0],[307.9002380371094, 223.19981384277344, 0],[310.03228759765625, 221.06777954101562, 0],[309.8292236328125, 218.52964782714844, 0]];
var nubsUpper = createNubs(controlsUpper);
var nubsUpperMap = MAP(nubsUpper)(domain1);
//DRAW(nubsUpperMap);

var controlsUnder = [[246.97702026367188, 266.8082580566406, -50],[248.4158935546875, 265.9089660644531, -50],[249.1353302001953, 265.0096740722656, -50],[249.85476684570312, 263.75067138671875, -50],[251.47349548339844, 262.85137939453125, -50],[252.37278747558594, 261.772216796875, -50],[254.17137145996094, 261.05279541015625, -50],[255.79010009765625, 260.69305419921875, -50],[256.68939208984375, 261.2326354980469, -50],[256.8692626953125, 262.1319274902344, -50],[255.79010009765625, 263.3909606933594, -50],[254.53109741210938, 264.829833984375, -50],[253.45193481445312, 266.44854736328125, -50],[253.45193481445312, 267.34783935546875, -50],[253.45193481445312, 268.24713134765625, -50],[253.6317901611328, 268.7867126464844, -50],[254.53109741210938, 268.9665832519531, -50],[256.5095520019531, 268.24713134765625, -50],[258.48797607421875, 266.8082580566406, -50],[260.28656005859375, 266.2686767578125, -50],[261.36572265625, 265.0096740722656, -50],[262.9844665527344, 263.9305114746094, -50],[264.6031799316406, 262.85137939453125, -50],[265.8621826171875, 261.772216796875, -50],[267.3010559082031, 260.69305419921875, -50],[269.4593811035156, 259.25421142578125, -50],[271.9773864746094, 258.5347595214844, -50],[274.8551330566406, 257.4555969238281, -50],[277.19329833984375, 257.2757568359375, -50],[280.4307556152344, 256.9160461425781, -50],[282.7689208984375, 256.9160461425781, -50],[284.5675048828125, 256.9160461425781, -50],[286.3660888671875, 256.9160461425781, -50],[287.9848327636719, 256.7361755371094, -50],[289.4237060546875, 256.0167236328125, -50],[289.9632873535156, 255.29730224609375, -50],[289.7834167480469, 253.67857360839844, -50],[289.6035461425781, 253.31886291503906, -50],[289.0639953613281, 252.95913696289062, -50],[288.1647033691406, 252.59942626953125, -50]];
var nubsUnder = createNubs(controlsUnder);
var Dx1 = nubsUnder;
var nubsUnderMap = MAP(nubsUnder)(domain1);
//DRAW(nubsUnderMap);


var pointsLateral1 = [[187.6236114501953, 248.28280639648438, 0],[217,249,-40],[247,251,-48],[246.97702026367188, 266.8082580566406, -50]];
var bLateral1 = BEZIER(S1)(pointsLateral1);

//var bLateral10 = BEZIER(S0)(pointsLateral1);
//var bLateral10Map = MAP(bLateral10)(domain1);
//DRAW(bLateral10Map);


var pointsLateral2 = [[309.8292236328125, 218.52964782714844, 0],[300,230,-40],[295,240,-48],[288.1647033691406, 252.59942626953125, -50]];
var bLateral2 = BEZIER(S1)(pointsLateral2);
var bL1Dx = bLateral1;
var bL2Dx = bLateral2;
//var bLateral20 = BEZIER(S0)(pointsLateralDx2);
//var bLateral20Map = MAP(bLateral20)(domain1);
//DRAW(bLateral20Map);

var volumeRerPart1Dx = MAP(COONS_PATCH([nubsUpper,nubsUnder,bLateral1,bLateral2]))(domain2);
DRAW(COLOR(mattDarkOrchid)(volumeRerPart1Dx));

//Boundary 

var controlsIntDx = [[188.94554138183594, 246.1443328857422, 0],[191.82327270507812, 246.1443328857422, 0],[194.16143798828125, 245.42489624023438, 0],[195.9600372314453, 243.98602294921875, 0],[197.9384765625, 242.18743896484375, 0],[200.27664184570312, 240.38885498046875, 0],[202.07522583007812, 238.410400390625, 0],[204.59324645996094, 236.25210571289062, 0],[206.75155639648438, 233.55421447753906, 0],[209.0897216796875, 232.2952117919922, 0],[212.5070343017578, 230.85633850097656, 0],[215.56463623046875, 231.03619384765625, 0],[217.3632354736328, 233.73406982421875, 0],[217.3632354736328, 235.7125244140625, 0],[215.20492553710938, 238.410400390625, 0],[212.14732360839844, 240.74856567382812, 0],[209.2695770263672, 242.72702026367188, 0],[206.93141174316406, 244.70545959472656, 0],[204.23353576660156, 247.22348022460938, 0],[203.8738250732422, 249.92137145996094, 0],[206.2119903564453, 251.71995544433594, 0],[208.55014038085938, 251.89981079101562, 0],[211.96746826171875, 252.07968139648438, 0],[216.10421752929688, 250.10122680664062, 0],[219.1618194580078, 248.662353515625, 0],[222.7589874267578, 244.88531494140625, 0],[226.1763153076172, 242.36729431152344, 0],[230.3130645751953, 238.94998168945312, 0],[233.0109405517578, 236.61181640625, 0],[238.58656311035156, 232.47506713867188, 0],[243.62261962890625, 229.0577392578125, 0],[247.03993225097656, 226.89944458007812, 0],[252.0759735107422, 225.10084533691406, 0],[257.2919006347656, 222.9425506591797, 0],[263.5869445800781, 221.50367736816406, 0],[268.9826965332031, 220.06480407714844, 0],[273.47918701171875, 219.5252227783203, 0],[278.155517578125, 219.34536743164062, 0],[284.0908508300781, 219.88494873046875, 0],[287.6880187988281, 220.24465942382812, 0],[292.18450927734375, 220.60438537597656, 0],[297.58026123046875, 221.14395141601562, 0],[302.256591796875, 221.14395141601562, 0],[306.3933410644531, 219.88494873046875, 0]];
var nubsIntDx = createNubs(controlsIntDx);
var boundaryDx = BEZIER(S1)([nubsUpper,nubsIntDx]);
var boundaryDxMap= MAP (boundaryDx)(domain2);
DRAW (COLOR(mattLightYellow)(boundaryDxMap));

//---------------------------------------------------------------ROUGH ENDOPLASMATIC RETICULUM PART 1 SX-----------------------------------------------------------------------



var controlsUpper = [[187.6236114501953, 248.28280639648438, 0],[185.10195922851562, 246.90902709960938, 0],[184.02279663085938, 244.03128051757812, 0],[185.461669921875, 241.33340454101562, 0],[186.54083251953125, 239.1750946044922, 0],[189.23870849609375, 237.1966552734375, 0],[191.03729248046875, 235.75778198242188, 0],[193.55531311035156, 233.77932739257812, 0],[193.7351837158203, 231.441162109375, 0],[191.93658447265625, 231.08145141601562, 0],[188.51927185058594, 231.80088806152344, 0],[185.461669921875, 233.41961669921875, 0],[181.32492065429688, 234.49876403808594, 0],[178.62704467773438, 233.23976135253906, 0],[175.74929809570312, 232.1605987548828, 0],[173.05142211914062, 229.28286743164062, 0],[171.97225952148438, 226.2252655029297, 0],[172.5118408203125, 223.16766357421875, 0],[174.67015075683594, 221.0093536376953, 0],[177.7277374267578, 219.5704803466797, 0],[180.60548400878906, 219.03091430664062, 0],[182.9436492919922, 218.85105895996094, 0],[187.44012451171875, 219.5704803466797, 0],[190.13800048828125, 220.64964294433594, 0],[192.65602111816406, 221.72879028320312, 0],[194.8143310546875, 223.88710021972656, 0],[197.15249633789062, 225.86553955078125, 0],[199.49066162109375, 227.30441284179688, 0],[202.5482635498047, 228.7432861328125, 0],[205.0662841796875, 228.9231414794922, 0],[206.8648681640625, 227.30441284179688, 0],[205.0662841796875, 224.24681091308594, 0],[201.6489715576172, 222.08851623535156, 0],[202.18853759765625, 218.13162231445312, 0],[204.8864288330078, 215.9733123779297, 0],[209.02317810058594, 214.1747283935547, 0],[213.87936401367188, 212.19627380371094, 0],[217.8362579345703, 211.83656311035156, 0],[221.07371520996094, 212.01641845703125, 0],[223.7716064453125, 214.1747283935547, 0],[225.21046447753906, 216.6927490234375, 0],[223.41188049316406, 219.93020629882812, 0],[222.33273315429688, 222.80795288085938, 0],[221.97300720214844, 225.68568420410156, 0],[223.59173583984375, 226.58497619628906, 0],[226.2896270751953, 226.40512084960938, 0],[228.44793701171875, 224.06695556640625, 0],[231.68539428710938, 221.54893493652344, 0],[234.38327026367188, 219.5704803466797, 0],[235.6422882080078, 217.23233032226562, 0],[237.26101684570312, 213.81500244140625, 0],[238.6998748779297, 211.6566925048828, 0],[239.95889282226562, 209.49839782714844, 0],[242.11720275878906, 206.6206512451172, 0],[246.0740966796875, 203.20333862304688, 0],[249.31155395507812, 201.22488403320312, 0],[253.62815856933594, 198.88671875, 0],[258.1246337890625, 196.9082794189453, 0],[262.62109375, 196.1888427734375, 0],[267.1175842285156, 197.2679901123047, 0],[269.09600830078125, 199.7860107421875, 0],[268.9161682128906, 202.66375732421875, 0],[267.1175842285156, 206.08106994628906, 0],[263.880126953125, 208.2393798828125, 0],[259.5635070800781, 210.21783447265625, 0],[255.78646850585938, 211.83656311035156, 0],[252.00942993164062, 214.1747283935547, 0],[248.5921173095703, 216.33302307128906, 0],[247.51296997070312, 218.4913330078125, 0],[249.4914093017578, 218.6711883544922, 0],[252.00942993164062, 218.6711883544922, 0],[255.96632385253906, 217.23233032226562, 0],[259.7433776855469, 214.8941650390625, 0],[262.2613830566406, 213.45529174804688, 0],[266.2182922363281, 211.6566925048828, 0],[269.09600830078125, 210.21783447265625, 0],[272.6932067871094, 209.31854248046875, 0],[275.5709533691406, 208.59910583496094, 0],[279.8875427246094, 208.4192352294922, 0],[284.5638732910156, 208.9588165283203, 0],[287.981201171875, 209.49839782714844, 0],[292.65753173828125, 209.67825317382812, 0],[295.175537109375, 210.21783447265625, 0],[298.05328369140625, 211.29698181152344, 0],[300.9310302734375, 212.19627380371094, 0],[305.0677795410156, 213.63514709472656, 0],[307.40594482421875, 214.71429443359375, 0],[308.8448181152344, 217.7718963623047, 0],[309.8292236328125, 218.52964782714844, 0]];
var nubsUpper = createNubs(controlsUpper);
var nubsUpperMap = MAP(nubsUpper)(domain1);
//DRAW(nubsUpperMap);

var controlsUnder = [[246.97702026367188, 266.8082580566406, -60],[245.63967895507812, 266.973876953125, -60],[245.10009765625, 266.6141662597656, -60],[244.74037170410156, 265.8947448730469, -60],[244.9202423095703, 265.17529296875, -60],[245.10009765625, 264.9954528808594, -60],[245.9993896484375, 264.2760009765625, -60],[247.43826293945312, 263.55657958984375, -60],[247.9778289794922, 263.0169982910156, -60],[248.87713623046875, 262.29754638671875, -60],[249.4167022705078, 260.8586730957031, -60],[249.4167022705078, 260.3191223144531, -60],[248.697265625, 260.1392517089844, -60],[247.25840759277344, 260.3191223144531, -60],[245.8195343017578, 261.39825439453125, -60],[245.10009765625, 262.1177062988281, -60],[244.56051635742188, 262.8371276855469, -60],[244.2008056640625, 263.7364196777344, -60],[243.12164306640625, 264.6357116699219, -60],[241.6827850341797, 264.9954528808594, -60],[241.32305908203125, 264.2760009765625, -60],[241.50291442871094, 262.65728759765625, -60],[242.5820770263672, 260.8586730957031, -60],[243.301513671875, 259.779541015625, -60],[244.2008056640625, 259.2399597167969, -60],[244.74037170410156, 258.3406677246094, -60],[244.74037170410156, 257.4413757324219, -60],[243.4813690185547, 256.721923828125, -60],[240.24391174316406, 256.721923828125, -60],[238.98489379882812, 256.721923828125, -60],[237.72589111328125, 256.3622131347656, -60],[237.18630981445312, 255.46292114257812, -60],[237.72589111328125, 254.2039031982422, -60],[238.2654571533203, 253.48446655273438, -60],[239.52447509765625, 253.3046112060547, -60],[241.86264038085938, 253.3046112060547, -60],[243.84107971191406, 254.2039031982422, -60],[244.74037170410156, 255.10321044921875, -60],[245.8195343017578, 256.00250244140625, -60],[247.0785369873047, 256.1823425292969, -60],[247.6181182861328, 256.90179443359375, -60],[249.4167022705078, 256.00250244140625, -60],[249.59657287597656, 255.10321044921875, -60],[249.59657287597656, 253.3046112060547, -60],[249.59657287597656, 251.68588256835938, -60],[250.3159942626953, 249.52757263183594, -60],[251.75486755371094, 248.8081512451172, -60],[253.37359619140625, 248.62828063964844, -60],[254.6326141357422, 248.98800659179688, -60],[254.99232482910156, 250.78659057617188, -60],[253.91317749023438, 252.2254638671875, -60],[253.553466796875, 253.8441925048828, -60],[253.7333221435547, 254.92333984375, -60],[255.89161682128906, 254.7434844970703, -60],[257.33050537109375, 253.66433715820312, -60],[259.4888000488281, 252.2254638671875, -60],[261.4672546386719, 251.1463165283203, -60],[263.4457092285156, 250.06715393066406, -60],[265.0644226074219, 248.98800659179688, -60],[266.5032958984375, 247.90884399414062, -60],[268.3018798828125, 246.82969665527344, -60],[269.7407531738281, 245.93040466308594, -60],[271.8990478515625, 245.3908233642578, -60],[273.5177917480469, 245.03111267089844, -60],[274.5969543457031, 245.03111267089844, -60],[275.3163757324219, 245.03111267089844, -60],[275.3163757324219, 246.2901153564453, -60],[273.6976318359375, 248.8081512451172, -60],[271.5393371582031, 250.06715393066406, -60],[268.3018798828125, 252.0456085205078, -60],[267.22271728515625, 253.48446655273438, -60],[268.6615905761719, 254.38377380371094, -60],[270.999755859375, 253.48446655273438, -60],[273.5177917480469, 252.4053192138672, -60],[275.4962463378906, 251.86573791503906, -60],[277.83441162109375, 251.326171875, -60],[280.1725769042969, 250.78659057617188, -60],[282.33087158203125, 250.78659057617188, -60],[283.5898742675781, 250.78659057617188, -60],[285.2086181640625, 250.78659057617188, -60],[286.2877502441406, 251.1463165283203, -60],[287.1870422363281, 251.86573791503906, -60],[288.1647033691406, 252.59942626953125, -60]];
var nubsUnder = createNubs(controlsUnder);
var Sx1 = nubsUnder;
var nubsUnderMap = MAP(nubsUnder)(domain1);
//DRAW(nubsUnderMap);


var pointsLateral1 = [[187.6236114501953, 248.28280639648438, 0],[217,249,-48],[247,251,-57,8],[246.97702026367188, 266.8082580566406, -60]];
var bLateral1 = BEZIER(S1)(pointsLateral1);

//var bLateral10 = BEZIER(S0)(pointsLateral1);
//var bLateral10Map = MAP(bLateral10)(domain1);
//DRAW(bLateral10Map);


var pointsLateral2 = [[309.8292236328125, 218.52964782714844, 0],[300,230,-48],[295,240,-57,8],[288.1647033691406, 252.59942626953125, -60]];
var bLateral2 = BEZIER(S1)(pointsLateral2);
var bL1Sx = bLateral1;
var bL2Sx = bLateral2;

//var bLateral20 = BEZIER(S0)(pointsLateralDx2);
//var bLateral20Map = MAP(bLateral20)(domain1);
//DRAW(bLateral20Map);

var volumeRerPart1Sx = MAP(COONS_PATCH([nubsUpper,nubsUnder,bLateral1,bLateral2]))(domain2);
DRAW(COLOR(mattDarkOrchid)(volumeRerPart1Sx));


//Boundary 

var controlsIntSx = [[188.94554138183594, 246.05392456054688, 0],[187.7293701171875, 245.51341247558594, 0],[187.323974609375, 243.7567138671875, 0],[187.99961853027344, 242.13514709472656, 0],[189.89144897460938, 240.91896057128906, 0],[190.97250366210938, 239.56765747070312, 0],[192.99945068359375, 238.2163543701172, 0],[194.6210174560547, 236.72991943359375, 0],[195.2966766357422, 234.9732208251953, 0],[195.8372039794922, 233.35165405273438, 0],[195.9723358154297, 231.18955993652344, 0],[194.8912811279297, 229.432861328125, 0],[193.53997802734375, 228.89234924316406, 0],[191.7832794189453, 228.89234924316406, 0],[189.08065795898438, 230.10850524902344, 0],[186.6483154296875, 230.64903259277344, 0],[184.21595764160156, 231.18955993652344, 0],[181.7836151123047, 231.73007202148438, 0],[179.21612548828125, 231.45982360839844, 0],[176.78378295898438, 230.51390075683594, 0],[175.83786010742188, 229.16259765625, 0],[174.75682067871094, 227.13563537597656, 0],[175.02708435058594, 225.37893676757812, 0],[175.56759643554688, 223.4871063232422, 0],[178.1350860595703, 222.27093505859375, 0],[181.2430877685547, 221.4601593017578, 0],[184.62135314941406, 221.4601593017578, 0],[187.45909118652344, 222.67633056640625, 0],[190.5670928955078, 223.8925018310547, 0],[193.13458251953125, 224.97354125976562, 0],[195.70205688476562, 226.86537170410156, 0],[198.40467834472656, 228.892333984375, 0],[200.97215270996094, 230.64903259277344, 0],[203.5396270751953, 231.59494018554688, 0],[207.4584197998047, 230.64903259277344, 0],[208.94485473632812, 228.2166748046875, 0],[208.53945922851562, 224.7032928466797, 0],[206.9178924560547, 222.81146240234375, 0],[205.29632568359375, 221.3250274658203, 0],[205.70172119140625, 219.16293334960938, 0],[207.8638153076172, 217.40623474121094, 0],[210.83668518066406, 215.6495361328125, 0],[213.67442321777344, 214.83876037597656, 0],[217.0526885986328, 214.56849670410156, 0],[219.48504638671875, 215.1090087890625, 0],[221.6471405029297, 216.73057556152344, 0],[221.78225708007812, 219.29806518554688, 0],[219.89044189453125, 222.13580322265625, 0],[219.07965087890625, 224.8384246826172, 0],[219.21478271484375, 227.54103088378906, 0],[220.8363494873047, 229.16259765625, 0],[223.67408752441406, 229.432861328125, 0],[226.2415771484375, 229.2977294921875, 0],[229.48471069335938, 228.351806640625, 0],[232.18731689453125, 225.64920043945312, 0],[235.02505493164062, 222.54119873046875, 0],[237.45741271972656, 219.70346069335938, 0],[239.214111328125, 216.59544372558594, 0],[241.37620544433594, 213.08206176757812, 0],[243.6734161376953, 209.9740447998047, 0],[247.1868133544922, 206.19039916992188, 0],[251.10560607910156, 203.6229248046875, 0],[254.48387145996094, 201.73109436035156, 0],[258.80804443359375, 199.83926391601562, 0],[263.9430236816406, 199.43386840820312, 0],[265.969970703125, 201.19056701660156, 0],[265.429443359375, 204.02830505371094, 0],[261.9160461425781, 206.7309112548828, 0],[257.1864929199219, 209.02813720703125, 0],[252.4569091796875, 212.0010223388672, 0],[246.10577392578125, 215.24415588378906, 0],[243.53829956054688, 219.29806518554688, 0],[245.56524658203125, 222.54119873046875, 0],[248.2678680419922, 222.81146240234375, 0],[252.7271728515625, 221.1898956298828, 0],[257.1864929199219, 219.16293334960938, 0],[262.0511779785156, 217.135986328125, 0],[265.69970703125, 215.514404296875, 0],[270.1590270996094, 213.48745727539062, 0],[275.6993713378906, 211.4604949951172, 0],[280.8343505859375, 211.4604949951172, 0],[287.18548583984375, 212.0010223388672, 0],[292.0501708984375, 212.67666625976562, 0],[297.1851501464844, 213.62258911132812, 0],[301.6444396972656, 214.97389221191406, 0],[305.83349609375, 217.135986328125, 0],[306.3740234375, 219.97372436523438, 0]];
var nubsIntSx = createNubs(controlsIntSx);
var boundarySx = BEZIER(S1)([nubsUpper,nubsIntSx]);
var boundarySxMap= MAP (boundarySx)(domain2);
DRAW (COLOR(mattLightYellow)(boundarySxMap));

var lateralClosure = createBezierS2([bL1Sx, bL1Dx], mattDarkOrchid);
var lateralClosure = createBezierS2([bL2Sx, bL2Dx], mattDarkOrchid);


//---------------------------------------------------------------ROUGH ENDOPLASMATIC RETICULUM PART 3 DX-----------------------------------------------------------------------


var controlsUpper = [[301.860107421875, 199.86654663085938, 0],[301.679931640625, 202.7663116455078, 0],[303.29644775390625, 205.1331787109375, 0],[304.493408203125, 206.56951904296875, 0],[307.4668884277344, 208.3502197265625, 0],[310.23883056640625, 209.44223022460938, 0],[312.1539611816406, 210.160400390625, 0],[315.3858947753906, 211.5990447998047, 0],[319.7514953613281, 212.91888427734375, 0],[323.4053955078125, 213.03311157226562, 0],[326.5174865722656, 213.03311157226562, 0],[328.4326171875, 211.5967559814453, 0],[328.9114074707031, 209.44223022460938, 0],[328.9114074707031, 206.56951904296875, 0],[329.62957763671875, 203.45742797851562, 0],[331.0659484863281, 201.06350708007812, 0],[333.6992492675781, 200.584716796875, 0],[336.3325500488281, 200.584716796875, 0],[339.4446716308594, 201.78167724609375, 0],[342.8993225097656, 204.08615112304688, 0],[346.38702392578125, 206.56951904296875, 0],[350.2173156738281, 209.9210205078125, 0],[352.8488464355469, 212.30972290039062, 0],[355.96270751953125, 214.7088623046875, 0],[359.5535888671875, 217.82095336914062, 0],[363.3838806152344, 220.4542694091797, 0],[366.0171813964844, 222.36940002441406, 0],[369.1292724609375, 222.60879516601562, 0],[371.2838134765625, 221.65122985839844, 0],[373.677734375, 219.01791381835938, 0]];
var nubsUpper = createNubs(controlsUpper);
var Dx3 =nubsUnder;
var nubsUpperMap = MAP(nubsUpper)(domain1);
//DRAW(nubsUpperMap);

var controlsUnder = [[289.5251159667969, 265.2079772949219, -70],[290.7220764160156, 267.3625183105469, -70],[292.63720703125, 268.7988586425781, -70],[294.791748046875, 269.51702880859375, -70],[296.9462585449219, 270.2352294921875, -70],[299.3401794433594, 270.474609375, -70],[301.4947204589844, 270.9533996582031, -70],[304.367431640625, 270.7139892578125, -70],[306.2825622558594, 269.9958190917969, -70],[308.4371032714844, 269.7564392089844, -70],[309.6340637207031, 269.51702880859375, -70],[310.8310241699219, 268.7988586425781, -70],[311.0704040527344, 267.6018981933594, -70],[309.3946533203125, 266.4049377441406, -70],[308.6764831542969, 264.72918701171875, -70],[309.6340637207031, 263.2928466796875, -70],[310.35223388671875, 262.09588623046875, -70],[312.2673645019531, 261.85650634765625, -70],[313.4643249511719, 262.5746765136719, -70],[315.14007568359375, 263.7716369628906, -70],[316.3370361328125, 264.72918701171875, -70],[317.0552062988281, 266.1655578613281, -70],[318.2521667480469, 267.6018981933594, -70],[319.4491271972656, 269.7564392089844, -70],[320.8854675292969, 270.7139892578125, -70],[322.80059814453125, 271.67156982421875, -70],[325.19451904296875, 272.629150390625, -70],[327.58843994140625, 273.82611083984375, -70],[329.50360107421875, 274.5442810058594, -70],[330.93994140625, 274.7836608886719, -70],[332.8550720214844, 274.7836608886719, -70]];
var nubsUnder = createNubs(controlsUnder);
var nubsUnderMap = MAP(nubsUnder)(domain1);
//DRAW(nubsUnderMap);


var pointsLateral1 = [[301.860107421875, 199.86654663085938, 0],[297,221,-60],[293,243,-68],[289.5251159667969, 265.2079772949219, -70]];
var bLateral1 = BEZIER(S1)(pointsLateral1);

//var bLateral10 = BEZIER(S0)(pointsLateral1);
//var bLateral10Map = MAP(bLateral10)(domain1);
//DRAW(bLateral10Map);


var pointsLateral2 = [[373.677734375, 219.01791381835938, 0],[360,237,-60],[347,255,-68],[332.8550720214844, 274.7836608886719, -70]];
var bLateral2 = BEZIER(S1)(pointsLateral2);

//var bLateral20 = BEZIER(S0)(pointsLateralDx2);
//var bLateral20Map = MAP(bLateral20)(domain1);
//DRAW(bLateral20Map);

var volumeRerPart1Dx = MAP(COONS_PATCH([nubsUpper,nubsUnder,bLateral1,bLateral2]))(domain2);
DRAW(COLOR(mattDarkOrchid)(volumeRerPart1Dx));

var bL1Dx = bLateral1;
var bL2Dx = bLateral2;


//Boundary 

var controlsIntDx = reverseR([[369.8474426269531, 216.86338806152344, 0],[368.889892578125, 218.19821166992188, 0],[367.8746337890625, 218.70584106445312, 0],[365.03192138671875, 218.09669494628906, 0],[362.189208984375, 216.16770935058594, 0],[358.2297058105469, 213.426513671875, 0],[355.7930908203125, 211.2944793701172, 0],[353.0518798828125, 208.55328369140625, 0],[348.7878112792969, 205.10140991210938, 0],[344.52374267578125, 202.15716552734375, 0],[341.47796630859375, 200.1266632080078, 0],[336.7062683105469, 198.5022430419922, 0],[333.3559265136719, 198.09613037109375, 0],[330.5132141113281, 198.90834045410156, 0],[328.68572998046875, 200.22817993164062, 0],[327.36590576171875, 202.664794921875, 0],[326.8582763671875, 205.91360473632812, 0],[327.06134033203125, 208.2487030029297, 0],[326.5537109375, 209.46701049804688, 0],[325.1323547363281, 210.1776885986328, 0],[322.69573974609375, 210.27920532226562, 0],[319.64996337890625, 209.97463989257812, 0],[316.0965576171875, 209.2639617919922, 0],[313.6599426269531, 208.1471710205078, 0],[311.22332763671875, 207.1319122314453, 0],[308.380615234375, 205.71055603027344, 0],[307.1623229980469, 204.7968292236328, 0],[306.0455322265625, 203.7815704345703, 0],[305.7409362792969, 202.15716552734375, 0],[305.6394348144531, 200.8373260498047, 0]]);
var nubsIntDx = createNubs(controlsIntDx);
var boundaryDx = BEZIER(S1)([nubsUpper,nubsIntDx]);
var boundaryDxMap= MAP (boundaryDx)(domain2);
DRAW (COLOR(mattLightYellow)(boundaryDxMap));

//---------------------------------------------------------------ROUGH ENDOPLASMATIC RETICULUM PART 3 SX-----------------------------------------------------------------------



var controlsUpper = [[301.860107421875, 199.86654663085938, 0],[302.51763916015625, 198.62460327148438, 0],[304.751220703125, 197.60934448242188, 0],[307.390869140625, 197.5078125, 0],[309.5229187011719, 197.81239318847656, 0],[311.0458068847656, 198.5230712890625, 0],[313.1778259277344, 199.538330078125, 0],[314.80224609375, 200.3505401611328, 0],[316.32513427734375, 201.46731567382812, 0],[318.2541198730469, 202.07647705078125, 0],[320.4876708984375, 201.97494506835938, 0],[321.5029296875, 200.6551055908203, 0],[321.6044616699219, 198.92918395996094, 0],[319.98004150390625, 197.5078125, 0],[318.66021728515625, 195.78189086914062, 0],[317.4419250488281, 193.85289001464844, 0],[317.8480224609375, 191.72085571289062, 0],[319.37091064453125, 190.70559692382812, 0],[321.40142822265625, 189.5888214111328, 0],[324.34564208984375, 189.08119201660156, 0],[326.274658203125, 189.08119201660156, 0],[330.234130859375, 189.6903533935547, 0],[332.0616149902344, 190.19796752929688, 0],[334.3966979980469, 191.0101776123047, 0],[335.9195861816406, 190.29949951171875, 0],[337.2394104003906, 189.28424072265625, 0],[336.5287170410156, 186.4415283203125, 0],[335.7165222167969, 184.51254272460938, 0],[334.7012634277344, 182.075927734375, 0],[334.49822998046875, 180.34999084472656, 0],[335.51348876953125, 179.33473205566406, 0],[338.2546691894531, 178.7255859375, 0],[340.6912841796875, 179.33473205566406, 0],[342.7218017578125, 180.75608825683594, 0],[344.24468994140625, 182.1774444580078, 0],[346.376708984375, 184.00491333007812, 0],[347.89959716796875, 185.32473754882812, 0],[349.72705078125, 187.35525512695312, 0],[350.94537353515625, 189.08119201660156, 0],[352.1636657714844, 191.0101776123047, 0],[352.8743591308594, 192.9391632080078, 0],[352.97589111328125, 195.07119750976562, 0],[352.1636657714844, 196.3910369873047, 0],[350.94537353515625, 197.3047637939453, 0],[349.5240173339844, 198.01544189453125, 0],[349.72705078125, 199.03070068359375, 0],[350.5392761230469, 200.14749145507812, 0],[353.28045654296875, 201.26426696777344, 0],[356.0216369628906, 201.26426696777344, 0],[358.5597839355469, 201.6703643798828, 0],[361.3009948730469, 202.07647705078125, 0],[363.6360778808594, 202.888671875, 0],[365.5650634765625, 204.00546264648438, 0],[366.9864196777344, 205.02072143554688, 0],[369.0169372558594, 206.64512634277344, 0],[370.5398254394531, 208.67564392089844, 0],[371.961181640625, 211.01072692871094, 0],[372.8749084472656, 213.34580993652344, 0],[373.6871032714844, 215.27479553222656, 0],[373.48406982421875, 219.03125, 0]];
var nubsUpper = createNubs(controlsUpper);
var Sx3 =nubsUnder;
var nubsUpperMap = MAP(nubsUpper)(domain1);
//DRAW(nubsUpperMap);

var controlsUnder = [[289.466552734375, 264.0515441894531, -80],[290.3658447265625, 263.5119934082031, -80],[291.44500732421875, 263.3321228027344, -80],[292.7040100097656, 263.3321228027344, -80],[293.6033020019531, 263.3321228027344, -80],[294.14288330078125, 263.5119934082031, -80],[294.5025939941406, 263.8717041015625, -80],[295.2220458984375, 264.59112548828125, -80],[295.94146728515625, 265.1307067871094, -80],[297.2004699707031, 265.49041748046875, -80],[299.1789245605469, 265.6702880859375, -80],[299.718505859375, 265.49041748046875, -80],[299.53863525390625, 264.4112854003906, -80],[298.9990539550781, 263.8717041015625, -80],[298.0997619628906, 263.1522521972656, -80],[297.3803405761719, 262.4328308105469, -80],[296.660888671875, 261.5335388183594, -80],[296.3011779785156, 260.2745361328125, -80],[296.4810485839844, 259.3752136230469, -80],[297.0206298828125, 258.6557922363281, -80],[300.43792724609375, 258.1162109375, -80],[302.0566711425781, 258.1162109375, -80],[303.49554443359375, 258.1162109375, -80],[304.2149658203125, 258.29608154296875, -80],[305.8337097167969, 258.6557922363281, -80],[307.4524230957031, 259.3752136230469, -80],[308.5315856933594, 260.4543762207031, -80],[309.6107482910156, 261.173828125, -80],[310.1502990722656, 261.5335388183594, -80],[311.4093322753906, 261.5335388183594, -80],[312.3086242675781, 260.8140869140625, -80],[312.48846435546875, 259.914794921875, -80],[312.48846435546875, 258.4759216308594, -80],[312.1287536621094, 256.8572082519531, -80],[311.76904296875, 255.2384796142578, -80],[311.76904296875, 254.3391876220703, -80],[312.6683349609375, 252.720458984375, -80],[314.1072082519531, 252.54058837890625, -80],[315.0065002441406, 253.08016967773438, -80],[315.9057922363281, 254.3391876220703, -80],[316.44537353515625, 255.77804565429688, -80],[317.164794921875, 257.5766296386719, -80],[317.7043762207031, 258.6557922363281, -80],[318.0640869140625, 259.7349548339844, -80],[317.8842468261719, 261.3536682128906, -80],[317.8842468261719, 262.972412109375, -80],[317.8842468261719, 264.4112854003906, -80],[318.423828125, 265.6702880859375, -80],[320.04254150390625, 266.0299987792969, -80],[321.4814147949219, 265.6702880859375, -80],[323.10015869140625, 265.49041748046875, -80],[324.89874267578125, 265.3105773925781, -80],[327.0570373535156, 266.0299987792969, -80],[328.67578125, 267.1091613769531, -80],[329.9347839355469, 268.9077453613281, -80],[331.0139465332031, 270.34661865234375, -80],[331.5534973144531, 271.42578125, -80],[332.45281982421875, 271.96533203125, -80],[332.99237060546875, 273.04449462890625, -80],[333.1722412109375, 274.84307861328125, -80]];
var nubsUnder = createNubs(controlsUnder);
var nubsUnderMap = MAP(nubsUnder)(domain1);
//DRAW(nubsUnderMap);


var pointsLateral1 = [[301.860107421875, 199.86654663085938, 0],[297,221,-68.8],[293,243,-77.7],[289.466552734375, 264.0515441894531, -80, -80]];
var bLateral1 = BEZIER(S1)(pointsLateral1);

//var bLateral10 = BEZIER(S0)(pointsLateral1);
//var bLateral10Map = MAP(bLateral10)(domain1);
//DRAW(bLateral10Map);


var pointsLateral2 = [[373.48406982421875, 219.03125, 0],[360,237,-68.8],[347,255,-77.7],[333.1722412109375, 274.84307861328125, -80]];
var bLateral2 = BEZIER(S1)(pointsLateral2);

//var bLateral20 = BEZIER(S0)(pointsLateralDx2);
//var bLateral20Map = MAP(bLateral20)(domain1);
//DRAW(bLateral20Map);

var volumeRerPart1Sx = MAP(COONS_PATCH([nubsUpper,nubsUnder,bLateral1,bLateral2]))(domain2);
DRAW(COLOR(mattDarkOrchid)(volumeRerPart1Sx));
var bL1Sx = bLateral1;
var bL2Sx = bLateral2;


//Boundary 

var controlsIntSx = reverseR([[369.8474426269531, 216.86338806152344, 0],[369.42303466796875, 214.97023010253906, 0],[369.219970703125, 213.34580993652344, 0],[368.5093078613281, 211.82293701171875, 0],[367.5955810546875, 210.90919494628906, 0],[366.1742248535156, 209.89395141601562, 0],[365.1589660644531, 209.18325805664062, 0],[363.02691650390625, 207.2542724609375, 0],[360.7933654785156, 205.62986755371094, 0],[358.2552185058594, 204.31002807617188, 0],[355.4125061035156, 203.8024139404297, 0],[353.28045654296875, 203.59934997558594, 0],[349.8285827636719, 202.6856231689453, 0],[345.9706115722656, 200.24900817871094, 0],[344.54925537109375, 197.10171508789062, 0],[345.3614501953125, 195.47731018066406, 0],[347.59503173828125, 195.57882690429688, 0],[349.21942138671875, 195.1727294921875, 0],[349.5240173339844, 193.9544219970703, 0],[349.0163879394531, 191.72085571289062, 0],[348.0011291503906, 190.19796752929688, 0],[346.1736755371094, 188.5735626220703, 0],[345.3614501953125, 187.2537384033203, 0],[343.83856201171875, 185.52780151367188, 0],[342.8233337402344, 184.6140594482422, 0],[341.0973815917969, 183.0911865234375, 0],[339.87908935546875, 182.58355712890625, 0],[338.7622985839844, 182.38050842285156, 0],[338.356201171875, 182.98965454101562, 0],[338.45770263671875, 183.70033264160156, 0],[338.6607666015625, 184.51254272460938, 0],[339.0668640136719, 185.6293182373047, 0],[339.7775573730469, 187.5583038330078, 0],[340.2851867675781, 189.48728942871094, 0],[340.7928161621094, 191.8223876953125, 0],[339.87908935546875, 193.85289001464844, 0],[338.15313720703125, 194.56358337402344, 0],[334.1936340332031, 193.54832458496094, 0],[332.1631164550781, 192.43153381347656, 0],[330.0310974121094, 192.12696838378906, 0],[326.07159423828125, 191.41627502441406, 0],[324.244140625, 191.51780700683594, 0],[322.9242858886719, 192.0254364013672, 0],[321.9090576171875, 192.63458251953125, 0],[321.6044616699219, 194.157470703125, 0],[321.9090576171875, 195.3757781982422, 0],[322.9242858886719, 196.69561767578125, 0],[323.73651123046875, 198.218505859375, 0],[324.4471740722656, 199.43679809570312, 0],[324.853271484375, 201.97494506835938, 0],[323.2288818359375, 203.7008819580078, 0],[319.2693786621094, 204.41156005859375, 0],[316.02056884765625, 203.49783325195312, 0],[314.0915832519531, 202.6856231689453, 0],[312.4671630859375, 201.8734130859375, 0],[310.3351135253906, 200.6551055908203, 0],[309.1168212890625, 200.3505401611328, 0],[307.6954650878906, 200.24900817871094, 0],[307.1878356933594, 200.14749145507812, 0],[306.78173828125, 200.24900817871094, 0],[305.6394348144531, 200.8373260498047, 0]]);
var nubsIntSx = createNubs(controlsIntSx);
var boundarySx = BEZIER(S1)([nubsUpper,nubsIntSx]);
var boundarySxMap= MAP (boundarySx)(domain2);
DRAW (COLOR(mattLightYellow)(boundarySxMap));

var lateralClosure = createBezierS2([bL1Sx, bL1Dx], mattDarkOrchid);
var lateralClosure = createBezierS2([bL2Sx, bL2Dx], mattDarkOrchid);

//---------------------------------------------------------------ROUGH ENDOPLASMATIC RETICULUM PART 5 DX-----------------------------------------------------------------------


var controlsUpper = [[399.37530517578125, 276.56707763671875, 0],[397.9389343261719, 277.5246276855469, 0],[397.46014404296875, 279.4397888183594, 0],[397.9389343261719, 282.3124694824219, 0],[399.37530517578125, 285.4245910644531, 0],[400.572265625, 289.4942321777344, 0],[401.5298156738281, 293.8033142089844, 0],[402.00860595703125, 297.15478515625, 0],[402.4873962402344, 300.74566650390625, 0],[401.76922607421875, 304.8153381347656, 0],[400.3328552246094, 307.4486389160156, 0],[397.9389343261719, 307.92742919921875, 0],[395.3056335449219, 306.2516784667969, 0],[393.8692626953125, 302.90020751953125, 0],[391.475341796875, 298.11236572265625, 0],[389.5602111816406, 293.0851135253906, 0],[388.3632507324219, 288.53668212890625, 0],[386.6875, 283.74884033203125, 0],[384.5329895019531, 278.7215881347656, 0],[381.899658203125, 273.215576171875, 0],[377.3512268066406, 267.7095642089844, 0],[373.28155517578125, 263.1611022949219, 0],[369.690673828125, 258.1338806152344, 0],[369.9300537109375, 254.064208984375, 0],[373.04217529296875, 251.90968322753906, 0],[377.11181640625, 252.14907836914062, 0],[380.9421081542969, 255.02178955078125, 0],[384.7723693847656, 258.1338806152344, 0],[387.88446044921875, 262.44293212890625, 0],[390.5177917480469, 261.9641418457031, 0]];
var nubsUpper = createNubs(controlsUpper);
var nubsUpperMap = MAP(nubsUpper)(domain1);
//DRAW(nubsUpperMap);

var controlsUnder = [[318.9671325683594, 291.50848388671875, -70],[317.2913818359375, 290.5509338378906, -70],[315.85504150390625, 291.7478942871094, -70],[316.09442138671875, 293.42364501953125, -70],[316.3338317871094, 295.5781555175781, -70],[316.8126220703125, 297.4932861328125, -70],[317.5307922363281, 299.408447265625, -70],[317.5307922363281, 301.08416748046875, -70],[317.2913818359375, 302.99932861328125, -70],[317.052001953125, 304.9144592285156, -70],[316.5732116699219, 307.0689697265625, -70],[315.61566162109375, 309.462890625, -70],[312.9823303222656, 308.984130859375, -70],[311.5459899902344, 307.3083801269531, -70],[310.5884094238281, 304.4356689453125, -70],[310.109619140625, 301.5629577636719, -70],[309.630859375, 298.45086669921875, -70],[309.3914489746094, 295.099365234375, -70],[308.91265869140625, 291.50848388671875, -70],[307.476318359375, 288.1570129394531, -70],[306.03997802734375, 284.8055114746094, -70],[305.0823974609375, 281.69342041015625, -70],[306.7581481933594, 279.5389099121094, -70],[309.8702392578125, 279.5389099121094, -70],[312.0247802734375, 281.9328308105469, -70],[313.70050048828125, 284.3267517089844, -70],[315.3762512207031, 286.9600524902344, -70],[317.052001953125, 286.9600524902344, -70],[318.24896240234375, 285.7630920410156, -70]];
var nubsUnder = createNubs(controlsUnder);
var Dx5 =nubsUnder;
var nubsUnderMap = MAP(nubsUnder)(domain1);
//DRAW(nubsUnderMap);


var pointsLateral1 = [[399.37530517578125, 276.56707763671875, 0],[372,281,-60],[345,286,-68],[318.9671325683594, 291.50848388671875, -70]];
var bLateral1 = BEZIER(S1)(pointsLateral1);

//var bLateral10 = BEZIER(S0)(pointsLateral1);
//var bLateral10Map = MAP(bLateral10)(domain1);
//DRAW(bLateral10Map);


var pointsLateral2 = [[390.5177917480469, 261.9641418457031, 0],[366,269,-60],[342,278,-68],[318.24896240234375, 285.7630920410156, -70]];
var bLateral2 = BEZIER(S1)(pointsLateral2);

//var bLateral20 = BEZIER(S0)(pointsLateralDx2);
//var bLateral20Map = MAP(bLateral20)(domain1);
//DRAW(bLateral20Map);

var volumeRerPart1Dx = MAP(COONS_PATCH([nubsUpper,nubsUnder,bLateral1,bLateral2]))(domain2);
DRAW(COLOR(mattDarkOrchid)(volumeRerPart1Dx));
var bL1Dx = bLateral1;
var bL2Dx = bLateral2;


//Boundary 

var controlsIntDx = reverseR([[392.2210693359375, 264.69659423828125, 0],[389.8271484375, 266.8511047363281, 0],[386.7150573730469, 265.17535400390625, 0],[384.0817565917969, 262.0632629394531, 0],[380.25146484375, 257.9936218261719, 0],[377.6181640625, 255.36029052734375, 0],[374.7454528808594, 254.8815155029297, 0],[374.02728271484375, 257.0360412597656, 0],[375.2242431640625, 259.90875244140625, 0],[378.57574462890625, 264.2178039550781, 0],[383.60296630859375, 269.96319580078125, 0],[385.75750732421875, 275.2298278808594, 0],[389.5877685546875, 282.4115905761719, 0],[390.78472900390625, 287.4388427734375, 0],[391.981689453125, 292.466064453125, 0],[393.6574401855469, 297.4932861328125, 0],[395.57257080078125, 301.8023681640625, 0],[397.2483215332031, 303.7174987792969, 0],[399.1634521484375, 303.23870849609375, 0],[399.8816223144531, 300.3659973144531, 0],[398.924072265625, 296.7751159667969, 0],[397.96649169921875, 292.9448547363281, 0],[397.0089111328125, 289.11456298828125, 0],[396.2907409667969, 285.523681640625, 0],[394.8544006347656, 281.69342041015625, 0],[394.8544006347656, 278.8207092285156, 0],[395.0937805175781, 276.1874084472656, 0],[397.4877014160156, 273.7934875488281, 0]]);
var nubsIntDx = createNubs(controlsIntDx);
var boundaryDx = BEZIER(S1)([nubsUpper,nubsIntDx]);
var boundaryDxMap= MAP (boundaryDx)(domain2);
DRAW (COLOR(mattLightYellow)(boundaryDxMap));

//---------------------------------------------------------------ROUGH ENDOPLASMATIC RETICULUM PART 5 SX-----------------------------------------------------------------------



var controlsUpper = [[399.37530517578125, 276.56707763671875, 0],[402.27557373046875, 277.3843688964844, 0],[405.1482849121094, 280.9752502441406, 0],[406.3452453613281, 285.2843017578125, 0],[406.8240051269531, 290.5509338378906, 0],[406.1058349609375, 297.0145263671875, 0],[405.3876647949219, 304.1962890625, 0],[405.3876647949219, 309.94171142578125, 0],[406.1058349609375, 316.6446838378906, 0],[408.499755859375, 320.71435546875, 0],[412.5694274902344, 322.15069580078125, 0],[416.1603088378906, 321.6719055175781, 0],[419.7511901855469, 319.2779846191406, 0],[421.42694091796875, 316.6446838378906, 0],[422.6239013671875, 312.57501220703125, 0],[422.86328125, 307.0690002441406, 0],[421.9057312011719, 298.21148681640625, 0],[420.22998046875, 290.0721435546875, 0],[417.5966491699219, 282.41162109375, 0],[413.28759765625, 273.7934875488281, 0],[409.2179260253906, 264.45721435546875, 0],[405.6270446777344, 258.7117919921875, 0],[401.3179931640625, 251.76942443847656, 0],[397.2483215332031, 245.0664520263672, 0],[394.13623046875, 239.5604248046875, 0],[388.8695983886719, 233.0968475341797, 0],[385.0393371582031, 228.78778076171875, 0],[380.2514953613281, 227.3514404296875, 0],[376.8999938964844, 230.22413635253906, 0],[376.6606140136719, 234.05441284179688, 0],[379.5333251953125, 240.2786102294922, 0],[382.4060363769531, 243.86949157714844, 0],[384.560546875, 247.93914794921875, 0],[386.715087890625, 252.2482147216797, 0],[388.8695983886719, 255.3603057861328, 0],[390.30596923828125, 259.1905822753906, 0],[390.5177917480469, 261.9641418457031, 0]];
var nubsUpper = createNubs(controlsUpper);
var nubsUpperMap = MAP(nubsUpper)(domain1);
//DRAW(nubsUpperMap);

var controlsUnder = [[318.9671325683594, 291.50848388671875, -80],[323.28936767578125, 291.9063415527344, -80],[324.54840087890625, 294.96392822265625, -80],[325.8074035644531, 297.4819641113281, -80],[325.6275329589844, 300.1798400878906, -80],[324.3685302734375, 302.51800537109375, -80],[323.28936767578125, 306.1152038574219, -80],[323.28936767578125, 310.79150390625, -80],[325.44769287109375, 313.66925048828125, -80],[328.864990234375, 313.3095397949219, -80],[330.4837341308594, 311.5109558105469, -80],[331.74273681640625, 308.27349853515625, -80],[332.8218994140625, 304.4964599609375, -80],[333.3614807128906, 300, -80],[332.8218994140625, 295.8632507324219, -80],[331.922607421875, 291.0070495605469, -80],[330.6636047363281, 286.5105895996094, -80],[329.4045715332031, 283.27313232421875, -80],[328.325439453125, 279.31622314453125, -80],[327.1064453125, 275.2298583984375, -80],[326.1671142578125, 273.02117919921875, -80],[325.6275329589844, 270.3232727050781, -80],[324.7282409667969, 267.985107421875, -80],[323.8289489746094, 265.46710205078125, -80],[322.0303649902344, 263.1289367675781, -80],[320.2317810058594, 262.76922607421875, -80],[317.7137451171875, 263.8483581542969, -80],[317.89361572265625, 266.0066833496094, -80],[318.4331970214844, 268.3448486328125, -80],[319.69219970703125, 270.3232727050781, -80],[320.0519104003906, 272.3017272949219, -80],[320.4116516113281, 274.81976318359375, -80],[320.9512023925781, 276.7982177734375, -80],[320.9512023925781, 278.7766418457031, -80],[320.9512023925781, 281.11480712890625, -80],[320.59149169921875, 282.91339111328125, -80],[318.24896240234375, 285.7630920410156, -80]];
var nubsUnder = createNubs(controlsUnder);
var Sx5 =nubsUnder;
var nubsUnderMap = MAP(nubsUnder)(domain1);
//DRAW(nubsUnderMap);


var pointsLateral1 = [[399.37530517578125, 276.56707763671875, 0],[372,281,-68.6],[345,286,-77.7],[318.9671325683594, 291.50848388671875, -80]];
var bLateral1 = BEZIER(S1)(pointsLateral1);

//var bLateral10 = BEZIER(S0)(pointsLateral1);
//var bLateral10Map = MAP(bLateral10)(domain1);
//DRAW(bLateral10Map);


var pointsLateral2 = [[390.5177917480469, 261.9641418457031, 0],[366,269,-68.6],[342,278,-77.7],[318.24896240234375, 285.7630920410156, -80]];
var bLateral2 = BEZIER(S1)(pointsLateral2);

//var bLateral20 = BEZIER(S0)(pointsLateralDx2);
//var bLateral20Map = MAP(bLateral20)(domain1);
//DRAW(bLateral20Map);

var volumeRerPart1Sx = MAP(COONS_PATCH([nubsUpper,nubsUnder,bLateral1,bLateral2]))(domain2);
DRAW(COLOR(mattDarkOrchid)(volumeRerPart1Sx));
var bL1Sx = bLateral1;
var bL2Sx = bLateral2;


//Boundary 

var controlsIntSx = reverseR([[392.4604797363281, 263.739013671875, 0],[393.1786804199219, 260.14813232421875, 0],[391.9817199707031, 254.40274047851562, 0],[389.8271789550781, 251.76942443847656, 0],[387.1938781738281, 248.1785430908203, 0],[384.7999572753906, 243.3907012939453, 0],[381.92724609375, 239.79981994628906, 0],[379.5333251953125, 234.53318786621094, 0],[379.772705078125, 232.378662109375, 0],[380.4908752441406, 230.7029266357422, 0],[383.8423767089844, 230.7029266357422, 0],[386.2362976074219, 235.01197814941406, 0],[390.54534912109375, 240.5179901123047, 0],[394.3756408691406, 245.7846221923828, 0],[398.924072265625, 252.4875946044922, 0],[402.27557373046875, 259.1905822753906, 0],[406.5846252441406, 264.69659423828125, 0],[411.3724670410156, 274.27227783203125, 0],[415.2027282714844, 282.6510009765625, 0],[418.075439453125, 290.5509338378906, 0],[419.27239990234375, 298.6902770996094, 0],[419.7511901855469, 306.82958984375, 0],[419.7511901855469, 312.0962219238281, 0],[419.03302001953125, 314.2507629394531, 0],[417.8360595703125, 315.6871032714844, 0],[415.9209289550781, 317.36285400390625, 0],[412.5694274902344, 317.36285400390625, 0],[410.1755065917969, 316.8840637207031, 0],[408.7391662597656, 314.72955322265625, 0],[407.7815856933594, 310.42047119140625, 0],[407.5422058105469, 304.9144592285156, 0],[409.69671630859375, 297.7326965332031, 0],[409.45733642578125, 290.3115539550781, 0],[409.2179260253906, 284.3267517089844, 0],[407.5422058105469, 280.0177001953125, 0],[402.51495361328125, 274.7510681152344, 0],[397.9665222167969, 273.7934875488281, 0]]);
var nubsIntSx = createNubs(controlsIntSx);
var boundarySx = BEZIER(S1)([nubsUpper,nubsIntSx]);
var boundarySxMap= MAP (boundarySx)(domain2);
DRAW (COLOR(mattLightYellow)(boundarySxMap));

var lateralClosure = createBezierS2([bL1Sx, bL1Dx], mattDarkOrchid);
var lateralClosure = createBezierS2([bL2Sx, bL2Dx], mattDarkOrchid);

//---------------------------------------------------------------ROUGH ENDOPLASMATIC RETICULUM PART 7 DX-----------------------------------------------------------------------


var controlsUpper = [[240.6220245361328, 391.0994873046875, 0],[243.49473571777344, 388.2267761230469, 0],[249.24014282226562, 387.98736572265625, 0],[253.07041931152344, 389.4237365722656, 0],[257.14007568359375, 391.0994873046875, 0],[260.4915771484375, 391.5782470703125, 0],[264.08245849609375, 392.29644775390625, 0],[268.1521301269531, 393.0146179199219, 0],[271.50360107421875, 393.2539978027344, 0],[274.6156921386719, 393.0146179199219, 0],[274.8551025390625, 391.3388671875, 0],[272.7005615234375, 389.6631164550781, 0],[268.87030029296875, 388.9449462890625, 0],[264.5612487792969, 388.70556640625, 0],[260.9703674316406, 387.50860595703125, 0],[257.8582458496094, 385.59344482421875, 0],[254.50677490234375, 383.917724609375, 0],[252.5916290283203, 381.2843933105469, 0],[251.63406372070312, 376.7359619140625, 0],[253.07041931152344, 373.8632507324219, 0],[256.90069580078125, 372.6662902832031, 0],[262.1673278808594, 373.14508056640625, 0],[267.9127197265625, 373.38446044921875, 0],[273.4187316894531, 374.1026306152344, 0],[278.9247741699219, 374.1026306152344, 0],[285.3883361816406, 374.342041015625, 0],[291.1337585449219, 374.82080078125, 0],[296.400390625, 373.14508056640625, 0],[300.4700622558594, 373.14508056640625, 0],[305.7366638183594, 374.342041015625, 0],[309.3275451660156, 375.77838134765625, 0],[310.5245056152344, 378.6510925292969, 0],[310.0457458496094, 381.0450134277344, 0],[307.8912048339844, 384.396484375, 0],[300.4700622558594, 386.3116455078125, 0],[293.04888916015625, 387.0298156738281, 0],[288.02166748046875, 387.98736572265625, 0],[285.1489562988281, 389.4237365722656, 0],[284.670166015625, 391.5782470703125, 0],[288.02166748046875, 393.0146179199219, 0],[293.7670593261719, 393.0146179199219, 0],[302.8639831542969, 393.7327880859375, 0]];
var nubsUpper = createNubs(controlsUpper);
var nubsUpperMap = MAP(nubsUpper)(domain1);
//DRAW(nubsUpperMap);

var controlsUnder = [[264.7491455078125, 324.7549133300781, -50],[266.1855163574219, 322.1216125488281, -50],[268.5794372558594, 322.1216125488281, -50],[270.2551574707031, 323.07916259765625, -50],[271.6915283203125, 324.276123046875, -50],[274.5642395019531, 325.7124938964844, -50],[276.9581604003906, 326.4306640625, -50],[279.3520812988281, 327.3882141113281, -50],[282.9429626464844, 327.86700439453125, -50],[283.9005126953125, 326.6700439453125, -50],[283.4217224121094, 324.276123046875, -50],[281.0278015136719, 323.5579528808594, -50],[278.1551208496094, 323.3185729980469, -50],[274.3248291015625, 321.8822021484375, -50],[271.4521179199219, 320.44586181640625, -50],[269.5369873046875, 318.29132080078125, -50],[269.5369873046875, 315.89739990234375, -50],[271.930908203125, 314.9398498535156, -50],[274.8036193847656, 315.1792297363281, -50],[278.873291015625, 315.65802001953125, -50],[281.506591796875, 315.65802001953125, -50],[286.0550537109375, 315.65802001953125, -50],[290.3641052246094, 316.1368103027344, -50],[293.4761962890625, 316.1368103027344, -50],[296.5882873535156, 316.1368103027344, -50],[299.46099853515625, 316.3761901855469, -50],[302.09429931640625, 316.85498046875, -50],[303.5306701660156, 318.5307312011719, -50],[302.3337097167969, 320.2064514160156, -50],[299.46099853515625, 322.1216125488281, -50],[295.8701171875, 323.07916259765625, -50],[292.7580261230469, 324.0367431640625, -50],[290.8428955078125, 324.0367431640625, -50],[289.4065246582031, 325.9518737792969, -50],[290.3641052246094, 327.3882141113281, -50],[294.1943664550781, 327.62762451171875, -50],[296.82769775390625, 327.3882141113281, -50],[299.22161865234375, 326.4306640625, -50],[301.85491943359375, 325.47308349609375, -50],[304.48822021484375, 324.0367431640625, -50],[305.9245910644531, 324.0367431640625, -50],[307.600341796875, 325.47308349609375, -50],[307.600341796875, 327.1488342285156, -50],[307.600341796875, 328.5851745605469, -50]];
var nubsUnder = createNubs(controlsUnder);
var Dx7 =nubsUnder;
var nubsUnderMap = MAP(nubsUnder)(domain1);
//DRAW(nubsUnderMap);


var pointsLateral1 = [[240.6220245361328, 391.0994873046875, 0],[248,368,-40],[256,346,-48],[264.7491455078125, 324.7549133300781, -50]];
var bLateral1 = BEZIER(S1)(pointsLateral1);

//var bLateral10 = BEZIER(S0)(pointsLateral1);
//var bLateral10Map = MAP(bLateral10)(domain1);
//DRAW(bLateral10Map);


var pointsLateral2 = [[302.8639831542969, 393.7327880859375, 0],[303.5,370,-40],[305.5,349,-48],[307.600341796875, 328.5851745605469, -50]];
var bLateral2 = BEZIER(S1)(pointsLateral2);

//var bLateral20 = BEZIER(S0)(pointsLateralDx2);
//var bLateral20Map = MAP(bLateral20)(domain1);
//DRAW(bLateral20Map);

var volumeRerPart1Dx = MAP(COONS_PATCH([nubsUpper,nubsUnder,bLateral1,bLateral2]))(domain2);
DRAW(COLOR(mattDarkOrchid)(volumeRerPart1Dx));
var bL1Dx = bLateral1;
var bL2Dx = bLateral2;


//Boundary 

var controlsIntDx = reverseR([[305.97607421875, 395.8873291015625, 0],[308.609375, 398.28125, 0],[305.4972839355469, 399.47821044921875, 0],[303.5821533203125, 397.32366943359375, 0],[301.6670227050781, 397.08428955078125, 0],[294.7246398925781, 396.3660888671875, 0],[288.26104736328125, 396.126708984375, 0],[282.7550354003906, 393.97216796875, 0],[280.6004943847656, 390.6206970214844, 0],[282.036865234375, 387.2691955566406, 0],[286.82470703125, 385.59344482421875, 0],[291.8519287109375, 384.8752746582031, 0],[298.5549011230469, 383.4389343261719, 0],[304.5397033691406, 382.0025634765625, 0],[305.4972839355469, 379.3692626953125, 0],[304.5397033691406, 378.17230224609375, 0],[302.38519287109375, 377.4541320800781, 0],[297.59735107421875, 377.6935119628906, 0],[292.5700988769531, 377.93292236328125, 0],[285.1489562988281, 377.6935119628906, 0],[278.68536376953125, 377.6935119628906, 0],[273.65814208984375, 377.2147216796875, 0],[266.9551696777344, 376.7359619140625, 0],[262.4067077636719, 376.2571716308594, 0],[259.29461669921875, 377.2147216796875, 0],[258.09765625, 378.17230224609375, 0],[257.8582458496094, 380.56622314453125, 0],[261.2097473144531, 382.72076416015625, 0],[263.6036682128906, 383.917724609375, 0],[266.47637939453125, 384.6358947753906, 0],[270.5460510253906, 386.3116455078125, 0],[273.4187316894531, 386.7904052734375, 0],[276.05206298828125, 388.2267761230469, 0],[277.0096130371094, 390.38128662109375, 0],[277.7278137207031, 393.493408203125, 0],[276.05206298828125, 395.8873291015625, 0],[273.89752197265625, 396.8448791503906, 0],[270.306640625, 396.8448791503906, 0],[266.9551696777344, 396.6054992675781, 0],[264.5612487792969, 395.6479187011719, 0],[260.4915771484375, 394.4509582519531, 0],[256.6612854003906, 393.493408203125, 0],[252.3522491455078, 391.5782470703125, 0],[249.4795379638672, 390.38128662109375, 0],[245.64926147460938, 390.8600769042969, 0],[243.97352600097656, 392.53582763671875, 0]]);
var nubsIntDx = createNubs(controlsIntDx);
var boundaryDx = BEZIER(S1)([nubsUpper,nubsIntDx]);
var boundaryDxMap= MAP (boundaryDx)(domain2);
DRAW (COLOR(mattLightYellow)(boundaryDxMap));

//---------------------------------------------------------------ROUGH ENDOPLASMATIC RETICULUM PART 7 SX-----------------------------------------------------------------------



var controlsUpper = [[240.6220245361328, 391.0994873046875, 0],[241.5281219482422, 394.4179992675781, 0],[242.9644775390625, 397.53009033203125, 0],[245.5977783203125, 400.1634216308594, 0],[249.18865966796875, 401.1209716796875, 0],[252.06137084960938, 401.83917236328125, 0],[255.1734619140625, 402.5573425292969, 0],[259.0037536621094, 403.2755126953125, 0],[261.6370544433594, 403.2755126953125, 0],[264.0309753417969, 403.2755126953125, 0],[266.1855163574219, 403.7543029785156, 0],[267.3824768066406, 405.4300537109375, 0],[265.94610595703125, 406.86639404296875, 0],[262.1158447265625, 408.0633544921875, 0],[257.8067932128906, 407.823974609375, 0],[254.69468688964844, 407.823974609375, 0],[253.01893615722656, 409.02093505859375, 0],[251.34320068359375, 410.2178955078125, 0],[250.62501525878906, 412.8511962890625, 0],[251.58258056640625, 416.9208679199219, 0],[253.97650146484375, 419.7935791015625, 0],[257.8067932128906, 421.46929931640625, 0],[261.3976745605469, 421.9480895996094, 0],[264.2703552246094, 421.7087097167969, 0],[267.14306640625, 420.2723388671875, 0],[269.5369873046875, 418.59661865234375, 0],[271.6915283203125, 417.6390380859375, 0],[273.3672790527344, 415.9632873535156, 0],[275.7611999511719, 415.0057373046875, 0],[279.8308410644531, 416.68145751953125, 0],[282.70355224609375, 418.59661865234375, 0],[285.3368835449219, 420.7511291503906, 0],[288.6883544921875, 422.4268798828125, 0],[292.7580261230469, 423.62384033203125, 0],[297.06707763671875, 424.5814208984375, 0],[301.3761291503906, 424.82080078125, 0],[304.48822021484375, 423.38446044921875, 0],[307.8397216796875, 420.5117492675781, 0],[308.0791015625, 417.399658203125, 0],[306.40338134765625, 413.3299865722656, 0],[302.3337097167969, 411.65423583984375, 0],[297.5458679199219, 410.457275390625, 0],[291.8004455566406, 409.9784851074219, 0],[287.49139404296875, 408.302734375, 0],[285.3368835449219, 406.3876037597656, 0],[287.49139404296875, 404.23309326171875, 0],[293.4761962890625, 404.23309326171875, 0],[298.2640380859375, 404.71185302734375, 0],[302.8639831542969, 393.7327880859375, 0]];
var nubsUpper = createNubs(controlsUpper);
var nubsUpperMap = MAP(nubsUpper)(domain1);
//DRAW(nubsUpperMap);

var controlsUnder = [[264.7491455078125, 324.7549133300781, -60],[264.6896057128906, 325.3401794433594,  -60],[265.47686767578125, 327.1882629394531,  -60],[266.604736328125, 328.4522705078125,  -60],[268.5198974609375, 329.64923095703125,  -60],[269.95623779296875, 330.3674011230469,  -60],[271.8713684082031, 330.6068115234375,  -60],[274.665771484375, 331.2421875,  -60],[277.0981140136719, 331.78271484375,  -60],[278.71966552734375, 332.593505859375,  -60],[279.53192138671875, 334.67645263671875,  -60],[278.5743408203125, 337.07037353515625,  -60],[276.180419921875, 337.07037353515625,  -60],[273.0683288574219, 337.78857421875,  -60],[271.1531982421875, 337.78857421875,  -60],[269.4774475097656, 339.22491455078125,  -60],[269.2380676269531, 340.6612548828125,  -60],[269.2380676269531, 342.0976257324219,  -60],[271.392578125, 343.77337646484375,  -60],[273.0683288574219, 344.25213623046875,  -60],[277.13800048828125, 344.01275634765625,  -60],[279.53192138671875, 343.2945861816406,  -60],[281.2076721191406, 341.85821533203125,  -60],[283.3621826171875, 341.1400451660156,  -60],[285.0379333496094, 340.1824951171875,  -60],[287.91064453125, 339.9430847167969,  -60],[290.065185546875, 339.9430847167969,  -60],[291.9803161621094, 340.6612548828125,  -60],[293.65606689453125, 342.0976257324219,  -60],[295.8105773925781, 343.2945861816406,  -60],[298.68328857421875, 344.01275634765625,  -60],[300.83782958984375, 343.77337646484375,  -60],[303.47113037109375, 342.3370056152344,  -60],[304.4287109375, 341.61883544921875,  -60],[305.86505126953125, 340.1824951171875,  -60],[306.10443115234375, 338.267333984375,  -60],[303.9499206542969, 337.5491638183594,  -60],[301.07720947265625, 337.07037353515625,  -60],[298.5838623046875, 337.05279541015625,  -60],[296.6920471191406, 336.51226806640625,  -60],[294.8002014160156, 336.1069030761719,  -60],[293.31378173828125, 334.3501892089844,  -60],[295.0704650878906, 333.1340026855469,  -60],[297.2325744628906, 332.3232421875,  -60],[299.800048828125, 331.3773193359375,  -60],[301.5567321777344, 330.5665283203125,  -60],[303.1783142089844, 330.431396484375,  -60],[305.07012939453125, 330.0260009765625,  -60],[306.96197509765625, 328.9449768066406,  -60],[307.600341796875, 328.5851745605469, -60]];
var nubsUnder = createNubs(controlsUnder);
var Sx7 =nubsUnder;
var nubsUnderMap = MAP(nubsUnder)(domain1);
//DRAW(nubsUnderMap);


var pointsLateral1 = [[240.6220245361328, 391.0994873046875, 0],[248,368,-48],[256,346,-57.8],[264.7491455078125, 324.7549133300781, -60]];
var bLateral1 = BEZIER(S1)(pointsLateral1);

//var bLateral10 = BEZIER(S0)(pointsLateral1);
//var bLateral10Map = MAP(bLateral10)(domain1);
//DRAW(bLateral10Map);


var pointsLateral2 = [[302.8639831542969, 393.7327880859375, 0],[303.5,370,-48],[305.5,349,-57,8],[307.600341796875, 328.5851745605469, -60]];
var bLateral2 = BEZIER(S1)(pointsLateral2);

//var bLateral20 = BEZIER(S0)(pointsLateralDx2);
//var bLateral20Map = MAP(bLateral20)(domain1);
//DRAW(bLateral20Map);

var volumeRerPart1Sx = MAP(COONS_PATCH([nubsUpper,nubsUnder,bLateral1,bLateral2]))(domain2);
DRAW(COLOR(mattDarkOrchid)(volumeRerPart1Sx));
var bL1Sx = bLateral1;
var bL2Sx = bLateral2;


//Boundary 

var controlsIntSx = reverseR([[305.44580078125, 399.44525146484375, 0],[305.44580078125, 400.1634216308594, 0],[304.48822021484375, 401.1209716796875, 0],[303.5306701660156, 401.3603820800781, 0],[298.9822082519531, 401.3603820800781, 0],[293.9549865722656, 401.83917236328125, 0],[287.0126037597656, 401.5997619628906, 0],[282.70355224609375, 403.2755126953125, 0],[282.2247619628906, 405.66943359375, 0],[283.1823425292969, 409.02093505859375, 0],[286.5338134765625, 410.457275390625, 0],[290.6034851074219, 411.41485595703125, 0],[296.82769775390625, 412.8511962890625, 0],[300.8973388671875, 414.5269470214844, 0],[303.7700500488281, 415.4844970703125, 0],[304.9670104980469, 417.6390380859375, 0],[303.7700500488281, 419.7935791015625, 0],[300.8973388671875, 420.5117492675781, 0],[297.30645751953125, 420.7511291503906, 0],[294.67315673828125, 420.7511291503906, 0],[291.5610656738281, 419.7935791015625, 0],[288.2095642089844, 417.399658203125, 0],[284.85809326171875, 415.9632873535156, 0],[282.70355224609375, 414.04815673828125, 0],[277.67633056640625, 411.65423583984375, 0],[273.8460388183594, 411.65423583984375, 0],[271.6915283203125, 413.5693664550781, 0],[269.297607421875, 415.7239074707031, 0],[267.14306640625, 416.68145751953125, 0],[263.55218505859375, 418.1178283691406, 0],[259.2431335449219, 418.1178283691406, 0],[255.65225219726562, 417.1602478027344, 0],[253.97650146484375, 414.7663269042969, 0],[253.97650146484375, 411.89361572265625, 0],[256.13104248046875, 410.6966552734375, 0],[260.4400939941406, 410.457275390625, 0],[264.509765625, 410.2178955078125, 0],[269.7763977050781, 407.823974609375, 0],[271.4521179199219, 404.9512634277344, 0],[269.7763977050781, 401.3603820800781, 0],[264.509765625, 400.4028015136719, 0],[259.0037536621094, 400.1634216308594, 0],[252.06137084960938, 399.68463134765625, 0],[247.51292419433594, 397.7695007324219, 0],[246.3159637451172, 396.09375, 0],[245.3583984375, 393.46044921875, 0],[245.3583984375, 391.7846984863281, 0]]);
var nubsIntSx = createNubs(controlsIntSx);
var boundarySx = BEZIER(S1)([nubsUpper,nubsIntSx]);
var boundarySxMap= MAP (boundarySx)(domain2);
DRAW (COLOR(mattLightYellow)(boundarySxMap));

var lateralClosure = createBezierS2([bL1Sx, bL1Dx], mattDarkOrchid);
var lateralClosure = createBezierS2([bL2Sx, bL2Dx], mattDarkOrchid);

var point = BEZIER(S1)([[285, 297, -79]]);
var closure1 = createBezierS2([Dx1,point], mattDarkOrchid);
var closure2 = createBezierS2([Sx1, point], mattDarkOrchid);
var closure2 = createBezierS2([Dx3, point], mattDarkOrchid);
var closure2 = createBezierS2([Dx5, point], mattDarkOrchid);
var closure2 = createBezierS2([Dx7, point], mattDarkOrchid);
var closure2 = createBezierS2([Sx3, point], mattDarkOrchid);
var closure2 = createBezierS2([Sx5, point], mattDarkOrchid);
var closure2 = createBezierS2([Sx7, point], mattDarkOrchid);