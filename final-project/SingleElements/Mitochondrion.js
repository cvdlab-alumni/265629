/*Domain*/
var domain1 = INTERVALS(1)(100);
var domain2 = DOMAIN([[0,1],[0,1]])([100,100]);
var domain3 = DOMAIN([[0,1],[0,1],[0,1]])([15,15,1]);

/*Color*/
var mattBurgundy = [139/255, 0, 0, 1];
var mattCoralRed = [240/255,128/255, 128/255, 1];
var mattIndianRed = [205/255, 92/255, 92/255, 1];

/*Function*/

/* This function creates an array of knots used by the function nubs. The function takes as input an array of control points. It returns an array of knots. 

   INPUT - An array of points

   OUTPUT - An array of knots.

*/

function knots (point) {
  var k = 2; 
  var m =point.length;
  var n = (m + k + 1);
  var first = 1;
  var last = n - 3;

  var knots = [];

  for (var i = 0; i < 3; i++) {
     knots[i] = 0;
    };

  for (var i = 3; i < last; i++,first++) {
     knots[i] = first;

    };

  for (var i = last; i < n; i++) {
     knots[i] = first;
    };

  return knots;
};

/* This function creates a curve with the function Nubs. The function takes as input an array of control points. It returns to the curve. 

   INPUT - An array of points
   
   OUTPUT - A curve built with the function NUBS

*/
function createNubs (point) {
  
  var knots1 = knots(point);
  var c1 = NUBS(S0)(2)(knots1)(point);
  var curve1 = MAP(c1)(domain1);
  //DRAW(curve1);
  return c1;
}

/* This function creates a 1 grade Bezier curve. The function takes as input an array of curves. It returns to the Bezier curve. 

   INPUT - An array of curves

   OUTPUT - A 1 grade Bezier curve

*/

function createBezierS1(curves) {
  var b1 = BEZIER(S1)(curves);
  var b1Map = MAP(b1)(domain2);
  //DRAW(b1Map);
   return b1;
}

/* This function creates a 1 grade Bezier curve. It takes in input an initial point, a final point and an array of points. It returns the 1 grade Bezier curve. 
 
   INPUT - An initial point, a final point and an array of points.

   OUTPUT - A 1 grade Bezier curve. 

*/
function createCurveSurface(pointStart, pointFinal, points) {
  var nubs = [];
  nubs.push(pointStart);
  var j = 1;
  for(var i=0; i<points.length; i++) {
      nubs[j] = createNubs(points[i]);
      //DRAW(nubs[j]);
      j++;
  }
  nubs.push(pointFinal);

  return createBezierS1(nubs);
    }


/* This function takes an array as input and reverses it. It returns the reversed array. 
   
   INPUT - An array 

   OUTPUT - A reversed array 

*/

function reverseR(array) {
  var arrayReturn = [];
  var j = 0;
  for(var i = array.length-1; i>=0; i--) {
        
        arrayReturn[j] = array[i];
        j++;
  }
  return arrayReturn;
}


//Outer membrane volume ext

  //Control point
    var cp1 = [[78.42952728271484-9, 319.5246887207031, 0 ],[85.37791442871094-9, 319.78509521484375, -10 ],[94.61820983886719+5, 319.78509521484375, 0 ],[101.09173583984375+5, 320.6038513183594, 0 ]];
    var cp2 = [[70.4506607055664-9, 324.9661865234375, 0 ],[83.0360336303711-9, 325.6783142089844, -10 ],[95.24503326416016+5, 326.1571044921875, -10 ],[108.84198760986328+5, 327.59832763671875, 0 ]];
    var cp3 = [[59.70538330078125-9, 337.8841247558594, 0 ],[82.77519989013672-9, 337.3196716308594, -30 ],[96.58267974853516+5, 337.0151062011719, -30 ],[114.5835952758789+5, 336.41815185546875, 0 ]];
    var cp4 = [[54.21564865112305-9, 353.04376220703125, 0 ],[73.07366180419922-9, 352.80072021484375, -46 ],[102.5321273803711+5, 352.93585205078125, -46 ],[119.51473999023438+5, 353.0233459472656, 0 ]];
    var cp5 = [[52.94705581665039-9, 367.6966857910156, 0 ],[72.40585327148438-9, 367.2912902832031, -55 ],[102.26971435546875+5, 367.5615539550781, -55 ],[119.83668518066406+5, 367.9669494628906, 0 ]];
    var cp6 = [[53.209163665771484-9, 381.70257568359375, 0 ],[73.28105926513672-9, 381.5002746582031, -60 ],[102.77790069580078, 381.14056396484375, -60 ],[119.5047607421875, 381.8599853515625, 0 ]];
    var cp7 = [[52.59729766845703-9, 395.4254455566406, 0 ],[73.82296752929688-9, 395.231201171875, -59 ],[102.3516616821289, 395.231201171875, -59 ],[119.00186157226562, 395.94189453125, 0 ]];
    var cp8 = [[53.82242965698242-9, 409.6478576660156, 0 ],[73.21382141113281-9, 409.6478576660156, -60 ],[102.45319366455078, 409.1402282714844, -60 ],[119.91559600830078, 408.3280029296875, 0 ]];
    var cp9 = [[56.76667785644531-9, 423.7598876953125, 0 ],[74.03883361816406-9, 423.8822021484375, -55 ],[103.6324234008789+5, 423.20654296875, -55 ],[124.26261138916016+5, 422.7600402832031, 0 ]];
    var cp10 = [[60.256771087646484-9, 437.7486267089844, 0 ],[78.71070861816406-9, 437.9825439453125, -46 ],[103.78752899169922+5, 438.18560791015625, -46 ],[127.0368881225586+5, 438.49017333984375, 0 ]];
    var cp11 = [[67.03526306152344-9, 452.3992004394531, 0 ],[81.95952606201172-9, 452.29766845703125, -30 ],[112.01110076904297+5, 451.9930725097656, -30 ],[127.13841247558594+5, 451.28240966796875, 0 ]];
    var cp12 = [[73.93899536132812-9, 464.8868408203125, 0 ],[87.03579711914062-9, 466.0036315917969, -15 ],[110.38668060302734+5, 466.5112609863281, -15 ],[122.67127990722656+5, 466.5112609863281, 0 ]];
    var cp13 = [[87.44190216064453-9, 476.663818359375, 0 ],[95.97004699707031-9, 476.0546569824219, 0 ],[105.61498260498047+5, 475.2424621582031, 0 ],[116.47821807861328+5, 474.12567138671875, 0 ]];


  var volumeOut = createCurveSurface([88.50161743164062,318.9059753417969,0],[101.99493408203125,477.54669189453125,0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13]);
DRAW(COLOR(mattBurgundy)(MAP(volumeOut)(domain2)));
 
 //Outer membrane volume int

  var cp1 =  [[81.15792083740234-9, 322.9072265625, 0 ],[86.31511688232422-9, 322.76678466796875, 0 ],[89.73242950439453+5, 322.76678466796875, 0 ],[96.1335678100586+5, 322.9072265625, 0 ]];
  var cp2 =  [[69.0499496459961-9, 330.8730163574219, 0 ],[83.4823989868164-9, 330.447998046875, -9 ],[92.10050964355469+5, 330.447998046875, -9 ],[105.05523681640625+5, 330.55438232421875, 0 ]];
  var cp3 =  [[63.13407516479492-9, 341.22064208984375, 0 ],[78.6945571899414-9, 340.7418518066406, -28 ],[96.88835144042969+5, 340.5024719238281, -28 ],[111.49127197265625+5, 340.5024719238281, 0 ]];
  var cp4 =  [[58.825016021728516-9, 351.0357360839844, 0 ],[76.3006362915039-9, 350.79632568359375, -44 ],[99.76106262207031+5, 350.79632568359375, -44 ],[113.97689819335938+5, 350.3094787597656, 0 ]];
  var cp5 =  [[57.38866424560547-9, 364.4416809082031, 0 ],[73.9067153930664-9, 363.962890625, -53 ],[101.43680572509766+5, 364.4416809082031, -53 ],[115.32154083251953+5, 363.7235107421875, 0 ]];
  var cp6 =  [[56.941978454589844-9, 379.942138671875, 0 ],[73.42793273925781-9, 380.0021667480469, -58 ],[102.15497589111328, 380.48095703125, -58 ],[115.32154083251953, 380.959716796875, 0 ]];
  var cp7 =  [[57.89787292480469-9, 395.2364196777344, 0 ],[76.3006362915039-9, 394.844482421875, -53 ],[103.5913314819336, 394.6050720214844, -53 ],[115.57005310058594, 393.32464599609375, 0 ]];
  var cp8 =  [[59.49102783203125-9, 411.16796875, 0 ],[78.92750549316406-9, 411.16796875, -58 ],[101.91558837890625, 411.84130859375, -58 ],[116.75789642333984, 411.84130859375, 0 ]];
  var cp9 =  [[63.63322830200195-9, 428.6926574707031, 0 ],[84.91875457763672-9, 428.5987548828125, -53 ],[106.46403503417969+5, 428.3593444824219, -53 ],[121.06695556640625+5, 428.5987548828125, 0 ]];
  var cp10 =  [[70.32447814941406-9, 443.34967041015625, 0 ],[91.99137115478516-9, 443.6683044433594, -44 ],[108.85795593261719+5, 442.4834899902344, -44 ],[123.21719360351562+5, 442.7124328613281, 0 ]];
  var cp11 =  [[73.82941436767578-9, 455.1390380859375, 0 ],[93.536865234375-9, 455.6500549316406, -28 ],[106.94281768798828+5, 455.8894348144531, -28 ],[122.26390838623047+5, 455.8894348144531, 0 ]];
  var cp12 =  [[81.0884780883789-9, 465.2257385253906, 0 ],[97.08946228027344-9, 465.6538391113281, -12 ],[105.0276870727539+5, 465.70452880859375, -12 ],[119.71224975585938+5, 464.69793701171875, 0 ]];
  var cp13 =  [[89.94598388671875-9, 473.6044616699219, 0 ],[98.8034896850586-9, 473.8438415527344+3, 0 ],[104.78829193115234+3, 474.083251953125+5, 0 ],[109.81552886962890, 473.6044616699219+5, 0 ]];
  
var volumeIn = createCurveSurface([88.4175796508789, 321.68878173828125, 0],[101.98870086669922, 474.3639221191406, 0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13]);
//DRAW(volumeIn);

var lisosome3D = MAP(BEZIER(S2)([volumeIn,volumeOut]))(domain3);
DRAW(COLOR(mattBurgundy)(lisosome3D));


//Inner membrane volume 

  //Inner membrane volume SX

    //Upper curve
      var point_Ext_InnerSX = [[88.66173553466797, 328.84747314453125, 0],[86.53084564208984, 328.41192626953125, 0],[84.29613494873047, 328.2383117675781, 0],[81.8595199584961, 328.13677978515625, 0],[79.52442932128906, 328.2383117675781, 0],[76.98628997802734, 328.6444091796875, 0],[75.4634017944336, 329.65966796875, 0],[74.0375747680664, 330.9335021972656, 0],[73.33136749267578, 332.7054443359375, 0],[73.53441619873047, 334.53289794921875, 0],[74.04204559326172, 336.56341552734375, 0],[75.36187744140625, 338.0863037109375, 0],[76.98628997802734, 339.60919189453125, 0],[78.10307312011719, 341.4366455078125, 0],[78.71222686767578, 343.0610656738281, 0],[79.2198486328125, 344.7869873046875, 0],[79.52442932128906, 346.7159729003906, 0],[79.52442932128906, 348.64495849609375, 0],[78.91527557373047, 350.67547607421875, 0],[76.98628997802734, 351.38616943359375, 0],[74.95577239990234, 351.38616943359375, 0],[73.63594055175781, 350.472412109375, 0],[72.41763305664062, 348.9495544433594, 0],[71.40238189697266, 347.1220703125, 0],[70.69170379638672, 345.59918212890625, 0],[69.27033996582031, 344.5839538574219, 0],[67.1383056640625, 344.482421875, 0],[65.41236877441406, 345.1930847167969, 0],[64.60016632080078, 346.7159729003906, 0],[63.99100875854492, 349.152587890625, 0],[63.4927978515625, 351.62188720703125, 0],[63.37818145751953, 353.9715270996094, 0],[63.37818145751953, 356.60772705078125, 0],[63.836647033691406, 359.1293029785156, 0],[64.9255142211914, 360.791259765625, 0],[66.123046875, 361.6402587890625, 0],[67.7474594116211, 361.74176025390625, 0],[69.51019287109375, 361.3070373535156, 0],[71.11483764648438, 360.4474182128906, 0],[72.77678680419922, 359.87432861328125, 0],[74.44815063476562, 360.3204040527344, 0],[75.56492614746094, 361.3356628417969, 0],[76.58018493652344, 363.2646484375, 0],[76.58018493652344, 365.1936340332031, 0],[75.97103118896484, 367.2241516113281, 0],[75.05730438232422, 368.9501037597656, 0],[73.83899688720703, 370.7775573730469, 0],[71.40238189697266, 371.6912841796875, 0],[69.16881561279297, 371.7928161621094, 0],[66.75938415527344, 371.3933410644531, 0],[64.69627380371094, 371.4506530761719, 0],[63.091636657714844, 372.4248962402344, 0],[62.00277328491211, 373.9149169921875, 0],[61.372379302978516, 375.6341857910156, 0],[61.6589241027832, 377.5253601074219, 0],[62.518558502197266, 378.9580383300781, 0],[64.00858306884766, 380.1615295410156, 0],[65.78514862060547, 381.30767822265625, 0],[67.90556335449219, 382.1673278808594, 0],[70.25521850585938, 383.6573486328125, 0],[72.31832122802734, 385.2046813964844, 0],[74.38143157958984, 386.52276611328125, 0],[76.32992553710938, 388.47125244140625, 0],[77.41878509521484, 390.0185852050781, 0],[77.41878509521484, 391.1074523925781, 0],[76.7310791015625, 391.56591796875, 0],[75.58491516113281, 391.50860595703125, 0],[73.92296600341797, 390.8209228515625, 0],[72.03178405761719, 389.44549560546875, 0],[70.08329010009766, 387.8981628417969, 0],[68.30672454833984, 386.52276611328125, 0],[66.35823059082031, 385.3765869140625, 0],[65.0401382446289, 385.3765869140625, 0],[63.550113677978516, 386.1216125488281, 0],[62.80509948730469, 387.3251037597656, 0],[62.34663391113281, 389.44549560546875, 0],[61.945472717285156, 392.1963195800781, 0],[61.71623992919922, 395.4629211425781, 0],[61.658931732177734, 399.0733337402344, 0],[61.83085632324219, 402.4545593261719, 0],[62.060089111328125, 406.1795959472656, 0],[62.86241149902344, 409.6754455566406, 0],[64.00858306884766, 412.5981750488281, 0],[65.61322021484375, 414.3174133300781, 0],[67.6190185546875, 415.06243896484375, 0],[70.14059448242188, 415.1197509765625, 0],[72.719482421875, 414.6039733886719, 0],[74.89720916748047, 414.3747253417969, 0],[76.67377471923828, 414.8905029296875, 0],[77.53340148925781, 415.86474609375, 0],[77.53340148925781, 416.89630126953125, 0],[76.50184631347656, 417.98516845703125, 0],[74.55335998535156, 418.5582580566406, 0],[72.20370483398438, 419.18865966796875, 0],[70.19790649414062, 419.990966796875, 0],[67.96287536621094, 421.3090515136719, 0],[66.3009262084961, 422.9136962890625, 0],[64.69628143310547, 424.80487060546875, 0],[63.49280548095703, 426.8106994628906, 0],[63.89396286010742, 428.4726257324219, 0],[65.2120590209961, 430.13458251953125, 0],[67.10324096679688, 431.10882568359375, 0],[68.99442291259766, 431.3953552246094, 0],[71.1148452758789, 430.7649841308594, 0],[73.6937255859375, 430.19189453125, 0],[75.81414794921875, 430.0772705078125, 0],[78.04917907714844, 430.0772705078125, 0],[80.16959381103516, 430.5930480957031, 0],[81.71692657470703, 431.4526672363281, 0],[82.4619369506836, 432.5988464355469, 0],[81.60231018066406, 433.9169616699219, 0],[80.3988265991211, 435.0631103515625, 0],[78.794189453125, 435.5788879394531, 0],[76.78839111328125, 435.4642639160156, 0],[74.72528076171875, 435.4069519042969, 0],[72.31832122802734, 435.2350158691406, 0],[70.3125228881836, 435.4642639160156, 0],[68.99442291259766, 436.2665710449219, 0],[68.42134094238281, 437.69927978515625, 0],[68.30671691894531, 439.3039245605469, 0],[68.47864532470703, 440.7366638183594, 0],[68.9371109008789, 442.6278381347656, 0],[69.73943328857422, 444.2897644042969, 0],[70.71367645263672, 445.8944091796875, 0],[71.57331085205078, 447.15521240234375, 0],[72.49024200439453, 448.3013916015625, 0],[73.46449279785156, 449.6767883300781, 0],[74.89720153808594, 451.1094970703125, 0],[76.04337310791016, 451.9691162109375, 0],[77.01761627197266, 452.3702697753906, 0],[78.39302062988281, 452.5995178222656, 0],[79.82573699951172, 452.4848937988281, 0],[81.0865249633789, 452.14105224609375, 0],[82.11808776855469, 450.994873046875, 0],[83.32156372070312, 449.6194763183594, 0],[84.29580688476562, 448.5879211425781, 0],[85.78583526611328, 447.3271484375, 0],[86.9320068359375, 446.23828125, 0],[88.59395599365234, 445.20672607421875, 0],[90.08396911621094, 444.920166015625, 0],[91.23014068603516, 445.3213195800781, 0],[91.68861389160156, 446.6394348144531, 0],[91.17283630371094, 448.12945556640625, 0],[90.1985855102539, 449.3902282714844, 0],[88.47933197021484, 450.7656555175781, 0],[86.98931121826172, 451.91180419921875, 0],[85.49928283691406, 453.172607421875, 0],[84.1238784790039, 454.891845703125, 0],[83.3215560913086, 456.7257385253906, 0],[82.74847412109375, 458.9034729003906, 0],[82.40462493896484, 460.966552734375, 0],[82.51924133300781, 462.8577575683594, 0],[82.97770690917969, 464.9781799316406, 0],[84.1238784790039, 466.0097351074219, 0],[85.2127456665039, 466.8693542480469, 0],[86.30160522460938, 467.3851318359375, 0],[87.50508117675781, 467.7862854003906, 0],[88.82318115234375, 467.6716613769531, 0],[90.31320190429688, 467.2705078125, 0],[91.40206909179688, 466.2962646484375, 0],[92.03246307373047, 464.9781799316406, 0],[93.17863464355469, 463.8893127441406, 0],[94.26749420166016, 463.0296630859375, 0],[95.52828216552734, 462.8004455566406, 0],[96.61714935302734, 462.7431335449219, 0]]; 
      var Su0SX =createNubs(point_Ext_InnerSX);
      //var curve0SX = MAP(Su0SX)(domain1);
      //DRAW(curve0SX);

    //Bottom curve
      var point_BottomSX = reverseR([[96.61714935302734+1, 462.7431335449219-0.5,-16],[91.44792175292969, 444.926513671875, -28], [88.10330200195312, 430.2937927246094, -36], [80.5779037475586, 406.0452880859375, -44], [79.74175262451172, 381.37872314453125, -36], [80.99598693847656, 353.7856140136719, -28], [88.66173553466797, 328.84747314453125+6,-16]]); //retta fondo
      var Su1SX =createNubs(point_BottomSX);
      
    //Laterals curves
      var point_LateralSX1 = [[88.66173553466797, 328.84747314453125,0], [78.33412170410156, 329.3287048339844,-10], [88.66173553466797, 328.84747314453125+6,-16]]; //retta profondità
      var Sv0SX = BEZIER(S1)(point_LateralSX1);
      //var curve2SX = MAP(BEZIER(S0)(point_LateralSX1))(domain1);
      //DRAW(curve2SX);

      var point_LateralSX2 = [[96.61714935302734, 462.7431335449219,0],[86.96328735351562, 462.3104248046875, -10],[96.61714935302734+1, 462.7431335449219-0.5,-16]]; // retta rofondità
      var Sv1SX = BEZIER(S1)(point_LateralSX2);
      //var curve3SX = MAP( BEZIER(S0)(point_LateralSX1))(domain1);
      //DRAW(curve3SX);

    //Volume generation
    var outDX = MAP(COONS_PATCH([Su0SX,Su1SX,Sv0SX,Sv1SX]))(domain2);
    //DRAW(outDX);


  //Inner membrane volume DX

    //Upper curve
      var point_Ext_InnerDX = reverseR( [[88.66173553466797, 328.84747314453125, 0],[90.07969665527344, 329.2727355957031, 0],[91.39779663085938, 329.78851318359375, 0],[92.77320098876953, 330.4762268066406, 0],[94.14860534667969, 331.2785339355469, 0],[95.40939331054688, 332.08087158203125, 0],[96.84210968017578, 332.997802734375, 0],[98.44674682617188, 334.2012939453125, 0],[99.70753479003906, 335.23284912109375, 0],[101.19756317138672, 336.3216857910156, 0],[102.6302719116211, 337.5824890136719, 0],[103.94837188720703, 338.7286682128906, 0],[105.20915985107422, 340.33331298828125, 0],[106.35533142089844, 341.8233337402344, 0],[107.15765380859375, 343.0841064453125, 0],[107.55880737304688, 344.6314392089844, 0],[107.67343139648438, 346.06414794921875, 0],[107.4441909790039, 347.2103271484375, 0],[107.100341796875, 348.35650634765625, 0],[106.18340301513672, 349.21612548828125, 0],[104.63607788085938, 349.5599670410156, 0],[103.03407287597656, 349.65802001953125, 0],[101.38426208496094, 349.59332275390625, 0],[99.66976165771484, 349.5285949707031, 0],[98.3321304321289, 349.5026550292969, 0],[97.11417388916016, 349.5609436035156, 0],[95.98194885253906, 349.59332275390625, 0],[94.8497314453125, 349.62567138671875, 0],[93.97630310058594, 350.11090087890625, 0],[93.6528091430664, 350.82257080078125, 0],[93.6204605102539, 351.5342712402344, 0],[93.6851577758789, 352.1812438964844, 0],[93.7822036743164, 353.0870056152344, 0],[94.17039489746094, 353.8310546875, 0],[95.1085205078125, 354.2515869140625, 0],[96.3701400756836, 354.3486328125, 0],[97.69645690917969, 354.154541015625, 0],[98.82868194580078, 353.7987060546875, 0],[100.15499877929688, 353.507568359375, 0],[101.44896697998047, 353.2811279296875, 0],[102.93702697753906, 353.2164306640625, 0],[104.36038970947266, 353.3458251953125, 0],[105.78223419189453, 353.5716552734375, 0],[107.55879974365234, 354.1447448730469, 0],[108.70497131347656, 354.8897399902344, 0],[109.85975646972656, 355.9337463378906, 0],[110.4420394897461, 357.2276916503906, 0],[110.92727661132812, 358.48931884765625, 0],[111.25077056884766, 360.1391296386719, 0],[111.41252136230469, 361.7242431640625, 0],[111.28311920166016, 363.4710998535156, 0],[110.86257934570312, 364.73272705078125, 0],[110.2479476928711, 365.67083740234375, 0],[109.30982208251953, 366.2531433105469, 0],[108.08055114746094, 366.6089782714844, 0],[106.52779388427734, 366.6089782714844, 0],[104.65154266357422, 366.6736755371094, 0],[103.1958236694336, 366.4148864746094, 0],[102.06360626220703, 366.1884460449219, 0],[101.19754791259766, 365.9502868652344, 0],[99.83151245117188, 365.73553466796875, 0],[98.44673919677734, 365.6064453125, 0],[96.89940643310547, 365.7210693359375, 0],[95.810546875, 366.1795349121094, 0],[95.12284088134766, 367.0964660644531, 0],[94.623291015625, 367.9676513671875, 0],[94.6556396484375, 369.099853515625, 0],[95.20557403564453, 370.1673889160156, 0],[96.30545043945312, 371.0408020019531, 0],[97.92290496826172, 371.52606201171875, 0],[99.37862396240234, 371.78485107421875, 0],[100.93138122558594, 371.94659423828125, 0],[102.80763244628906, 372.07598876953125, 0],[104.36039733886719, 372.17303466796875, 0],[106.13959503173828, 372.27008056640625, 0],[107.7894058227539, 372.69061279296875, 0],[108.986328125, 373.2082214355469, 0],[110.05384826660156, 374.1786804199219, 0],[110.76553344726562, 375.4403076171875, 0],[111.28311920166016, 376.9607238769531, 0],[111.50956726074219, 378.48114013671875, 0],[111.47721099853516, 380.1309509277344, 0],[111.50956726074219, 381.9425048828125, 0],[111.21842193603516, 383.3658447265625, 0],[110.79788208007812, 384.4333801269531, 0],[109.98998260498047, 385.2068176269531, 0],[108.90616607666016, 385.6321105957031, 0],[107.80863189697266, 385.71441650390625, 0],[106.69917297363281, 385.6644287109375, 0],[105.51752471923828, 385.28912353515625, 0],[104.36510467529297, 384.630615234375, 0],[103.10294342041016, 383.7937316894531, 0],[102.0602798461914, 383.02545166015625, 0],[101.11365509033203, 382.1474609375, 0],[99.93379974365234, 381.516357421875, 0],[98.80882263183594, 380.8852844238281, 0],[97.5466537475586, 380.61090087890625, 0],[96.60002899169922, 380.9950256347656, 0],[95.9415054321289, 381.7633056640625, 0],[95.63862609863281, 382.5124816894531, 0],[95.29476928710938, 383.77325439453125, 0],[95.52400207519531, 385.09136962890625, 0],[95.75324249267578, 386.06561279296875, 0],[96.31192779541016, 387.00408935546875, 0],[97.09391784667969, 388.0055847167969, 0],[97.93096160888672, 388.7017822265625, 0],[98.671630859375, 389.281494140625, 0],[99.71428680419922, 389.8165283203125, 0],[101.08293914794922, 390.3637390136719, 0],[102.33466339111328, 390.8180236816406, 0],[103.54195404052734, 391.0924072265625, 0],[104.69436645507812, 391.3805236816406, 0],[105.79190826416016, 391.545166015625, 0],[107.10033416748047, 391.6818542480469, 0],[108.13188934326172, 391.79644775390625, 0],[109.7430419921875, 392.0802307128906, 0],[111.11495971679688, 392.7936096191406, 0],[112.00074005126953, 393.94708251953125, 0],[112.38825225830078, 395.0665588378906, 0],[112.60195922851562, 396.7250061035156, 0],[112.21602630615234, 397.82220458984375, 0],[111.39847564697266, 398.7308044433594, 0],[110.25230407714844, 399.18927001953125, 0],[109.10613250732422, 399.5331115722656, 0],[107.55880737304688, 399.5904235839844, 0],[106.41263580322266, 399.5904235839844, 0],[104.7241439819336, 399.5875244140625, 0],[103.08873748779297, 399.7623291015625, 0],[101.54141235351562, 400.2207946777344, 0],[100.62447357177734, 401.0231018066406, 0],[99.9448471069336, 402.1709289550781, 0],[99.9448471069336, 403.67791748046875, 0],[100.80598449707031, 404.668212890625, 0],[102.22685241699219, 405.4001770019531, 0],[103.26021575927734, 405.8738098144531, 0],[104.9394302368164, 406.30438232421875, 0],[106.69918060302734, 406.86859130859375, 0],[108.59925842285156, 407.5530090332031, 0],[110.36692810058594, 408.3013000488281, 0],[112.08684539794922, 409.1891784667969, 0],[113.80912017822266, 410.7822570800781, 0],[114.55045318603516, 412.08367919921875, 0],[114.97164916992188, 413.4087219238281, 0],[115.2730484008789, 414.61431884765625, 0],[115.10082244873047, 415.9490966796875, 0],[114.45497131347656, 417.1116027832031, 0],[113.12020874023438, 418.1019287109375, 0],[111.3548812866211, 418.4033203125, 0],[109.63261413574219, 418.2310791015625, 0],[108.0745849609375, 417.81451416015625, 0],[106.6418685913086, 417.1268310546875, 0],[105.28387451171875, 416.4226989746094, 0],[103.71913146972656, 415.8087158203125, 0],[102.18379211425781, 415.2601623535156, 0],[100.2462387084961, 414.9587707519531, 0],[99.12676239013672, 415.38934326171875, 0],[98.78230285644531, 415.86297607421875, 0],[98.73925018310547, 416.853271484375, 0],[99.07714080810547, 417.81451416015625, 0],[100.20317840576172, 418.9200134277344, 0],[101.62405395507812, 419.953369140625, 0],[103.69078063964844, 420.8575439453125, 0],[105.67138671875, 421.41729736328125, 0],[107.60894012451172, 421.9770202636719, 0],[109.5034408569336, 422.708984375, 0],[111.22655487060547, 423.6600036621094, 0],[112.37272644042969, 424.3476867675781, 0],[113.40428161621094, 425.09271240234375, 0],[114.43583679199219, 426.0096435546875, 0],[115.48833465576172, 426.97161865234375, 0],[116.38432312011719, 428.2446594238281, 0],[117.29671478271484, 429.7272644042969, 0],[117.8995132446289, 431.1911926269531, 0],[118.20091247558594, 432.4828796386719, 0],[118.37313842773438, 434.4635009765625, 0],[118.37313842773438, 435.7552185058594, 0],[117.98562622070312, 437.3052673339844, 0],[117.12933349609375, 438.21636962890625, 0],[115.7539291381836, 438.6748352050781, 0],[113.8521728515625, 438.2955627441406, 0],[112.08684539794922, 437.26220703125, 0],[110.2784652709961, 436.185791015625, 0],[108.9437026977539, 435.02325439453125, 0],[107.90265655517578, 434.3766784667969, 0],[106.70475006103516, 434.1190490722656, 0],[105.62833404541016, 434.4635009765625, 0],[105.19776153564453, 435.5829772949219, 0],[105.58527374267578, 436.70245361328125, 0],[107.35060119628906, 438.0372314453125, 0],[109.11592864990234, 439.3719787597656, 0],[111.01042938232422, 440.6206359863281, 0],[112.54464721679688, 441.6548767089844, 0],[114.20659637451172, 442.6864318847656, 0],[116.21239471435547, 443.9472351074219, 0],[117.58779907226562, 444.978759765625, 0],[118.6314697265625, 446.1319274902344, 0],[119.2773208618164, 447.76806640625, 0],[119.57872009277344, 449.5764465332031, 0],[119.57872009277344, 450.78204345703125, 0],[119.23426818847656, 452.80572509765625, 0],[118.5047378540039, 453.7469787597656, 0],[117.33976745605469, 454.18353271484375, 0],[115.83277893066406, 454.0543518066406, 0],[114.54107666015625, 453.02099609375, 0],[113.12020874023438, 451.7723388671875, 0],[111.6562728881836, 450.7389831542969, 0],[110.23540496826172, 449.8348083496094, 0],[109.07286834716797, 449.1889343261719, 0],[107.78116607666016, 448.3708801269531, 0],[106.66168975830078, 447.8111267089844, 0],[105.61031341552734, 447.5003662109375, 0],[104.121337890625, 447.3374938964844, 0],[103.26020812988281, 447.68194580078125, 0],[102.65740966796875, 448.5430908203125, 0],[102.3990707397461, 449.5764465332031, 0],[102.44212341308594, 450.5667724609375, 0],[103.044921875, 451.55706787109375, 0],[104.29356384277344, 452.2890319824219, 0],[106.01583862304688, 453.02099609375, 0],[108.01727294921875, 453.8042907714844, 0],[110.53679656982422, 454.8293762207031, 0],[112.17295837402344, 455.86273193359375, 0],[113.55077362060547, 456.8099670410156, 0],[115.14387512207031, 458.01556396484375, 0],[116.04806518554688, 459.0489196777344, 0],[116.65086364746094, 460.2975769042969, 0],[116.82308959960938, 461.6753845214844, 0],[116.52169036865234, 463.2254333496094, 0],[115.8327865600586, 464.6893615722656, 0],[114.9285888671875, 465.9380187988281, 0],[113.63688659667969, 467.10052490234375, 0],[112.08684539794922, 468.1769714355469, 0],[110.36457061767578, 468.82281494140625, 0],[108.5992431640625, 468.95196533203125, 0],[107.32957458496094, 468.70452880859375, 0],[105.84361267089844, 468.1339111328125, 0],[104.72413635253906, 467.5310974121094, 0],[103.6045150756836, 466.69873046875, 0],[102.35601043701172, 465.72271728515625, 0],[101.10736846923828, 464.3018493652344, 0],[100.11705780029297, 463.3545837402344, 0],[99.19175720214844, 462.9736633300781, 0],[98.16020202636719, 462.74444580078125, 0],[97.47249603271484, 462.74444580078125, 0],[96.61714935302734, 462.7431335449219, 0]]); //curve
      var Su0DX =createNubs(point_Ext_InnerDX);
      //var curve0DX = MAP(Su0DX)(domain1);
      //DRAW(curve0DX);

     //Bottom curve
      var point_BottomDX = reverseR([[88.66173553466797, 328.84747314453125+6,-16],[90.99598693847656, 353.7856140136719, -28],[89.74175262451172, 381.37872314453125, -36],[90.5779037475586, 406.0452880859375, -44],[98.10330200195312, 430.2937927246094, -36],[101.44792175292969, 444.926513671875, -28],[96.61714935302734+1, 462.7431335449219-0.5,-16]]); //retta fondo
      var Su1DX =createNubs(point_BottomDX);
      //var curve1SX = MAP(Su1SX)(domain1);
      //DRAW(curve1SX);

     var point_Su1DXreverse = reverseR(point_BottomDX);
      var Su1DXrev =createNubs(point_Su1DXreverse); //useful to generate the bottom closure
      //var curve1DX = MAP(Su1DX)(domain1);
      //DRAW(curve1DX);

    //Laterals curves
      var point_LateralDX1 = [[96.61714935302734, 462.7431335449219,0],[106.96328735351562, 462.3104248046875, -10],[96.61714935302734+1, 462.7431335449219-0.5,-16]];//retta profondita
      var Sv0DX = BEZIER(S1)(point_LateralDX1);
      //var curve2DX = MAP(BEZIER(S0)(point_LateralDX1))(domain1);
      //DRAW(curve2DX);

      var point_LateralDX2 = [[88.66173553466797, 328.84747314453125,0],[98.33412170410156, 329.3287048339844,-10],[88.66173553466797, 328.84747314453125+6,-16]]; // retta rofondità
      var Sv1DX = BEZIER(S1)(point_LateralDX2);
      //var curve3DX = MAP( BEZIER(S0)(point_LateralDX2))(domain1);
      //DRAW(curve3DX);

    //Volume generation
      var outSX = MAP(COONS_PATCH([Su0DX,Su1DX,Sv0DX,Sv1DX]))(domain2);
    //DRAW(outSX);

  //Bottom closure
    var bottom = BEZIER(S1)([Su1DXrev,Su1SX]);
    var bottomMap = (MAP(bottom)(domain2));

  //Lateral closures

    var lateralClosure1=BEZIER(S2)([Sv1SX,[88.66173553466797, 328.84747314453125+6,-15],Sv0DX]);
    var lateralClosure2=BEZIER(S2)([Sv1DX,[96.61714935302734+1, 462.7431335449219-0.5,-16],Sv0SX]);
    var lc1Map = (MAP(lateralClosure1)(domain3));
   var lc2Map = (MAP(lateralClosure2)(domain3));
   DRAW (COLOR (mattCoralRed)(lc1Map));
   DRAW (COLOR (mattCoralRed)(lc2Map));
 
  //Volume assembly (DX+SX+bottom+lateral)
    var volume_inner = COLOR (mattCoralRed)(STRUCT ([bottomMap,outSX,outDX]));
    DRAW (volume_inner);

//Boundary of inner membrane with cristae

  //Internal
   var pointInt_InnerDX= reverseR([[88.75521087646484, 333.3511047363281, 0],[90.28076171875, 334.1138610839844, 0 ],[91.19609832763672, 334.571533203125, 0 ],[92.34026336669922, 335.1817626953125, 0 ],[93.40814971923828, 335.7156982421875, 0 ],[94.3997573852539, 336.4784851074219, 0 ],[95.23881530761719, 337.08868408203125, 0 ],[96.23042297363281, 337.8514709472656, 0 ],[97.22203826904297, 338.6142578125, 0 ],[98.28992462158203, 339.45330810546875, 0 ],[99.43408966064453, 340.4449157714844, 0 ],[100.57825469970703, 341.4365234375, 0 ],[101.56986236572266, 342.27557373046875, 0 ],[102.6466293334961, 343.15423583984375, 0 ],[103.42436981201172, 343.9805908203125, 0 ],[103.66741180419922, 344.78265380859375, 0 ],[103.67568969726562, 345.3428955078125, 0 ],[103.4973373413086, 345.809326171875, 0 ],[103.33271026611328, 346.11114501953125, 0 ],[103.0720443725586, 346.2895202636719, 0 ],[102.79766082763672, 346.3443908691406, 0 ],[102.1802978515625, 346.38555908203125, 0 ],[101.12513732910156, 346.4075927734375, 0 ],[99.60472106933594, 346.4722900390625, 0 ],[98.24605560302734, 346.43994140625, 0 ],[96.98443603515625, 346.43994140625, 0 ],[95.46402740478516, 346.4722900390625, 0 ],[93.74951934814453, 346.6016845703125, 0 ],[92.58494567871094, 347.3133850097656, 0 ],[91.51742553710938, 348.80145263671875, 0 ],[91.22628021240234, 350.3218688964844, 0 ],[91.19056701660156, 351.4920959472656, 0 ],[91.28660583496094, 352.31524658203125, 0 ],[91.39635467529297, 353.35791015625, 0 ],[91.98628234863281, 354.5377502441406, 0 ],[92.9395980834961, 355.63128662109375, 0 ],[94.40352630615234, 356.3201904296875, 0 ],[96.0827407836914, 356.40631103515625, 0 ],[97.76195526123047, 356.3632507324219, 0 ],[99.22588348388672, 356.2771301269531, 0 ],[100.51758575439453, 356.23406982421875, 0 ],[101.68012237548828, 356.1910095214844, 0 ],[102.71348571777344, 356.3201904296875, 0 ],[103.61478424072266, 356.6282043457031, 0 ],[104.61126708984375, 357.16290283203125, 0 ],[105.36470031738281, 357.62469482421875, 0 ],[106.26396942138672, 358.32952880859375, 0 ],[106.75005340576172, 359.2530822753906, 0 ],[107.14007568359375, 360.2435302734375, 0 ],[107.32267761230469, 361.3026123046875, 0 ],[107.19485473632812, 362.0695495605469, 0 ],[106.9757308959961, 362.61737060546875, 0 ],[106.61052703857422, 362.8912658691406, 0 ],[106.30010223388672, 363.037353515625, 0 ],[106.02619934082031, 363.1103820800781, 0 ],[105.60620880126953, 363.128662109375, 0 ],[104.8027572631836, 363.14691162109375, 0 ],[103.54280090332031, 363.1103820800781, 0 ],[102.62979125976562, 363.037353515625, 0 ],[101.7532958984375, 363.01910400390625, 0 ],[100.34725189208984, 362.946044921875, 0 ],[98.6125259399414, 362.8912658691406, 0 ],[98.6125259399414, 362.9095153808594, 0 ],[96.349365234375, 362.9974060058594, 0 ],[94.52653503417969, 363.5321044921875, 0 ],[92.89813995361328, 364.6501159667969, 0 ],[91.51278686523438, 366.71600341796875, 0 ],[91.26973724365234, 369.31658935546875, 0 ],[92.02317810058594, 371.358154296875, 0 ],[93.7730941772461, 373.25390625, 0 ],[96.5438003540039, 374.37188720703125, 0 ],[98.9256362915039, 374.61492919921875, 0 ],[100.74846649169922, 374.7364501953125, 0 ],[102.47408294677734, 374.80938720703125, 0 ],[103.90804290771484, 375.05242919921875, 0 ],[105.31769561767578, 375.2468566894531, 0 ],[106.6058349609375, 375.6600341796875, 0 ],[106.92179107666016, 375.95166015625, 0 ],[107.18914031982422, 376.31622314453125, 0 ],[107.31066131591797, 376.6321716308594, 0 ],[107.62661743164062, 377.409912109375, 0 ],[107.94258117675781, 378.5036315917969, 0 ],[108.30714416503906, 379.9618835449219, 0 ],[108.33145141601562, 381.1528015136719, 0 ],[108.18562316894531, 382.173583984375, 0 ],[107.96688079833984, 382.8055114746094, 0 ],[107.65092468261719, 383.0728454589844, 0 ],[107.26205444335938, 383.0485534667969, 0 ],[106.8974838256836, 383.02423095703125, 0 ],[106.43569946289062, 382.8055114746094, 0 ],[105.75518035888672, 382.4409484863281, 0 ],[104.95313262939453, 381.8576354980469, 0 ],[103.64069366455078, 380.88543701171875, 0 ],[102.37686157226562, 379.91326904296875, 0 ],[100.99150848388672, 378.96539306640625, 0 ],[99.53324890136719, 378.3091735839844, 0 ],[97.30909729003906, 377.9130859375, 0 ],[95.56224060058594, 378.236572265625, 0 ],[93.97712707519531, 379.142333984375, 0 ],[92.90960693359375, 380.8568420410156, 0 ],[92.35967254638672, 382.9919128417969, 0 ],[92.74786376953125, 385.25634765625, 0 ],[93.00665283203125, 386.4856262207031, 0 ],[93.45954132080078, 387.5531311035156, 0 ],[94.39766693115234, 388.87945556640625, 0 ],[94.39766693115234, 388.91180419921875, 0 ],[95.56224060058594, 389.9469909667969, 0 ],[96.27391815185547, 390.5292663574219, 0 ],[97.17970275878906, 391.0468444824219, 0 ],[98.50601196289062, 391.7261962890625, 0 ],[100.15582275390625, 392.21142578125, 0 ],[101.70858001708984, 392.6319580078125, 0 ],[103.09960174560547, 392.9554748535156, 0 ],[104.23181915283203, 393.3113098144531, 0 ],[105.39639282226562, 393.5700988769531, 0 ],[106.62566375732422, 393.7641906738281, 0 ],[107.69318389892578, 393.9582824707031, 0 ],[108.76070404052734, 394.1847229003906, 0 ],[109.01950073242188, 394.4435119628906, 0 ],[109.11654663085938, 394.83172607421875, 0 ],[109.11654663085938, 395.31695556640625, 0 ],[109.05184936523438, 395.89923095703125, 0 ],[108.92245483398438, 396.12567138671875, 0 ],[108.66365814208984, 396.25506591796875, 0 ],[108.46956634521484, 396.35211181640625, 0 ],[108.04902648925781, 396.4168395996094, 0 ],[107.43438720703125, 396.4168395996094, 0 ],[106.33451843261719, 396.4491882324219, 0 ],[104.71705627441406, 396.5138854980469, 0 ],[102.74375915527344, 396.9344177246094, 0 ],[100.80280303955078, 397.4843444824219, 0 ],[98.1501693725586, 398.843017578125, 0 ],[96.6297607421875, 400.6869201660156, 0 ],[96.04747772216797, 402.53082275390625, 0 ],[96.338623046875, 403.9541931152344, 0 ],[97.7943344116211, 405.60400390625, 0 ],[100.15582275390625, 406.7362365722656, 0 ],[101.96737670898438, 407.6096496582031, 0 ],[104.13477325439453, 408.0301818847656, 0 ],[106.04338073730469, 408.83892822265625, 0 ],[107.49909210205078, 409.58294677734375, 0 ],[108.56661224365234, 410.1652526855469, 0 ],[109.79588317871094, 411.0386657714844, 0 ],[110.44286346435547, 411.6209411621094, 0 ],[110.7340087890625, 412.1385498046875, 0 ],[110.8310546875, 412.753173828125, 0 ],[110.7987060546875, 413.2060546875, 0 ],[110.44286346435547, 413.5619201660156, 0 ],[110.08702850341797, 413.5942687988281, 0 ],[109.86058044433594, 413.529541015625, 0 ],[109.5047378540039, 413.4324951171875, 0 ],[108.85775756835938, 413.2384033203125, 0 ],[108.11372375488281, 412.9796142578125, 0 ],[107.14324951171875, 412.882568359375, 0 ],[105.94632720947266, 412.6561279296875, 0 ],[104.13477325439453, 412.2032470703125, 0 ],[102.71141052246094, 411.8150634765625, 0 ],[100.12347412109375, 411.0386657714844, 0 ],[98.21487426757812, 411.1033630371094, 0 ],[96.14452362060547, 412.623779296875, 0 ],[95.65928649902344, 414.8235168457031, 0 ],[95.85338592529297, 416.92620849609375, 0 ],[96.5650634765625, 419.1259765625, 0 ],[98.02079010009766, 420.8404541015625, 0 ],[100.15583801269531, 422.0697326660156, 0 ],[102.42028045654297, 423.49310302734375, 0 ],[104.68472290039062, 424.20477294921875, 0 ],[107.17560577392578, 425.2723083496094, 0 ],[108.8901138305664, 426.1133728027344, 0 ],[110.41053009033203, 426.9544677734375, 0 ],[111.6397933959961, 427.6337890625, 0 ],[112.51322937011719, 428.3131103515625, 0 ],[113.58074951171875, 429.1865539550781, 0 ],[114.35713195800781, 430.0923156738281, 0 ],[115.03646087646484, 431.28924560546875, 0 ],[115.39230346679688, 432.2273864746094, 0 ],[115.45700073242188, 433.3272399902344, 0 ],[115.42465209960938, 433.9418640136719, 0 ],[115.00411224365234, 434.1036376953125, 0 ],[114.58357238769531, 434.006591796875, 0 ],[114.32478332519531, 433.9095153808594, 0 ],[113.90424346923828, 433.6830749511719, 0 ],[112.83671569824219, 433.4242858886719, 0 ],[110.86341857910156, 432.5508728027344, 0 ],[109.31065368652344, 431.96856689453125, 0 ],[107.62850189208984, 431.28924560546875, 0 ],[105.00821685791016, 430.93341064453125, 0 ],[103.0672607421875, 431.45098876953125, 0 ],[102.35558319091797, 433.0684509277344, 0 ],[102.48497772216797, 436.2710266113281, 0 ],[103.61720275878906, 437.82379150390625, 0 ],[105.10526275634766, 439.5382995605469, 0 ],[106.65802001953125, 440.7351989746094, 0 ],[108.40487670898438, 441.867431640625, 0 ],[109.989990234375, 443.161376953125, 0 ],[111.57510375976562, 444.2612609863281, 0 ],[113.09551239013672, 445.3934631347656, 0 ],[113.83954620361328, 446.04046630859375, 0 ],[114.61592864990234, 446.88153076171875, 0 ],[115.13351440429688, 447.5608825683594, 0 ],[115.32760620117188, 448.6283874511719, 0 ],[115.19821166992188, 449.0165710449219, 0 ],[115.03646850585938, 449.3724365234375, 0 ],[114.68062591552734, 449.40478515625, 0 ],[114.26008605957031, 449.1136169433594, 0 ],[113.90424346923828, 448.7901306152344, 0 ],[113.35430908203125, 448.3372497558594, 0 ],[112.41618347167969, 447.7873229980469, 0 ],[110.89576721191406, 446.84918212890625, 0 ],[109.24596405029297, 446.13751220703125, 0 ],[108.04904174804688, 445.5875549316406, 0 ],[106.75507354736328, 444.9082336425781, 0 ],[104.58767700195312, 443.9701232910156, 0 ],[102.22618865966797, 444.325927734375, 0 ],[100.86752319335938, 445.78167724609375, 0 ],[100.02644348144531, 447.43145751953125, 0 ],[99.76764678955078, 449.1783142089844, 0 ],[100.22053527832031, 450.7957763671875, 0 ],[101.3204116821289, 452.3161926269531, 0 ],[102.45262908935547, 453.38372802734375, 0 ],[104.39358520507812, 454.6777038574219, 0 ],[106.52862548828125, 455.9716491699219, 0 ],[108.98716735839844, 457.1038818359375, 0 ],[110.34583282470703, 457.783203125, 0 ],[111.54275512695312, 458.4625244140625, 0 ],[112.38383483886719, 459.2712707519531, 0 ],[112.67497253417969, 459.6918029785156, 0 ],[112.80437469482422, 460.2417297363281, 0 ],[112.77202606201172, 460.9210510253906, 0 ],[112.64262390136719, 461.76214599609375, 0 ],[112.35148620605469, 462.53851318359375, 0 ],[111.89859771728516, 463.2178649902344, 0 ],[111.4133529663086, 463.8324890136719, 0 ],[110.63697814941406, 464.1236267089844, 0 ],[109.92529296875, 464.1883239746094, 0 ],[109.05186462402344, 464.0265808105469, 0 ],[107.85494232177734, 463.7030944824219, 0 ],[106.72272491455078, 463.3149108886719, 0 ],[105.71990203857422, 462.66790771484375, 0 ],[104.97586822509766, 462.24737548828125, 0 ],[103.90834045410156, 461.43865966796875, 0 ],[102.58203125, 460.5005187988281, 0 ],[101.2880630493164, 459.4006652832031, 0 ],[100.05879211425781, 459.012451171875, 0 ],[98.66777801513672, 458.68896484375, 0 ],[97.50320434570312, 458.624267578125, 0 ],[96.60772705078125, 458.2706604003906, 0]]); 
   var c0 =createNubs(pointInt_InnerDX);
  
   var pointInt_InnerSX= reverseR([[96.60772705078125, 458.2706604003906, 0],[95.28962707519531, 458.2133483886719, 0 ],[93.5130615234375, 459.0729675292969, 0 ],[92.19496154785156, 460.2764587402344, 0 ],[90.8195571899414, 461.7664794921875, 0 ],[90.36109161376953, 462.6260986328125, 0 ],[89.73069763183594, 463.2565002441406, 0 ],[88.92837524414062, 463.42840576171875, 0 ],[87.83951568603516, 463.42840576171875, 0 ],[87.26642608642578, 463.1991882324219, 0 ],[86.8079605102539, 462.8553466796875, 0 ],[86.52141571044922, 462.3395690917969, 0 ],[86.52141571044922, 461.5372314453125, 0 ],[86.57872772216797, 460.792236328125, 0 ],[86.75064849853516, 459.9898986816406, 0 ],[86.92257690429688, 459.47412109375, 0 ],[87.26642608642578, 457.8121643066406, 0 ],[87.66758728027344, 456.5513916015625, 0 ],[88.18336486816406, 455.5771484375, 0 ],[88.8710708618164, 454.7748107910156, 0 ],[90.36109161376953, 453.628662109375, 0 ],[90.41839599609375, 453.628662109375, 0 ],[91.9084243774414, 452.0813293457031, 0 ],[93.22651672363281, 450.30474853515625, 0 ],[93.8569107055664, 448.35626220703125, 0 ],[94.02883911132812, 446.7516174316406, 0 ],[93.74229431152344, 444.45928955078125, 0 ],[93.28382873535156, 443.7142639160156, 0 ],[91.22071838378906, 442.568115234375, 0 ],[88.69913482666016, 442.28155517578125, 0 ],[86.06294250488281, 443.25579833984375, 0 ],[84.6302261352539, 444.5165710449219, 0 ],[83.59867095947266, 445.5481262207031, 0 ],[82.45249938964844, 446.5796813964844, 0 ],[81.5928726196289, 447.38201904296875, 0 ],[80.9051742553711, 447.9551086425781, 0 ],[80.6186294555664, 448.12701416015625, 0 ],[79.70169067382812, 448.2989501953125, 0 ],[78.8420639038086, 448.35626220703125, 0 ],[77.69589233398438, 448.2989501953125, 0 ],[77.06549835205078, 448.12701416015625, 0 ],[76.4924087524414, 447.5539245605469, 0 ],[75.86201477050781, 446.9235534667969, 0 ],[75.28893280029297, 446.29315185546875, 0 ],[74.60122680664062, 445.6054382324219, 0 ],[73.91352844238281, 444.8031311035156, 0 ],[73.34043884277344, 443.4850158691406, 0 ],[72.7673568725586, 442.109619140625, 0 ],[72.4808120727539, 440.4476623535156, 0 ],[72.53812408447266, 440.4476623535156, 0 ],[72.4808120727539, 439.7026672363281, 0 ],[72.65274047851562, 439.301513671875, 0 ],[72.93927764892578, 439.01495361328125, 0 ],[73.34043884277344, 438.90032958984375, 0 ],[73.97083282470703, 438.9576416015625, 0 ],[74.88777160644531, 438.9576416015625, 0 ],[76.60702514648438, 438.9576416015625, 0 ],[78.61283111572266, 438.90032958984375, 0 ],[78.67013549804688, 438.90032958984375, 0 ],[82.05134582519531, 438.3272705078125, 0 ],[84.17176055908203, 437.29571533203125, 0 ],[85.8910140991211, 435.2898864746094, 0 ],[86.75064849853516, 432.3098449707031, 0 ],[86.23487091064453, 429.6736755371094, 0 ],[86.29217529296875, 429.6736755371094, 0 ],[84.34368896484375, 427.6105651855469, 0 ],[81.13440704345703, 427.152099609375, 0 ],[77.7531967163086, 427.0374755859375, 0 ],[74.48661041259766, 427.2093811035156, 0 ],[71.56387329101562, 427.6105651855469, 0 ],[70.58963012695312, 427.4959411621094, 0 ],[70.13116455078125, 427.0374755859375, 0 ],[69.95923614501953, 426.5216979980469, 0 ],[69.95923614501953, 426.4643859863281, 0 ],[69.95923614501953, 425.77667236328125, 0 ],[70.13116455078125, 425.0889892578125, 0 ],[70.87617492675781, 424.5158996582031, 0 ],[71.90773010253906, 423.71356201171875, 0 ],[72.99659729003906, 422.7392883300781, 0 ],[74.37200164794922, 421.9942932128906, 0 ],[74.37200164794922, 422.0516052246094, 0 ],[75.86202239990234, 421.8223571777344, 0 ],[78.15436553955078, 421.0200500488281, 0 ],[81.07710266113281, 418.38385009765625, 0 ],[81.42095184326172, 415.2891845703125, 0 ],[79.300537109375, 412.0225830078125, 0 ],[75.69009399414062, 410.9337463378906, 0 ],[72.71005249023438, 411.10565185546875, 0 ],[70.07386016845703, 411.22027587890625, 0 ],[68.69844818115234, 411.04833984375, 0 ],[68.69844818115234, 410.9910583496094, 0 ],[68.18267059326172, 410.5898742675781, 0 ],[67.60958862304688, 409.04254150390625, 0 ],[67.55227661132812, 408.9852294921875, 0 ],[66.5207290649414, 405.8905944824219, 0 ],[65.66109466552734, 402.2801513671875, 0 ],[65.03070068359375, 398.95623779296875, 0 ],[65.03070068359375, 395.9761962890625, 0 ],[65.20262908935547, 392.7096252441406, 0 ],[65.48917388916016, 390.70379638671875, 0 ],[65.66109466552734, 389.95880126953125, 0 ],[65.94763946533203, 389.5003356933594, 0 ],[66.00495147705078, 389.5003356933594, 0 ],[66.57803344726562, 389.2710876464844, 0 ],[67.151123046875, 389.2710876464844, 0 ],[67.89613342285156, 389.84417724609375, 0 ],[69.27153778076172, 390.6465148925781, 0 ],[70.41770935058594, 391.7353515625, 0 ],[70.47501373291016, 391.7353515625, 0 ],[72.25157928466797, 393.053466796875, 0 ],[75.40355682373047, 394.6581115722656, 0 ],[78.03974914550781, 395.6323547363281, 0 ],[80.50401306152344, 395.6323547363281, 0 ],[81.53556823730469, 393.97039794921875, 0 ],[81.07710266113281, 391.2195739746094, 0 ],[80.21747589111328, 389.2137756347656, 0 ],[79.12860870361328, 386.978759765625, 0 ],[76.72164916992188, 384.3425598144531, 0 ],[74.71585083007812, 382.79522705078125, 0 ],[72.5954360961914, 381.13330078125, 0 ],[69.84461975097656, 379.75787353515625, 0 ],[68.1253662109375, 378.8409423828125, 0 ],[67.26573944091797, 378.2105407714844, 0 ],[66.92188262939453, 377.5801696777344, 0 ],[66.74996185302734, 377.007080078125, 0 ],[66.6926498413086, 376.09014892578125, 0 ],[66.97919464111328, 375.4597473144531, 0 ],[67.20842742919922, 375.1731872558594, 0 ],[67.95343780517578, 375.11590576171875, 0 ],[68.69844818115234, 375.11590576171875, 0 ],[70.0738525390625, 374.88665771484375, 0 ],[71.96504211425781, 374.7147216796875, 0 ],[75.28893280029297, 374.1416320800781, 0 ],[79.18592071533203, 371.2762145996094, 0 ],[80.10285186767578, 368.2388610839844, 0 ],[80.2747802734375, 365.946533203125, 0 ],[80.2747802734375, 365.88922119140625, 0 ],[80.10285186767578, 362.9664611816406, 0 ],[78.72744750976562, 360.2729797363281, 0 ],[76.54972076416016, 358.0952453613281, 0 ],[73.225830078125, 356.77716064453125, 0 ],[70.24578094482422, 357.1210021972656, 0 ],[69.4434585571289, 357.2356262207031, 0 ],[68.81306457519531, 357.2929382324219, 0 ],[67.7815170288086, 357.1210021972656, 0 ],[67.4949722290039, 356.77716064453125, 0 ],[67.32304382324219, 356.3759765625, 0 ],[67.32304382324219, 355.74560546875, 0 ],[67.32304382324219, 353.6824951171875, 0 ],[67.26573944091797, 351.96319580078125, 0 ],[67.26573944091797, 350.4731750488281, 0 ],[67.4949722290039, 349.38433837890625, 0 ],[68.01074981689453, 349.0977783203125, 0 ],[68.58383178710938, 348.92584228515625, 0 ],[69.21422576904297, 348.92584228515625, 0 ],[69.95923614501953, 349.38433837890625, 0 ],[70.36039733886719, 350.5877990722656, 0 ],[70.99079132080078, 351.7912902832031, 0 ],[74.08545684814453, 353.6824645996094, 0 ],[77.92513275146484, 354.14093017578125, 0 ],[81.3636474609375, 352.9947509765625, 0 ],[82.9682846069336, 349.15509033203125, 0 ],[83.02559661865234, 346.5188903808594, 0 ],[82.337890625, 344.28387451171875, 0 ],[81.65018463134766, 342.4499816894531, 0 ],[80.7332534790039, 340.7880554199219, 0 ],[79.70169830322266, 338.8968505859375, 0 ],[78.49821472167969, 337.2922058105469, 0 ],[77.98243713378906, 336.2606506347656, 0 ],[77.46665954589844, 334.71331787109375, 0 ],[77.46665954589844, 333.6817932128906, 0 ],[77.8678207397461, 332.70751953125, 0 ],[78.3262939453125, 332.2490539550781, 0 ],[78.72744750976562, 332.01983642578125, 0 ],[79.70169830322266, 331.79058837890625, 0 ],[81.47826385498047, 331.3321228027344, 0 ],[83.82791137695312, 331.1029052734375, 0 ],[85.7190933227539, 331.4467468261719, 0 ],[88.75521087646484, 333.3511047363281, 0 ]]);  
   var c1 =createNubs(pointInt_InnerSX);

  
  //Filling the boundary
    var b = BEZIER(S1)([c1,Su0SX]);
    var b1 = COLOR (mattIndianRed)(MAP(b)(domain2));
    DRAW (b1);

    var b = BEZIER(S1)([c0,Su0DX]);
    var b1 = COLOR (mattIndianRed)(MAP(b)(domain2));
    DRAW (b1);
  