/*Domain*/
var domain1 = INTERVALS(1)(40);
var domain2 = DOMAIN([[0,1],[0,1]])([40,40]);
var domain3 = DOMAIN([[0,1],[0,1],[0,1]])([15,15,1]);
var domainCircle = DOMAIN([[0,1],[0,2*PI]])([15,15]);


/*Color*/
var mattLightYellow = [255/255, 215/255, 0,1]; 
var mattGold = [218/255, 165/255, 32/255,1];
var mattBurgundy = [139/255, 0, 0, 1];
var mattCoralRed = [240/255,128/255, 128/255, 1];
var mattIndianRed = [205/255, 92/255, 92/255, 1];
var mattOrange = [255/255, 165/255, 0, 1];
var mattDarkOrange = [255/255, 140/255, 0, 1];
var mattAquaMarine = [127/255, 255/255, 212/255,1]; 
var mattLightSeaGreen = [32/255, 178/255, 170/255,1];
var mattDarkOrchid = [153/255, 50/255, 204/255, 1];
var mattDarkSeaGreen =[143/255, 188/255, 143/255, 0.8];
var mattLightSeaGreen = [32/255, 178/255, 170/255,1];
var mattSteelBlue = [70/255,130/255, 180/255,1];
var mattSkyBlue =[135/255, 206/255, 235/255,1];
var mattBurlywood = [255/255, 218/255, 185/255, 1];
var mattBisque = [255/255, 218/255, 185/255, 1];

/*Function*/

/* This function creates an array of knots used by the function nubs. The function takes as input an array of control points. It returns an array of knots. 

   INPUT - An array of points

   OUTPUT - An array of knots.

*/

function knots (point) {
  var k = 2; 
  var m =point.length;
  var n = (m + k + 1);
  var first = 1;
  var last = n - 3;

  var knots = [];

  for (var i = 0; i < 3; i++) {
     knots[i] = 0;
    };

  for (var i = 3; i < last; i++,first++) {
     knots[i] = first;

    };

  for (var i = last; i < n; i++) {
     knots[i] = first;
    };

  return knots;
};


/* This function creates a curve with the function Nubs. The function takes as input an array of control points. It returns to the curve. 

   INPUT - An array of points
   
   OUTPUT - A curve built with the function NUBS

*/

function createNubs (point) {
  
  var knots1 = knots(point);
  var c1 = NUBS(S0)(2)(knots1)(point);
  var curve1 = MAP(c1)(domain1);
  //DRAW(curve1);
  return c1;
}

/* This function creates a 1 grade Bezier curve. The function takes as input an array of curves. It returns to the Bezier curve. 

   INPUT - An array of curves

   OUTPUT - A 1 grade Bezier curve

*/
function createBezierS1(curves) {
  var b1 = BEZIER(S1)(curves);
  var b1Map = MAP(b1)(domain2);
  //DRAW(b1Map);
   return b1;
}
/* This function creates a 2 grade Bezier curve. The function takes as input an array of curves and a color. It returns to the drawing of curves. 

   INPUT - An array of curves and a color

   OUTPUT - A 2 grade Bezier curve

*/
function createBezierS2 (curves, color) {
  var b1 = BEZIER(S2)(curves);
  var b1Map = MAP(b1)(domain3);
  return DRAW(COLOR(color)(b1Map));
}
/* This function creates a 1 grade Bezier curve. It takes in input an initial point, a final point and an array of points. It returns the 1 grade Bezier curve. 
 
   INPUT - An initial point, a final point and an array of points.

   OUTPUT - A 1 grade Bezier curve. 

*/
function createCurveSurface(pointStart, pointFinal, points) {
  var nubs = [];
  nubs.push(pointStart);
  var j = 1;
  for(var i=0; i<points.length; i++) {
      nubs[j] = createNubs(points[i]);
      //DRAW(nubs[j]);
      j++;
  }
  nubs.push(pointFinal);

  return createBezierS1(nubs);
    }

/* This function takes an array as input and reverses it. It returns the reversed array. 
   
   INPUT - An array 

   OUTPUT - A reversed array 

*/
function reverseR(array) {
  var arrayReturn = [];
  var j = 0;
  for(var i = array.length-1; i>=0; i--) {
        
        arrayReturn[j] = array[i];
        j++;
  }
  return arrayReturn;
}

/* This function creates a cylindrical surface. It takes as input two arrays one for the upper base one for the lower base of cylender  
 
   INPUT - Two arrays of control points.

   OUTPUT - A 1 grade Bezier curve. 

*/
function generateMicrotubule (pointSup,pointInf) {
  var c0 =createNubs(pointSup);
  var c1 =createNubs(pointInf);
 
  var b = BEZIER(S1)([c0,c1]);
  var b1 = MAP(b)(domain2);
  //DRAW (b1);
  return b;
};

/* This function translates an array of points. It takes in input an array of control points and three breadths for each coordinate of the Cartesian Plane. It returns to the modified array. 
 
   INPUT - An array of control points and three breadths.

   OUTPUT - A modified array. 

*/
function controlsPointTranslation(controls, dx, dy, dz) {
  var arr = [];
    for(var i=0; i<controls.length; i++) {
    for(var j=0; j<3; j++) {
        var arr2 = [];
        arr2[j] = controls[i][j]+dx;
        arr2[j+1] = controls[i][j+1]+dy;
        arr2[j+2] = controls[i][j+2]+dz;
        j+=3;
        arr.push(arr2);
       
    }
     
  }
  return arr;
}

/* This function modifies an array of points. It takes in input an array of control points. It returns to the modified array. 
 
   INPUT - An array of control points.

   OUTPUT - A modified array. 

*/

function controlsPointTransformation(controls) {
  var arr = [];
    for(var i=0; i<controls.length; i++) {
    for(var j=0; j<3; j++) {
        var arr2 = [];
        arr2[j] = controls[i][j+2];
        arr2[j+1] = controls[i][j];
        arr2[j+2] = (-1)*controls[i][j+1];
        j+=3;
        arr.push(arr2);
       
    }
     
  }
  return arr;
}


/* This function creates a 1 grade Bezier curve. It takes in input a final point and an array of points. It returns the 1 grade Bezier curve. 
 
   INPUT - A final point and an array of points.

   OUTPUT - A 1 grade Bezier curve. 

*/
  function createCurveSurface2(pointFinal, points) {
  var nubs = [];
 
  var j = 0;
  for(var i=0; i<points.length; i++) {
      nubs[j] = createNubs(points[i]);
      DRAW(nubs[j]);
      j++;
  }
  nubs.push(pointFinal);
  return createBezierS1(nubs);
    }
    
/***********************************************************************BIG MITHOCONDRION*************************************************************************/

//Outer membrane volume ext
  //Control point
  var cp1 = [[78.42952728271484-9, 319.5246887207031, 0 ],[85.37791442871094-9, 319.78509521484375, -10 ],[94.61820983886719+5, 319.78509521484375, 0 ],[101.09173583984375+5, 320.6038513183594, 0 ]];
  var cp2 = [[70.4506607055664-9, 324.9661865234375, 0 ],[83.0360336303711-9, 325.6783142089844, -10 ],[95.24503326416016+5, 326.1571044921875, -10 ],[108.84198760986328+5, 327.59832763671875, 0 ]];
  var cp3 = [[59.70538330078125-9, 337.8841247558594, 0 ],[82.77519989013672-9, 337.3196716308594, -30 ],[96.58267974853516+5, 337.0151062011719, -30 ],[114.5835952758789+5, 336.41815185546875, 0 ]];
  var cp4 = [[54.21564865112305-9, 353.04376220703125, 0 ],[73.07366180419922-9, 352.80072021484375, -46 ],[102.5321273803711+5, 352.93585205078125, -46 ],[119.51473999023438+5, 353.0233459472656, 0 ]];
  var cp5 = [[52.94705581665039-9, 367.6966857910156, 0 ],[72.40585327148438-9, 367.2912902832031, -55 ],[102.26971435546875+5, 367.5615539550781, -55 ],[119.83668518066406+5, 367.9669494628906, 0 ]];
  var cp6 = [[53.209163665771484-9, 381.70257568359375, 0 ],[73.28105926513672-9, 381.5002746582031, -60 ],[102.77790069580078, 381.14056396484375, -60 ],[119.5047607421875, 381.8599853515625, 0 ]];
  var cp7 = [[52.59729766845703-9, 395.4254455566406, 0 ],[73.82296752929688-9, 395.231201171875, -59 ],[102.3516616821289, 395.231201171875, -59 ],[119.00186157226562, 395.94189453125, 0 ]];
  var cp8 = [[53.82242965698242-9, 409.6478576660156, 0 ],[73.21382141113281-9, 409.6478576660156, -60 ],[102.45319366455078, 409.1402282714844, -60 ],[119.91559600830078, 408.3280029296875, 0 ]];
  var cp9 = [[56.76667785644531-9, 423.7598876953125, 0 ],[74.03883361816406-9, 423.8822021484375, -55 ],[103.6324234008789+5, 423.20654296875, -55 ],[124.26261138916016+5, 422.7600402832031, 0 ]];
  var cp10 = [[60.256771087646484-9, 437.7486267089844, 0 ],[78.71070861816406-9, 437.9825439453125, -46 ],[103.78752899169922+5, 438.18560791015625, -46 ],[127.0368881225586+5, 438.49017333984375, 0 ]];
  var cp11 = [[67.03526306152344-9, 452.3992004394531, 0 ],[81.95952606201172-9, 452.29766845703125, -30 ],[112.01110076904297+5, 451.9930725097656, -30 ],[127.13841247558594+5, 451.28240966796875, 0 ]];
  var cp12 = [[73.93899536132812-9, 464.8868408203125, 0 ],[87.03579711914062-9, 466.0036315917969, -15 ],[110.38668060302734+5, 466.5112609863281, -15 ],[122.67127990722656+5, 466.5112609863281, 0 ]];
  var cp13 = [[87.44190216064453-9, 476.663818359375, 0 ],[95.97004699707031-9, 476.0546569824219, 0 ],[105.61498260498047+5, 475.2424621582031, 0 ],[116.47821807861328+5, 474.12567138671875, 0 ]];


  var volumeOut = createCurveSurface([88.50161743164062,318.9059753417969,0],[101.99493408203125,477.54669189453125,0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13]);
  DRAW(COLOR(mattBurgundy)(MAP(volumeOut)(domain2)));
 
//Outer membrane volume int
  //Control point
  var cp1 =  [[81.15792083740234-9, 322.9072265625, 0 ],[86.31511688232422-9, 322.76678466796875, 0 ],[89.73242950439453+5, 322.76678466796875, 0 ],[96.1335678100586+5, 322.9072265625, 0 ]];
  var cp2 =  [[69.0499496459961-9, 330.8730163574219, 0 ],[83.4823989868164-9, 330.447998046875, -9 ],[92.10050964355469+5, 330.447998046875, -9 ],[105.05523681640625+5, 330.55438232421875, 0 ]];
  var cp3 =  [[63.13407516479492-9, 341.22064208984375, 0 ],[78.6945571899414-9, 340.7418518066406, -28 ],[96.88835144042969+5, 340.5024719238281, -28 ],[111.49127197265625+5, 340.5024719238281, 0 ]];
  var cp4 =  [[58.825016021728516-9, 351.0357360839844, 0 ],[76.3006362915039-9, 350.79632568359375, -44 ],[99.76106262207031+5, 350.79632568359375, -44 ],[113.97689819335938+5, 350.3094787597656, 0 ]];
  var cp5 =  [[57.38866424560547-9, 364.4416809082031, 0 ],[73.9067153930664-9, 363.962890625, -53 ],[101.43680572509766+5, 364.4416809082031, -53 ],[115.32154083251953+5, 363.7235107421875, 0 ]];
  var cp6 =  [[56.941978454589844-9, 379.942138671875, 0 ],[73.42793273925781-9, 380.0021667480469, -58 ],[102.15497589111328, 380.48095703125, -58 ],[115.32154083251953, 380.959716796875, 0 ]];
  var cp7 =  [[57.89787292480469-9, 395.2364196777344, 0 ],[76.3006362915039-9, 394.844482421875, -53 ],[103.5913314819336, 394.6050720214844, -53 ],[115.57005310058594, 393.32464599609375, 0 ]];
  var cp8 =  [[59.49102783203125-9, 411.16796875, 0 ],[78.92750549316406-9, 411.16796875, -58 ],[101.91558837890625, 411.84130859375, -58 ],[116.75789642333984, 411.84130859375, 0 ]];
  var cp9 =  [[63.63322830200195-9, 428.6926574707031, 0 ],[84.91875457763672-9, 428.5987548828125, -53 ],[106.46403503417969+5, 428.3593444824219, -53 ],[121.06695556640625+5, 428.5987548828125, 0 ]];
  var cp10 =  [[70.32447814941406-9, 443.34967041015625, 0 ],[91.99137115478516-9, 443.6683044433594, -44 ],[108.85795593261719+5, 442.4834899902344, -44 ],[123.21719360351562+5, 442.7124328613281, 0 ]];
  var cp11 =  [[73.82941436767578-9, 455.1390380859375, 0 ],[93.536865234375-9, 455.6500549316406, -28 ],[106.94281768798828+5, 455.8894348144531, -28 ],[122.26390838623047+5, 455.8894348144531, 0 ]];
  var cp12 =  [[81.0884780883789-9, 465.2257385253906, 0 ],[97.08946228027344-9, 465.6538391113281, -12 ],[105.0276870727539+5, 465.70452880859375, -12 ],[119.71224975585938+5, 464.69793701171875, 0 ]];
  var cp13 =  [[89.94598388671875-9, 473.6044616699219, 0 ],[98.8034896850586-9, 473.8438415527344+3, 0 ],[104.78829193115234+3, 474.083251953125+5, 0 ],[109.81552886962890, 473.6044616699219+5, 0 ]];
  
  var volumeIn = createCurveSurface([88.4175796508789, 321.68878173828125, 0],[101.98870086669922, 474.3639221191406, 0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10,cp11,cp12,cp13]);
  //DRAW(volumeIn);

  var lisosome3D = MAP(BEZIER(S2)([volumeIn,volumeOut]))(domain3);
  DRAW(COLOR(mattBurgundy)(lisosome3D));


//Inner membrane volume 

  //Inner membrane volume SX

    //Upper curve
      var point_Ext_InnerSX = [[88.66173553466797, 328.84747314453125, 0],[86.53084564208984, 328.41192626953125, 0],[84.29613494873047, 328.2383117675781, 0],[81.8595199584961, 328.13677978515625, 0],[79.52442932128906, 328.2383117675781, 0],[76.98628997802734, 328.6444091796875, 0],[75.4634017944336, 329.65966796875, 0],[74.0375747680664, 330.9335021972656, 0],[73.33136749267578, 332.7054443359375, 0],[73.53441619873047, 334.53289794921875, 0],[74.04204559326172, 336.56341552734375, 0],[75.36187744140625, 338.0863037109375, 0],[76.98628997802734, 339.60919189453125, 0],[78.10307312011719, 341.4366455078125, 0],[78.71222686767578, 343.0610656738281, 0],[79.2198486328125, 344.7869873046875, 0],[79.52442932128906, 346.7159729003906, 0],[79.52442932128906, 348.64495849609375, 0],[78.91527557373047, 350.67547607421875, 0],[76.98628997802734, 351.38616943359375, 0],[74.95577239990234, 351.38616943359375, 0],[73.63594055175781, 350.472412109375, 0],[72.41763305664062, 348.9495544433594, 0],[71.40238189697266, 347.1220703125, 0],[70.69170379638672, 345.59918212890625, 0],[69.27033996582031, 344.5839538574219, 0],[67.1383056640625, 344.482421875, 0],[65.41236877441406, 345.1930847167969, 0],[64.60016632080078, 346.7159729003906, 0],[63.99100875854492, 349.152587890625, 0],[63.4927978515625, 351.62188720703125, 0],[63.37818145751953, 353.9715270996094, 0],[63.37818145751953, 356.60772705078125, 0],[63.836647033691406, 359.1293029785156, 0],[64.9255142211914, 360.791259765625, 0],[66.123046875, 361.6402587890625, 0],[67.7474594116211, 361.74176025390625, 0],[69.51019287109375, 361.3070373535156, 0],[71.11483764648438, 360.4474182128906, 0],[72.77678680419922, 359.87432861328125, 0],[74.44815063476562, 360.3204040527344, 0],[75.56492614746094, 361.3356628417969, 0],[76.58018493652344, 363.2646484375, 0],[76.58018493652344, 365.1936340332031, 0],[75.97103118896484, 367.2241516113281, 0],[75.05730438232422, 368.9501037597656, 0],[73.83899688720703, 370.7775573730469, 0],[71.40238189697266, 371.6912841796875, 0],[69.16881561279297, 371.7928161621094, 0],[66.75938415527344, 371.3933410644531, 0],[64.69627380371094, 371.4506530761719, 0],[63.091636657714844, 372.4248962402344, 0],[62.00277328491211, 373.9149169921875, 0],[61.372379302978516, 375.6341857910156, 0],[61.6589241027832, 377.5253601074219, 0],[62.518558502197266, 378.9580383300781, 0],[64.00858306884766, 380.1615295410156, 0],[65.78514862060547, 381.30767822265625, 0],[67.90556335449219, 382.1673278808594, 0],[70.25521850585938, 383.6573486328125, 0],[72.31832122802734, 385.2046813964844, 0],[74.38143157958984, 386.52276611328125, 0],[76.32992553710938, 388.47125244140625, 0],[77.41878509521484, 390.0185852050781, 0],[77.41878509521484, 391.1074523925781, 0],[76.7310791015625, 391.56591796875, 0],[75.58491516113281, 391.50860595703125, 0],[73.92296600341797, 390.8209228515625, 0],[72.03178405761719, 389.44549560546875, 0],[70.08329010009766, 387.8981628417969, 0],[68.30672454833984, 386.52276611328125, 0],[66.35823059082031, 385.3765869140625, 0],[65.0401382446289, 385.3765869140625, 0],[63.550113677978516, 386.1216125488281, 0],[62.80509948730469, 387.3251037597656, 0],[62.34663391113281, 389.44549560546875, 0],[61.945472717285156, 392.1963195800781, 0],[61.71623992919922, 395.4629211425781, 0],[61.658931732177734, 399.0733337402344, 0],[61.83085632324219, 402.4545593261719, 0],[62.060089111328125, 406.1795959472656, 0],[62.86241149902344, 409.6754455566406, 0],[64.00858306884766, 412.5981750488281, 0],[65.61322021484375, 414.3174133300781, 0],[67.6190185546875, 415.06243896484375, 0],[70.14059448242188, 415.1197509765625, 0],[72.719482421875, 414.6039733886719, 0],[74.89720916748047, 414.3747253417969, 0],[76.67377471923828, 414.8905029296875, 0],[77.53340148925781, 415.86474609375, 0],[77.53340148925781, 416.89630126953125, 0],[76.50184631347656, 417.98516845703125, 0],[74.55335998535156, 418.5582580566406, 0],[72.20370483398438, 419.18865966796875, 0],[70.19790649414062, 419.990966796875, 0],[67.96287536621094, 421.3090515136719, 0],[66.3009262084961, 422.9136962890625, 0],[64.69628143310547, 424.80487060546875, 0],[63.49280548095703, 426.8106994628906, 0],[63.89396286010742, 428.4726257324219, 0],[65.2120590209961, 430.13458251953125, 0],[67.10324096679688, 431.10882568359375, 0],[68.99442291259766, 431.3953552246094, 0],[71.1148452758789, 430.7649841308594, 0],[73.6937255859375, 430.19189453125, 0],[75.81414794921875, 430.0772705078125, 0],[78.04917907714844, 430.0772705078125, 0],[80.16959381103516, 430.5930480957031, 0],[81.71692657470703, 431.4526672363281, 0],[82.4619369506836, 432.5988464355469, 0],[81.60231018066406, 433.9169616699219, 0],[80.3988265991211, 435.0631103515625, 0],[78.794189453125, 435.5788879394531, 0],[76.78839111328125, 435.4642639160156, 0],[74.72528076171875, 435.4069519042969, 0],[72.31832122802734, 435.2350158691406, 0],[70.3125228881836, 435.4642639160156, 0],[68.99442291259766, 436.2665710449219, 0],[68.42134094238281, 437.69927978515625, 0],[68.30671691894531, 439.3039245605469, 0],[68.47864532470703, 440.7366638183594, 0],[68.9371109008789, 442.6278381347656, 0],[69.73943328857422, 444.2897644042969, 0],[70.71367645263672, 445.8944091796875, 0],[71.57331085205078, 447.15521240234375, 0],[72.49024200439453, 448.3013916015625, 0],[73.46449279785156, 449.6767883300781, 0],[74.89720153808594, 451.1094970703125, 0],[76.04337310791016, 451.9691162109375, 0],[77.01761627197266, 452.3702697753906, 0],[78.39302062988281, 452.5995178222656, 0],[79.82573699951172, 452.4848937988281, 0],[81.0865249633789, 452.14105224609375, 0],[82.11808776855469, 450.994873046875, 0],[83.32156372070312, 449.6194763183594, 0],[84.29580688476562, 448.5879211425781, 0],[85.78583526611328, 447.3271484375, 0],[86.9320068359375, 446.23828125, 0],[88.59395599365234, 445.20672607421875, 0],[90.08396911621094, 444.920166015625, 0],[91.23014068603516, 445.3213195800781, 0],[91.68861389160156, 446.6394348144531, 0],[91.17283630371094, 448.12945556640625, 0],[90.1985855102539, 449.3902282714844, 0],[88.47933197021484, 450.7656555175781, 0],[86.98931121826172, 451.91180419921875, 0],[85.49928283691406, 453.172607421875, 0],[84.1238784790039, 454.891845703125, 0],[83.3215560913086, 456.7257385253906, 0],[82.74847412109375, 458.9034729003906, 0],[82.40462493896484, 460.966552734375, 0],[82.51924133300781, 462.8577575683594, 0],[82.97770690917969, 464.9781799316406, 0],[84.1238784790039, 466.0097351074219, 0],[85.2127456665039, 466.8693542480469, 0],[86.30160522460938, 467.3851318359375, 0],[87.50508117675781, 467.7862854003906, 0],[88.82318115234375, 467.6716613769531, 0],[90.31320190429688, 467.2705078125, 0],[91.40206909179688, 466.2962646484375, 0],[92.03246307373047, 464.9781799316406, 0],[93.17863464355469, 463.8893127441406, 0],[94.26749420166016, 463.0296630859375, 0],[95.52828216552734, 462.8004455566406, 0],[96.61714935302734, 462.7431335449219, 0]]; 
      var Su0SX =createNubs(point_Ext_InnerSX);
      //var curve0SX = MAP(Su0SX)(domain1);
      //DRAW(curve0SX);

    //Bottom curve
      var point_BottomSX = reverseR([[96.61714935302734+1, 462.7431335449219-0.5,-16],[91.44792175292969, 444.926513671875, -28], [88.10330200195312, 430.2937927246094, -36], [80.5779037475586, 406.0452880859375, -44], [79.74175262451172, 381.37872314453125, -36], [80.99598693847656, 353.7856140136719, -28], [88.66173553466797, 328.84747314453125+6,-16]]); //retta fondo
      var Su1SX =createNubs(point_BottomSX);
      
    //Laterals curves
      var point_LateralSX1 = [[88.66173553466797, 328.84747314453125,0], [78.33412170410156, 329.3287048339844,-10], [88.66173553466797, 328.84747314453125+6,-16]]; //retta profondità
      var Sv0SX = BEZIER(S1)(point_LateralSX1);
      //var curve2SX = MAP(BEZIER(S0)(point_LateralSX1))(domain1);
      //DRAW(curve2SX);

      var point_LateralSX2 = [[96.61714935302734, 462.7431335449219,0],[86.96328735351562, 462.3104248046875, -10],[96.61714935302734+1, 462.7431335449219-0.5,-16]]; // retta rofondità
      var Sv1SX = BEZIER(S1)(point_LateralSX2);
      //var curve3SX = MAP( BEZIER(S0)(point_LateralSX1))(domain1);
      //DRAW(curve3SX);

    //Volume generation
    var outDX = MAP(COONS_PATCH([Su0SX,Su1SX,Sv0SX,Sv1SX]))(domain2);
    //DRAW(outDX);

  //Inner membrane volume DX

    //Upper curve
      var point_Ext_InnerDX = reverseR( [[88.66173553466797, 328.84747314453125, 0],[90.07969665527344, 329.2727355957031, 0],[91.39779663085938, 329.78851318359375, 0],[92.77320098876953, 330.4762268066406, 0],[94.14860534667969, 331.2785339355469, 0],[95.40939331054688, 332.08087158203125, 0],[96.84210968017578, 332.997802734375, 0],[98.44674682617188, 334.2012939453125, 0],[99.70753479003906, 335.23284912109375, 0],[101.19756317138672, 336.3216857910156, 0],[102.6302719116211, 337.5824890136719, 0],[103.94837188720703, 338.7286682128906, 0],[105.20915985107422, 340.33331298828125, 0],[106.35533142089844, 341.8233337402344, 0],[107.15765380859375, 343.0841064453125, 0],[107.55880737304688, 344.6314392089844, 0],[107.67343139648438, 346.06414794921875, 0],[107.4441909790039, 347.2103271484375, 0],[107.100341796875, 348.35650634765625, 0],[106.18340301513672, 349.21612548828125, 0],[104.63607788085938, 349.5599670410156, 0],[103.03407287597656, 349.65802001953125, 0],[101.38426208496094, 349.59332275390625, 0],[99.66976165771484, 349.5285949707031, 0],[98.3321304321289, 349.5026550292969, 0],[97.11417388916016, 349.5609436035156, 0],[95.98194885253906, 349.59332275390625, 0],[94.8497314453125, 349.62567138671875, 0],[93.97630310058594, 350.11090087890625, 0],[93.6528091430664, 350.82257080078125, 0],[93.6204605102539, 351.5342712402344, 0],[93.6851577758789, 352.1812438964844, 0],[93.7822036743164, 353.0870056152344, 0],[94.17039489746094, 353.8310546875, 0],[95.1085205078125, 354.2515869140625, 0],[96.3701400756836, 354.3486328125, 0],[97.69645690917969, 354.154541015625, 0],[98.82868194580078, 353.7987060546875, 0],[100.15499877929688, 353.507568359375, 0],[101.44896697998047, 353.2811279296875, 0],[102.93702697753906, 353.2164306640625, 0],[104.36038970947266, 353.3458251953125, 0],[105.78223419189453, 353.5716552734375, 0],[107.55879974365234, 354.1447448730469, 0],[108.70497131347656, 354.8897399902344, 0],[109.85975646972656, 355.9337463378906, 0],[110.4420394897461, 357.2276916503906, 0],[110.92727661132812, 358.48931884765625, 0],[111.25077056884766, 360.1391296386719, 0],[111.41252136230469, 361.7242431640625, 0],[111.28311920166016, 363.4710998535156, 0],[110.86257934570312, 364.73272705078125, 0],[110.2479476928711, 365.67083740234375, 0],[109.30982208251953, 366.2531433105469, 0],[108.08055114746094, 366.6089782714844, 0],[106.52779388427734, 366.6089782714844, 0],[104.65154266357422, 366.6736755371094, 0],[103.1958236694336, 366.4148864746094, 0],[102.06360626220703, 366.1884460449219, 0],[101.19754791259766, 365.9502868652344, 0],[99.83151245117188, 365.73553466796875, 0],[98.44673919677734, 365.6064453125, 0],[96.89940643310547, 365.7210693359375, 0],[95.810546875, 366.1795349121094, 0],[95.12284088134766, 367.0964660644531, 0],[94.623291015625, 367.9676513671875, 0],[94.6556396484375, 369.099853515625, 0],[95.20557403564453, 370.1673889160156, 0],[96.30545043945312, 371.0408020019531, 0],[97.92290496826172, 371.52606201171875, 0],[99.37862396240234, 371.78485107421875, 0],[100.93138122558594, 371.94659423828125, 0],[102.80763244628906, 372.07598876953125, 0],[104.36039733886719, 372.17303466796875, 0],[106.13959503173828, 372.27008056640625, 0],[107.7894058227539, 372.69061279296875, 0],[108.986328125, 373.2082214355469, 0],[110.05384826660156, 374.1786804199219, 0],[110.76553344726562, 375.4403076171875, 0],[111.28311920166016, 376.9607238769531, 0],[111.50956726074219, 378.48114013671875, 0],[111.47721099853516, 380.1309509277344, 0],[111.50956726074219, 381.9425048828125, 0],[111.21842193603516, 383.3658447265625, 0],[110.79788208007812, 384.4333801269531, 0],[109.98998260498047, 385.2068176269531, 0],[108.90616607666016, 385.6321105957031, 0],[107.80863189697266, 385.71441650390625, 0],[106.69917297363281, 385.6644287109375, 0],[105.51752471923828, 385.28912353515625, 0],[104.36510467529297, 384.630615234375, 0],[103.10294342041016, 383.7937316894531, 0],[102.0602798461914, 383.02545166015625, 0],[101.11365509033203, 382.1474609375, 0],[99.93379974365234, 381.516357421875, 0],[98.80882263183594, 380.8852844238281, 0],[97.5466537475586, 380.61090087890625, 0],[96.60002899169922, 380.9950256347656, 0],[95.9415054321289, 381.7633056640625, 0],[95.63862609863281, 382.5124816894531, 0],[95.29476928710938, 383.77325439453125, 0],[95.52400207519531, 385.09136962890625, 0],[95.75324249267578, 386.06561279296875, 0],[96.31192779541016, 387.00408935546875, 0],[97.09391784667969, 388.0055847167969, 0],[97.93096160888672, 388.7017822265625, 0],[98.671630859375, 389.281494140625, 0],[99.71428680419922, 389.8165283203125, 0],[101.08293914794922, 390.3637390136719, 0],[102.33466339111328, 390.8180236816406, 0],[103.54195404052734, 391.0924072265625, 0],[104.69436645507812, 391.3805236816406, 0],[105.79190826416016, 391.545166015625, 0],[107.10033416748047, 391.6818542480469, 0],[108.13188934326172, 391.79644775390625, 0],[109.7430419921875, 392.0802307128906, 0],[111.11495971679688, 392.7936096191406, 0],[112.00074005126953, 393.94708251953125, 0],[112.38825225830078, 395.0665588378906, 0],[112.60195922851562, 396.7250061035156, 0],[112.21602630615234, 397.82220458984375, 0],[111.39847564697266, 398.7308044433594, 0],[110.25230407714844, 399.18927001953125, 0],[109.10613250732422, 399.5331115722656, 0],[107.55880737304688, 399.5904235839844, 0],[106.41263580322266, 399.5904235839844, 0],[104.7241439819336, 399.5875244140625, 0],[103.08873748779297, 399.7623291015625, 0],[101.54141235351562, 400.2207946777344, 0],[100.62447357177734, 401.0231018066406, 0],[99.9448471069336, 402.1709289550781, 0],[99.9448471069336, 403.67791748046875, 0],[100.80598449707031, 404.668212890625, 0],[102.22685241699219, 405.4001770019531, 0],[103.26021575927734, 405.8738098144531, 0],[104.9394302368164, 406.30438232421875, 0],[106.69918060302734, 406.86859130859375, 0],[108.59925842285156, 407.5530090332031, 0],[110.36692810058594, 408.3013000488281, 0],[112.08684539794922, 409.1891784667969, 0],[113.80912017822266, 410.7822570800781, 0],[114.55045318603516, 412.08367919921875, 0],[114.97164916992188, 413.4087219238281, 0],[115.2730484008789, 414.61431884765625, 0],[115.10082244873047, 415.9490966796875, 0],[114.45497131347656, 417.1116027832031, 0],[113.12020874023438, 418.1019287109375, 0],[111.3548812866211, 418.4033203125, 0],[109.63261413574219, 418.2310791015625, 0],[108.0745849609375, 417.81451416015625, 0],[106.6418685913086, 417.1268310546875, 0],[105.28387451171875, 416.4226989746094, 0],[103.71913146972656, 415.8087158203125, 0],[102.18379211425781, 415.2601623535156, 0],[100.2462387084961, 414.9587707519531, 0],[99.12676239013672, 415.38934326171875, 0],[98.78230285644531, 415.86297607421875, 0],[98.73925018310547, 416.853271484375, 0],[99.07714080810547, 417.81451416015625, 0],[100.20317840576172, 418.9200134277344, 0],[101.62405395507812, 419.953369140625, 0],[103.69078063964844, 420.8575439453125, 0],[105.67138671875, 421.41729736328125, 0],[107.60894012451172, 421.9770202636719, 0],[109.5034408569336, 422.708984375, 0],[111.22655487060547, 423.6600036621094, 0],[112.37272644042969, 424.3476867675781, 0],[113.40428161621094, 425.09271240234375, 0],[114.43583679199219, 426.0096435546875, 0],[115.48833465576172, 426.97161865234375, 0],[116.38432312011719, 428.2446594238281, 0],[117.29671478271484, 429.7272644042969, 0],[117.8995132446289, 431.1911926269531, 0],[118.20091247558594, 432.4828796386719, 0],[118.37313842773438, 434.4635009765625, 0],[118.37313842773438, 435.7552185058594, 0],[117.98562622070312, 437.3052673339844, 0],[117.12933349609375, 438.21636962890625, 0],[115.7539291381836, 438.6748352050781, 0],[113.8521728515625, 438.2955627441406, 0],[112.08684539794922, 437.26220703125, 0],[110.2784652709961, 436.185791015625, 0],[108.9437026977539, 435.02325439453125, 0],[107.90265655517578, 434.3766784667969, 0],[106.70475006103516, 434.1190490722656, 0],[105.62833404541016, 434.4635009765625, 0],[105.19776153564453, 435.5829772949219, 0],[105.58527374267578, 436.70245361328125, 0],[107.35060119628906, 438.0372314453125, 0],[109.11592864990234, 439.3719787597656, 0],[111.01042938232422, 440.6206359863281, 0],[112.54464721679688, 441.6548767089844, 0],[114.20659637451172, 442.6864318847656, 0],[116.21239471435547, 443.9472351074219, 0],[117.58779907226562, 444.978759765625, 0],[118.6314697265625, 446.1319274902344, 0],[119.2773208618164, 447.76806640625, 0],[119.57872009277344, 449.5764465332031, 0],[119.57872009277344, 450.78204345703125, 0],[119.23426818847656, 452.80572509765625, 0],[118.5047378540039, 453.7469787597656, 0],[117.33976745605469, 454.18353271484375, 0],[115.83277893066406, 454.0543518066406, 0],[114.54107666015625, 453.02099609375, 0],[113.12020874023438, 451.7723388671875, 0],[111.6562728881836, 450.7389831542969, 0],[110.23540496826172, 449.8348083496094, 0],[109.07286834716797, 449.1889343261719, 0],[107.78116607666016, 448.3708801269531, 0],[106.66168975830078, 447.8111267089844, 0],[105.61031341552734, 447.5003662109375, 0],[104.121337890625, 447.3374938964844, 0],[103.26020812988281, 447.68194580078125, 0],[102.65740966796875, 448.5430908203125, 0],[102.3990707397461, 449.5764465332031, 0],[102.44212341308594, 450.5667724609375, 0],[103.044921875, 451.55706787109375, 0],[104.29356384277344, 452.2890319824219, 0],[106.01583862304688, 453.02099609375, 0],[108.01727294921875, 453.8042907714844, 0],[110.53679656982422, 454.8293762207031, 0],[112.17295837402344, 455.86273193359375, 0],[113.55077362060547, 456.8099670410156, 0],[115.14387512207031, 458.01556396484375, 0],[116.04806518554688, 459.0489196777344, 0],[116.65086364746094, 460.2975769042969, 0],[116.82308959960938, 461.6753845214844, 0],[116.52169036865234, 463.2254333496094, 0],[115.8327865600586, 464.6893615722656, 0],[114.9285888671875, 465.9380187988281, 0],[113.63688659667969, 467.10052490234375, 0],[112.08684539794922, 468.1769714355469, 0],[110.36457061767578, 468.82281494140625, 0],[108.5992431640625, 468.95196533203125, 0],[107.32957458496094, 468.70452880859375, 0],[105.84361267089844, 468.1339111328125, 0],[104.72413635253906, 467.5310974121094, 0],[103.6045150756836, 466.69873046875, 0],[102.35601043701172, 465.72271728515625, 0],[101.10736846923828, 464.3018493652344, 0],[100.11705780029297, 463.3545837402344, 0],[99.19175720214844, 462.9736633300781, 0],[98.16020202636719, 462.74444580078125, 0],[97.47249603271484, 462.74444580078125, 0],[96.61714935302734, 462.7431335449219, 0]]); //curve
      var Su0DX =createNubs(point_Ext_InnerDX);
      //var curve0DX = MAP(Su0DX)(domain1);
      //DRAW(curve0DX);

     //Bottom curve
      var point_BottomDX = reverseR([[88.66173553466797, 328.84747314453125+6,-16],[90.99598693847656, 353.7856140136719, -28],[89.74175262451172, 381.37872314453125, -36],[90.5779037475586, 406.0452880859375, -44],[98.10330200195312, 430.2937927246094, -36],[101.44792175292969, 444.926513671875, -28],[96.61714935302734+1, 462.7431335449219-0.5,-16]]); //retta fondo
      var Su1DX =createNubs(point_BottomDX);
      //var curve1SX = MAP(Su1SX)(domain1);
      //DRAW(curve1SX);

     var point_Su1DXreverse = reverseR(point_BottomDX);
      var Su1DXrev =createNubs(point_Su1DXreverse); //useful to generate the bottom closure
      //var curve1DX = MAP(Su1DX)(domain1);
      //DRAW(curve1DX);

    //Laterals curves
      var point_LateralDX1 = [[96.61714935302734, 462.7431335449219,0],[106.96328735351562, 462.3104248046875, -10],[96.61714935302734+1, 462.7431335449219-0.5,-16]];//retta profondita
      var Sv0DX = BEZIER(S1)(point_LateralDX1);
      //var curve2DX = MAP(BEZIER(S0)(point_LateralDX1))(domain1);
      //DRAW(curve2DX);

      var point_LateralDX2 = [[88.66173553466797, 328.84747314453125,0],[98.33412170410156, 329.3287048339844,-10],[88.66173553466797, 328.84747314453125+6,-16]]; // retta rofondità
      var Sv1DX = BEZIER(S1)(point_LateralDX2);
      //var curve3DX = MAP( BEZIER(S0)(point_LateralDX2))(domain1);
      //DRAW(curve3DX);

    //Volume generation
      var outSX = MAP(COONS_PATCH([Su0DX,Su1DX,Sv0DX,Sv1DX]))(domain2);
    //DRAW(outSX);

  //Bottom closure
    var bottom = BEZIER(S1)([Su1DXrev,Su1SX]);
    var bottomMap = (MAP(bottom)(domain2));

  //Lateral closures

    var lateralClosure1=BEZIER(S2)([Sv1SX,[88.66173553466797, 328.84747314453125+6,-15],Sv0DX]);
    var lateralClosure2=BEZIER(S2)([Sv1DX,[96.61714935302734+1, 462.7431335449219-0.5,-16],Sv0SX]);
    var lc1Map = (MAP(lateralClosure1)(domain3));
    var lc2Map = (MAP(lateralClosure2)(domain3));
    DRAW (COLOR (mattCoralRed)(lc1Map));
    DRAW (COLOR (mattCoralRed)(lc2Map));

  //Volume assembly (DX+SX+bottom+lateral)
    var volume_inner = COLOR (mattCoralRed)(STRUCT ([bottomMap,outSX,outDX]));
    DRAW (volume_inner);

//Boundary of inner membrane with cristae

  //Internal
   var pointInt_InnerDX= reverseR([[88.75521087646484, 333.3511047363281, 0],[90.28076171875, 334.1138610839844, 0 ],[91.19609832763672, 334.571533203125, 0 ],[92.34026336669922, 335.1817626953125, 0 ],[93.40814971923828, 335.7156982421875, 0 ],[94.3997573852539, 336.4784851074219, 0 ],[95.23881530761719, 337.08868408203125, 0 ],[96.23042297363281, 337.8514709472656, 0 ],[97.22203826904297, 338.6142578125, 0 ],[98.28992462158203, 339.45330810546875, 0 ],[99.43408966064453, 340.4449157714844, 0 ],[100.57825469970703, 341.4365234375, 0 ],[101.56986236572266, 342.27557373046875, 0 ],[102.6466293334961, 343.15423583984375, 0 ],[103.42436981201172, 343.9805908203125, 0 ],[103.66741180419922, 344.78265380859375, 0 ],[103.67568969726562, 345.3428955078125, 0 ],[103.4973373413086, 345.809326171875, 0 ],[103.33271026611328, 346.11114501953125, 0 ],[103.0720443725586, 346.2895202636719, 0 ],[102.79766082763672, 346.3443908691406, 0 ],[102.1802978515625, 346.38555908203125, 0 ],[101.12513732910156, 346.4075927734375, 0 ],[99.60472106933594, 346.4722900390625, 0 ],[98.24605560302734, 346.43994140625, 0 ],[96.98443603515625, 346.43994140625, 0 ],[95.46402740478516, 346.4722900390625, 0 ],[93.74951934814453, 346.6016845703125, 0 ],[92.58494567871094, 347.3133850097656, 0 ],[91.51742553710938, 348.80145263671875, 0 ],[91.22628021240234, 350.3218688964844, 0 ],[91.19056701660156, 351.4920959472656, 0 ],[91.28660583496094, 352.31524658203125, 0 ],[91.39635467529297, 353.35791015625, 0 ],[91.98628234863281, 354.5377502441406, 0 ],[92.9395980834961, 355.63128662109375, 0 ],[94.40352630615234, 356.3201904296875, 0 ],[96.0827407836914, 356.40631103515625, 0 ],[97.76195526123047, 356.3632507324219, 0 ],[99.22588348388672, 356.2771301269531, 0 ],[100.51758575439453, 356.23406982421875, 0 ],[101.68012237548828, 356.1910095214844, 0 ],[102.71348571777344, 356.3201904296875, 0 ],[103.61478424072266, 356.6282043457031, 0 ],[104.61126708984375, 357.16290283203125, 0 ],[105.36470031738281, 357.62469482421875, 0 ],[106.26396942138672, 358.32952880859375, 0 ],[106.75005340576172, 359.2530822753906, 0 ],[107.14007568359375, 360.2435302734375, 0 ],[107.32267761230469, 361.3026123046875, 0 ],[107.19485473632812, 362.0695495605469, 0 ],[106.9757308959961, 362.61737060546875, 0 ],[106.61052703857422, 362.8912658691406, 0 ],[106.30010223388672, 363.037353515625, 0 ],[106.02619934082031, 363.1103820800781, 0 ],[105.60620880126953, 363.128662109375, 0 ],[104.8027572631836, 363.14691162109375, 0 ],[103.54280090332031, 363.1103820800781, 0 ],[102.62979125976562, 363.037353515625, 0 ],[101.7532958984375, 363.01910400390625, 0 ],[100.34725189208984, 362.946044921875, 0 ],[98.6125259399414, 362.8912658691406, 0 ],[98.6125259399414, 362.9095153808594, 0 ],[96.349365234375, 362.9974060058594, 0 ],[94.52653503417969, 363.5321044921875, 0 ],[92.89813995361328, 364.6501159667969, 0 ],[91.51278686523438, 366.71600341796875, 0 ],[91.26973724365234, 369.31658935546875, 0 ],[92.02317810058594, 371.358154296875, 0 ],[93.7730941772461, 373.25390625, 0 ],[96.5438003540039, 374.37188720703125, 0 ],[98.9256362915039, 374.61492919921875, 0 ],[100.74846649169922, 374.7364501953125, 0 ],[102.47408294677734, 374.80938720703125, 0 ],[103.90804290771484, 375.05242919921875, 0 ],[105.31769561767578, 375.2468566894531, 0 ],[106.6058349609375, 375.6600341796875, 0 ],[106.92179107666016, 375.95166015625, 0 ],[107.18914031982422, 376.31622314453125, 0 ],[107.31066131591797, 376.6321716308594, 0 ],[107.62661743164062, 377.409912109375, 0 ],[107.94258117675781, 378.5036315917969, 0 ],[108.30714416503906, 379.9618835449219, 0 ],[108.33145141601562, 381.1528015136719, 0 ],[108.18562316894531, 382.173583984375, 0 ],[107.96688079833984, 382.8055114746094, 0 ],[107.65092468261719, 383.0728454589844, 0 ],[107.26205444335938, 383.0485534667969, 0 ],[106.8974838256836, 383.02423095703125, 0 ],[106.43569946289062, 382.8055114746094, 0 ],[105.75518035888672, 382.4409484863281, 0 ],[104.95313262939453, 381.8576354980469, 0 ],[103.64069366455078, 380.88543701171875, 0 ],[102.37686157226562, 379.91326904296875, 0 ],[100.99150848388672, 378.96539306640625, 0 ],[99.53324890136719, 378.3091735839844, 0 ],[97.30909729003906, 377.9130859375, 0 ],[95.56224060058594, 378.236572265625, 0 ],[93.97712707519531, 379.142333984375, 0 ],[92.90960693359375, 380.8568420410156, 0 ],[92.35967254638672, 382.9919128417969, 0 ],[92.74786376953125, 385.25634765625, 0 ],[93.00665283203125, 386.4856262207031, 0 ],[93.45954132080078, 387.5531311035156, 0 ],[94.39766693115234, 388.87945556640625, 0 ],[94.39766693115234, 388.91180419921875, 0 ],[95.56224060058594, 389.9469909667969, 0 ],[96.27391815185547, 390.5292663574219, 0 ],[97.17970275878906, 391.0468444824219, 0 ],[98.50601196289062, 391.7261962890625, 0 ],[100.15582275390625, 392.21142578125, 0 ],[101.70858001708984, 392.6319580078125, 0 ],[103.09960174560547, 392.9554748535156, 0 ],[104.23181915283203, 393.3113098144531, 0 ],[105.39639282226562, 393.5700988769531, 0 ],[106.62566375732422, 393.7641906738281, 0 ],[107.69318389892578, 393.9582824707031, 0 ],[108.76070404052734, 394.1847229003906, 0 ],[109.01950073242188, 394.4435119628906, 0 ],[109.11654663085938, 394.83172607421875, 0 ],[109.11654663085938, 395.31695556640625, 0 ],[109.05184936523438, 395.89923095703125, 0 ],[108.92245483398438, 396.12567138671875, 0 ],[108.66365814208984, 396.25506591796875, 0 ],[108.46956634521484, 396.35211181640625, 0 ],[108.04902648925781, 396.4168395996094, 0 ],[107.43438720703125, 396.4168395996094, 0 ],[106.33451843261719, 396.4491882324219, 0 ],[104.71705627441406, 396.5138854980469, 0 ],[102.74375915527344, 396.9344177246094, 0 ],[100.80280303955078, 397.4843444824219, 0 ],[98.1501693725586, 398.843017578125, 0 ],[96.6297607421875, 400.6869201660156, 0 ],[96.04747772216797, 402.53082275390625, 0 ],[96.338623046875, 403.9541931152344, 0 ],[97.7943344116211, 405.60400390625, 0 ],[100.15582275390625, 406.7362365722656, 0 ],[101.96737670898438, 407.6096496582031, 0 ],[104.13477325439453, 408.0301818847656, 0 ],[106.04338073730469, 408.83892822265625, 0 ],[107.49909210205078, 409.58294677734375, 0 ],[108.56661224365234, 410.1652526855469, 0 ],[109.79588317871094, 411.0386657714844, 0 ],[110.44286346435547, 411.6209411621094, 0 ],[110.7340087890625, 412.1385498046875, 0 ],[110.8310546875, 412.753173828125, 0 ],[110.7987060546875, 413.2060546875, 0 ],[110.44286346435547, 413.5619201660156, 0 ],[110.08702850341797, 413.5942687988281, 0 ],[109.86058044433594, 413.529541015625, 0 ],[109.5047378540039, 413.4324951171875, 0 ],[108.85775756835938, 413.2384033203125, 0 ],[108.11372375488281, 412.9796142578125, 0 ],[107.14324951171875, 412.882568359375, 0 ],[105.94632720947266, 412.6561279296875, 0 ],[104.13477325439453, 412.2032470703125, 0 ],[102.71141052246094, 411.8150634765625, 0 ],[100.12347412109375, 411.0386657714844, 0 ],[98.21487426757812, 411.1033630371094, 0 ],[96.14452362060547, 412.623779296875, 0 ],[95.65928649902344, 414.8235168457031, 0 ],[95.85338592529297, 416.92620849609375, 0 ],[96.5650634765625, 419.1259765625, 0 ],[98.02079010009766, 420.8404541015625, 0 ],[100.15583801269531, 422.0697326660156, 0 ],[102.42028045654297, 423.49310302734375, 0 ],[104.68472290039062, 424.20477294921875, 0 ],[107.17560577392578, 425.2723083496094, 0 ],[108.8901138305664, 426.1133728027344, 0 ],[110.41053009033203, 426.9544677734375, 0 ],[111.6397933959961, 427.6337890625, 0 ],[112.51322937011719, 428.3131103515625, 0 ],[113.58074951171875, 429.1865539550781, 0 ],[114.35713195800781, 430.0923156738281, 0 ],[115.03646087646484, 431.28924560546875, 0 ],[115.39230346679688, 432.2273864746094, 0 ],[115.45700073242188, 433.3272399902344, 0 ],[115.42465209960938, 433.9418640136719, 0 ],[115.00411224365234, 434.1036376953125, 0 ],[114.58357238769531, 434.006591796875, 0 ],[114.32478332519531, 433.9095153808594, 0 ],[113.90424346923828, 433.6830749511719, 0 ],[112.83671569824219, 433.4242858886719, 0 ],[110.86341857910156, 432.5508728027344, 0 ],[109.31065368652344, 431.96856689453125, 0 ],[107.62850189208984, 431.28924560546875, 0 ],[105.00821685791016, 430.93341064453125, 0 ],[103.0672607421875, 431.45098876953125, 0 ],[102.35558319091797, 433.0684509277344, 0 ],[102.48497772216797, 436.2710266113281, 0 ],[103.61720275878906, 437.82379150390625, 0 ],[105.10526275634766, 439.5382995605469, 0 ],[106.65802001953125, 440.7351989746094, 0 ],[108.40487670898438, 441.867431640625, 0 ],[109.989990234375, 443.161376953125, 0 ],[111.57510375976562, 444.2612609863281, 0 ],[113.09551239013672, 445.3934631347656, 0 ],[113.83954620361328, 446.04046630859375, 0 ],[114.61592864990234, 446.88153076171875, 0 ],[115.13351440429688, 447.5608825683594, 0 ],[115.32760620117188, 448.6283874511719, 0 ],[115.19821166992188, 449.0165710449219, 0 ],[115.03646850585938, 449.3724365234375, 0 ],[114.68062591552734, 449.40478515625, 0 ],[114.26008605957031, 449.1136169433594, 0 ],[113.90424346923828, 448.7901306152344, 0 ],[113.35430908203125, 448.3372497558594, 0 ],[112.41618347167969, 447.7873229980469, 0 ],[110.89576721191406, 446.84918212890625, 0 ],[109.24596405029297, 446.13751220703125, 0 ],[108.04904174804688, 445.5875549316406, 0 ],[106.75507354736328, 444.9082336425781, 0 ],[104.58767700195312, 443.9701232910156, 0 ],[102.22618865966797, 444.325927734375, 0 ],[100.86752319335938, 445.78167724609375, 0 ],[100.02644348144531, 447.43145751953125, 0 ],[99.76764678955078, 449.1783142089844, 0 ],[100.22053527832031, 450.7957763671875, 0 ],[101.3204116821289, 452.3161926269531, 0 ],[102.45262908935547, 453.38372802734375, 0 ],[104.39358520507812, 454.6777038574219, 0 ],[106.52862548828125, 455.9716491699219, 0 ],[108.98716735839844, 457.1038818359375, 0 ],[110.34583282470703, 457.783203125, 0 ],[111.54275512695312, 458.4625244140625, 0 ],[112.38383483886719, 459.2712707519531, 0 ],[112.67497253417969, 459.6918029785156, 0 ],[112.80437469482422, 460.2417297363281, 0 ],[112.77202606201172, 460.9210510253906, 0 ],[112.64262390136719, 461.76214599609375, 0 ],[112.35148620605469, 462.53851318359375, 0 ],[111.89859771728516, 463.2178649902344, 0 ],[111.4133529663086, 463.8324890136719, 0 ],[110.63697814941406, 464.1236267089844, 0 ],[109.92529296875, 464.1883239746094, 0 ],[109.05186462402344, 464.0265808105469, 0 ],[107.85494232177734, 463.7030944824219, 0 ],[106.72272491455078, 463.3149108886719, 0 ],[105.71990203857422, 462.66790771484375, 0 ],[104.97586822509766, 462.24737548828125, 0 ],[103.90834045410156, 461.43865966796875, 0 ],[102.58203125, 460.5005187988281, 0 ],[101.2880630493164, 459.4006652832031, 0 ],[100.05879211425781, 459.012451171875, 0 ],[98.66777801513672, 458.68896484375, 0 ],[97.50320434570312, 458.624267578125, 0 ],[96.60772705078125, 458.2706604003906, 0]]); 
   var c0 =createNubs(pointInt_InnerDX);
  
   var pointInt_InnerSX= reverseR([[96.60772705078125, 458.2706604003906, 0],[95.28962707519531, 458.2133483886719, 0 ],[93.5130615234375, 459.0729675292969, 0 ],[92.19496154785156, 460.2764587402344, 0 ],[90.8195571899414, 461.7664794921875, 0 ],[90.36109161376953, 462.6260986328125, 0 ],[89.73069763183594, 463.2565002441406, 0 ],[88.92837524414062, 463.42840576171875, 0 ],[87.83951568603516, 463.42840576171875, 0 ],[87.26642608642578, 463.1991882324219, 0 ],[86.8079605102539, 462.8553466796875, 0 ],[86.52141571044922, 462.3395690917969, 0 ],[86.52141571044922, 461.5372314453125, 0 ],[86.57872772216797, 460.792236328125, 0 ],[86.75064849853516, 459.9898986816406, 0 ],[86.92257690429688, 459.47412109375, 0 ],[87.26642608642578, 457.8121643066406, 0 ],[87.66758728027344, 456.5513916015625, 0 ],[88.18336486816406, 455.5771484375, 0 ],[88.8710708618164, 454.7748107910156, 0 ],[90.36109161376953, 453.628662109375, 0 ],[90.41839599609375, 453.628662109375, 0 ],[91.9084243774414, 452.0813293457031, 0 ],[93.22651672363281, 450.30474853515625, 0 ],[93.8569107055664, 448.35626220703125, 0 ],[94.02883911132812, 446.7516174316406, 0 ],[93.74229431152344, 444.45928955078125, 0 ],[93.28382873535156, 443.7142639160156, 0 ],[91.22071838378906, 442.568115234375, 0 ],[88.69913482666016, 442.28155517578125, 0 ],[86.06294250488281, 443.25579833984375, 0 ],[84.6302261352539, 444.5165710449219, 0 ],[83.59867095947266, 445.5481262207031, 0 ],[82.45249938964844, 446.5796813964844, 0 ],[81.5928726196289, 447.38201904296875, 0 ],[80.9051742553711, 447.9551086425781, 0 ],[80.6186294555664, 448.12701416015625, 0 ],[79.70169067382812, 448.2989501953125, 0 ],[78.8420639038086, 448.35626220703125, 0 ],[77.69589233398438, 448.2989501953125, 0 ],[77.06549835205078, 448.12701416015625, 0 ],[76.4924087524414, 447.5539245605469, 0 ],[75.86201477050781, 446.9235534667969, 0 ],[75.28893280029297, 446.29315185546875, 0 ],[74.60122680664062, 445.6054382324219, 0 ],[73.91352844238281, 444.8031311035156, 0 ],[73.34043884277344, 443.4850158691406, 0 ],[72.7673568725586, 442.109619140625, 0 ],[72.4808120727539, 440.4476623535156, 0 ],[72.53812408447266, 440.4476623535156, 0 ],[72.4808120727539, 439.7026672363281, 0 ],[72.65274047851562, 439.301513671875, 0 ],[72.93927764892578, 439.01495361328125, 0 ],[73.34043884277344, 438.90032958984375, 0 ],[73.97083282470703, 438.9576416015625, 0 ],[74.88777160644531, 438.9576416015625, 0 ],[76.60702514648438, 438.9576416015625, 0 ],[78.61283111572266, 438.90032958984375, 0 ],[78.67013549804688, 438.90032958984375, 0 ],[82.05134582519531, 438.3272705078125, 0 ],[84.17176055908203, 437.29571533203125, 0 ],[85.8910140991211, 435.2898864746094, 0 ],[86.75064849853516, 432.3098449707031, 0 ],[86.23487091064453, 429.6736755371094, 0 ],[86.29217529296875, 429.6736755371094, 0 ],[84.34368896484375, 427.6105651855469, 0 ],[81.13440704345703, 427.152099609375, 0 ],[77.7531967163086, 427.0374755859375, 0 ],[74.48661041259766, 427.2093811035156, 0 ],[71.56387329101562, 427.6105651855469, 0 ],[70.58963012695312, 427.4959411621094, 0 ],[70.13116455078125, 427.0374755859375, 0 ],[69.95923614501953, 426.5216979980469, 0 ],[69.95923614501953, 426.4643859863281, 0 ],[69.95923614501953, 425.77667236328125, 0 ],[70.13116455078125, 425.0889892578125, 0 ],[70.87617492675781, 424.5158996582031, 0 ],[71.90773010253906, 423.71356201171875, 0 ],[72.99659729003906, 422.7392883300781, 0 ],[74.37200164794922, 421.9942932128906, 0 ],[74.37200164794922, 422.0516052246094, 0 ],[75.86202239990234, 421.8223571777344, 0 ],[78.15436553955078, 421.0200500488281, 0 ],[81.07710266113281, 418.38385009765625, 0 ],[81.42095184326172, 415.2891845703125, 0 ],[79.300537109375, 412.0225830078125, 0 ],[75.69009399414062, 410.9337463378906, 0 ],[72.71005249023438, 411.10565185546875, 0 ],[70.07386016845703, 411.22027587890625, 0 ],[68.69844818115234, 411.04833984375, 0 ],[68.69844818115234, 410.9910583496094, 0 ],[68.18267059326172, 410.5898742675781, 0 ],[67.60958862304688, 409.04254150390625, 0 ],[67.55227661132812, 408.9852294921875, 0 ],[66.5207290649414, 405.8905944824219, 0 ],[65.66109466552734, 402.2801513671875, 0 ],[65.03070068359375, 398.95623779296875, 0 ],[65.03070068359375, 395.9761962890625, 0 ],[65.20262908935547, 392.7096252441406, 0 ],[65.48917388916016, 390.70379638671875, 0 ],[65.66109466552734, 389.95880126953125, 0 ],[65.94763946533203, 389.5003356933594, 0 ],[66.00495147705078, 389.5003356933594, 0 ],[66.57803344726562, 389.2710876464844, 0 ],[67.151123046875, 389.2710876464844, 0 ],[67.89613342285156, 389.84417724609375, 0 ],[69.27153778076172, 390.6465148925781, 0 ],[70.41770935058594, 391.7353515625, 0 ],[70.47501373291016, 391.7353515625, 0 ],[72.25157928466797, 393.053466796875, 0 ],[75.40355682373047, 394.6581115722656, 0 ],[78.03974914550781, 395.6323547363281, 0 ],[80.50401306152344, 395.6323547363281, 0 ],[81.53556823730469, 393.97039794921875, 0 ],[81.07710266113281, 391.2195739746094, 0 ],[80.21747589111328, 389.2137756347656, 0 ],[79.12860870361328, 386.978759765625, 0 ],[76.72164916992188, 384.3425598144531, 0 ],[74.71585083007812, 382.79522705078125, 0 ],[72.5954360961914, 381.13330078125, 0 ],[69.84461975097656, 379.75787353515625, 0 ],[68.1253662109375, 378.8409423828125, 0 ],[67.26573944091797, 378.2105407714844, 0 ],[66.92188262939453, 377.5801696777344, 0 ],[66.74996185302734, 377.007080078125, 0 ],[66.6926498413086, 376.09014892578125, 0 ],[66.97919464111328, 375.4597473144531, 0 ],[67.20842742919922, 375.1731872558594, 0 ],[67.95343780517578, 375.11590576171875, 0 ],[68.69844818115234, 375.11590576171875, 0 ],[70.0738525390625, 374.88665771484375, 0 ],[71.96504211425781, 374.7147216796875, 0 ],[75.28893280029297, 374.1416320800781, 0 ],[79.18592071533203, 371.2762145996094, 0 ],[80.10285186767578, 368.2388610839844, 0 ],[80.2747802734375, 365.946533203125, 0 ],[80.2747802734375, 365.88922119140625, 0 ],[80.10285186767578, 362.9664611816406, 0 ],[78.72744750976562, 360.2729797363281, 0 ],[76.54972076416016, 358.0952453613281, 0 ],[73.225830078125, 356.77716064453125, 0 ],[70.24578094482422, 357.1210021972656, 0 ],[69.4434585571289, 357.2356262207031, 0 ],[68.81306457519531, 357.2929382324219, 0 ],[67.7815170288086, 357.1210021972656, 0 ],[67.4949722290039, 356.77716064453125, 0 ],[67.32304382324219, 356.3759765625, 0 ],[67.32304382324219, 355.74560546875, 0 ],[67.32304382324219, 353.6824951171875, 0 ],[67.26573944091797, 351.96319580078125, 0 ],[67.26573944091797, 350.4731750488281, 0 ],[67.4949722290039, 349.38433837890625, 0 ],[68.01074981689453, 349.0977783203125, 0 ],[68.58383178710938, 348.92584228515625, 0 ],[69.21422576904297, 348.92584228515625, 0 ],[69.95923614501953, 349.38433837890625, 0 ],[70.36039733886719, 350.5877990722656, 0 ],[70.99079132080078, 351.7912902832031, 0 ],[74.08545684814453, 353.6824645996094, 0 ],[77.92513275146484, 354.14093017578125, 0 ],[81.3636474609375, 352.9947509765625, 0 ],[82.9682846069336, 349.15509033203125, 0 ],[83.02559661865234, 346.5188903808594, 0 ],[82.337890625, 344.28387451171875, 0 ],[81.65018463134766, 342.4499816894531, 0 ],[80.7332534790039, 340.7880554199219, 0 ],[79.70169830322266, 338.8968505859375, 0 ],[78.49821472167969, 337.2922058105469, 0 ],[77.98243713378906, 336.2606506347656, 0 ],[77.46665954589844, 334.71331787109375, 0 ],[77.46665954589844, 333.6817932128906, 0 ],[77.8678207397461, 332.70751953125, 0 ],[78.3262939453125, 332.2490539550781, 0 ],[78.72744750976562, 332.01983642578125, 0 ],[79.70169830322266, 331.79058837890625, 0 ],[81.47826385498047, 331.3321228027344, 0 ],[83.82791137695312, 331.1029052734375, 0 ],[85.7190933227539, 331.4467468261719, 0 ],[88.75521087646484, 333.3511047363281, 0 ]]);  
   var c1 =createNubs(pointInt_InnerSX);
  
  //Filling the boundary
    var b = BEZIER(S1)([c1,Su0SX]);
    var b1 = COLOR (mattIndianRed)(MAP(b)(domain2));
    DRAW (b1);

    var b = BEZIER(S1)([c0,Su0DX]);
    var b1 = COLOR (mattIndianRed)(MAP(b)(domain2));
    DRAW (b1);


/*********************************************************************************CENTRIOLE*******************************************************************/
//Microtubule triplet A

//Microtubule  A1 ext
var point_supA1ext =  [[66.66948699951172, 229.05184936523438, 0],[65.73657989501953, 229.60061645507812, 0],[65.21524810791016, 230.43748474121094, 0],[65.06433868408203, 231.32923889160156, 0],[65.311279296875, 232.09751892089844, 0],[65.81889343261719, 232.74232482910156, 0],[66.60089111328125, 233.12644958496094, 0],[67.87677764892578, 233.16761779785156, 0],[68.7410888671875, 232.632568359375, 0],[69.33100891113281, 231.85057067871094, 0],[69.48192596435547, 231.08229064941406, 0],[69.23497772216797, 230.27285766601562, 0],[68.86455535888672, 229.49085998535156, 0],[67.7944564819336, 229.0106964111328, 0],[66.66948699951172, 229.05184936523438, 0]] ;
var point_infA1ext = [[66.66948699951172, 229.05184936523438, -36],[65.73657989501953, 229.60061645507812, -36],[65.21524810791016, 230.43748474121094, -36],[65.06433868408203, 231.32923889160156, -36],[65.311279296875, 232.09751892089844, -36],[65.81889343261719, 232.74232482910156, -36],[66.60089111328125, 233.12644958496094, -36],[67.87677764892578, 233.16761779785156, -36],[68.7410888671875, 232.632568359375, -36],[69.33100891113281, 231.85057067871094, -36],[69.48192596435547, 231.08229064941406, -36],[69.23497772216797, 230.27285766601562, -36],[68.86455535888672, 229.49085998535156, -36],[67.7944564819336, 229.0106964111328, -36],[66.66948699951172, 229.05184936523438, -36]];
var micA1ext = generateMicrotubule(point_supA1ext,point_infA1ext);

//Microtubule  A1 int
var point_supA1int = [[66.83411407470703, 229.6280517578125, 0],[66.09327697753906, 229.97103881835938, 0],[65.7777328491211, 230.5472412109375, 0],[65.64054107666016, 231.2880859375, 0],[65.83261108398438, 231.9466094970703, 0],[66.13443756103516, 232.23471069335938, 0],[66.6969223022461, 232.59140014648438, 0],[67.71214294433594, 232.6188507080078, 0],[68.43926239013672, 232.207275390625, 0],[68.68621063232422, 231.6584930419922, 0],[68.85083770751953, 231.0411376953125, 0],[68.75480651855469, 230.39633178710938, 0],[68.4529800415039, 229.90243530273438, 0],[67.72586059570312, 229.55946350097656, 0],[66.83411407470703, 229.6417694091797, 0],[66.83411407470703, 229.6280517578125, 0]] ;
var point_infA1int = [[66.83411407470703, 229.6280517578125, -36],[66.09327697753906, 229.97103881835938, -36],[65.7777328491211, 230.5472412109375, -36],[65.64054107666016, 231.2880859375, -36],[65.83261108398438, 231.9466094970703, -36],[66.13443756103516, 232.23471069335938, -36],[66.6969223022461, 232.59140014648438, -36],[67.71214294433594, 232.6188507080078, -36],[68.43926239013672, 232.207275390625, -36],[68.68621063232422, 231.6584930419922, -36],[68.85083770751953, 231.0411376953125, -36],[68.75480651855469, 230.39633178710938, -36],[68.4529800415039, 229.90243530273438, -36],[67.72586059570312, 229.55946350097656, -36],[66.83411407470703, 229.6417694091797, -36],[66.83411407470703, 229.6280517578125, -30]];
var micA1int = generateMicrotubule(point_supA1int,point_infA1int);

var volume = BEZIER (S2)([micA1ext,micA1int]);
var volumeMap_microtubeA1 =  COLOR(mattAquaMarine)(MAP(volume)(domain3));
DRAW (volumeMap_microtubeA1);

//Microtubule  A2
var volumeMap_microtubeA2 = T([0,1])([3.8,-2])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeA2);
//Microtubule  A3
var volumeMap_microtubeA3 = T([0,1])([7.8,-3.2])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeA3);

//Microtubule triplet B

//Microtubule  b1
var volumeMap_microtubeB1 = T([0,1])([16.2,-8])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeB1);
//Microtubule B2
var volumeMap_microtubeB2 = T([0,1])([18,-11.8])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeB2);
//Microtubule B3
var volumeMap_microtubeB3 = T([0,1])([19,-15.8])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeB3);

//Microtubule triplet C

//Microtubule  C1
var volumeMap_microtubeC1 = T([0,1])([22,-22])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeC1);
//Microtubule C2
var volumeMap_microtubeC2 = T([0,1])([19.9,-25])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeC2);
//Microtubule C3
var volumeMap_microtubeC3 = T([0,1])([17.8,-28])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeC3);


//Microtubule triplet D

//Microtubule D1
var volumeMap_microtubeD1 = T([0,1])([17.5,-36])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeD1);
//Microtubule D2
var volumeMap_microtubeD2 = T([0,1])([13.9,-38])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeD2);
//Microtubule D3
var volumeMap_microtubeD3 = T([0,1])([10.5,-40])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeD3);


//Microtubule triplet E

//Microtubule E1
var volumeMap_microtubeE1 = T([0,1])([4,-48])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeE1);
//Microtubule E2
var volumeMap_microtubeE2 = T([0,1])([0.5,-47])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeE2);
//Microtubule E3
var volumeMap_microtubeE3 = T([0,1])([-3.5,-46])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeE3);

//Microtubule triplet F

//Microtubule F1
var volumeMap_microtubeF1 = T([0,1])([-15,-44])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeF1);
//Microtubule F2
var volumeMap_microtubeF2 = T([0,1])([-17,-41])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeF2);
//Microtubule F3
var volumeMap_microtubeF3 = T([0,1])([-18.5,-38])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeF3);

//Microtubule triplet G

//Microtubule G1
var volumeMap_microtubeG1 = T([0,1])([-26,-33])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeG1);
//Microtubule G2
var volumeMap_microtubeG2 = T([0,1])([-25,-29])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeG2);
//Microtubule G3
var volumeMap_microtubeG3 = T([0,1])([-24,-25])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeG3);

//Microtubule triplet H
//Microtubule H1
var volumeMap_microtubeH1 = T([0,1])([-25,-17])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeH1);
//Microtubule H2
var volumeMap_microtubeH2 = T([0,1])([-22,-14])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeH2);
//Microtubule H3
var volumeMap_microtubeH3 = T([0,1])([-19,-11])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeH3);

//Microtubule triplet I
//Microtubule I1
var volumeMap_microtubeI1 = T([0,1])([-15,-5])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeI1);
//Microtubule I2
var volumeMap_microtubeI2 = T([0,1])([-11,-4])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeI2);
//Microtubule I3
var volumeMap_microtubeI3 = T([0,1])([-7,-3])(volumeMap_microtubeA1)
DRAW (volumeMap_microtubeI3);

/* This function generates and draws a set of parallel lines. It takes in input an array of control points.  
 
   INPUT - An array of control points.

*/
function replicaPoly(p1){
  
var p2 = p1.map(function (p) {return [p[0], p[1], p[2]-4]});
var p3 = p2.map(function (p) {return [p[0], p[1], p[2]-4]});
var p4 = p3.map(function (p) {return [p[0], p[1], p[2]-4]});
var p5 = p4.map(function (p) {return [p[0], p[1], p[2]-4]});
var p6 = p5.map(function (p) {return [p[0], p[1], p[2]-4]});
var p7 = p6.map(function (p) {return [p[0], p[1], p[2]-4]});
var p8 = p7.map(function (p) {return [p[0], p[1], p[2]-4]});

var poly1 = POLYLINE(p1);
var poly2 = POLYLINE(p2);
var poly3 = POLYLINE(p3);
var poly4 = POLYLINE(p4);
var poly5 = POLYLINE(p5);
var poly6 = POLYLINE(p6);
var poly7 = POLYLINE(p7);
var poly8 = POLYLINE(p8);
var str_poly =STRUCT([poly1,poly2,poly3,poly4,poly5,poly6,poly7,poly8]);
DRAW(str_poly);
}

//Protein arms I-A
var p1 = [[61.995713806152344, 228.00794982910156, -4],[65.21707000732422, 231.3988037109375, -4]];
replicaPoly(p1);
//Protein arms A-B
var p1 =[[81.97642364501953,224.37355041503906, -4],[76.81997680664062,227.64761352539062,-4]];
replicaPoly(p1);
// Protein arms B-C
var p1 = [[88.78474426269531, 210.5489959716797, -4],[86.69847106933594, 213.36883544921875, -4]];
replicaPoly(p1);
//Protein arms C-D
var p1 = [[83.73897552490234, 202.5671691894531, -4],[86.25423431396484, 196.0900573730469, -4]];
replicaPoly(p1);
//Protein arms D-E
var p1 = [[73.15452194213867, 183.1868591308594, -4],[75.99959945678711, 190.78076171875, -4]];
replicaPoly(p1);
//Protein arms E-F
var p1 = [[62.15452194213867, 185.1868591308594, -4],[53.49959945678711, 185.78076171875, -4]];
replicaPoly(p1);
//Protein arms F-G
var p1 = [[47.03483200073242, 193.01904296875, -4],[43.19974136352539, 196.81597900390625, -4]];
replicaPoly(p1);
//Protein arms G-H
var p1 = [[42.184486389160156, 212.1962890625, -4],[43.076856994628906, 207.9810302734375, -4]];
replicaPoly(p1);
//Protein arms H-I
var p1 = [[50.682125091552734, 225.60711669921875, -4],[49.39280700683594, 220.9674530029297, -4]];
replicaPoly(p1);

/*************************************************************LYSOSOME TO THE LEFT OF THE PAIR OF MITHOCONDRIA**********************************************/

//Outer Control point 
  var cp1 =  [[162.1141815185547, 103.88532257080078, 0],[166.30323791503906, 103.75019073486328, 0],[172.2489776611328, 103.75019073486328, 0],[177.24880981445312, 103.75019073486328, 0]];
  var cp2 =  [[154.4117431640625, 107.93923950195312, 0],[164.00601196289062, 107.80410766601562, -9],[175.2218475341797, 107.80410766601562, -9],[184.14047241210938, 108.07437133789062, 0]];
  var cp3 =  [[149.9524383544922, 111.85802459716797, 0],[162.1141815185547, 111.99315643310547, -16],[176.7082977294922, 111.85802459716797, -16],[189.0051727294922, 112.26341247558594, 0]];
  var cp4 =  [[146.5741729736328, 116.99298858642578, 0],[159.9521026611328, 117.26324462890625, -19],[178.87037658691406, 116.85785675048828, -19],[192.38343811035156, 116.99298858642578, 0]];
  var cp5 =  [[144.27694702148438, 122.80360412597656, 0],[158.60079956054688, 123.07386016845703, -20],[181.302734375, 123.34412384033203, -20],[195.35630798339844, 123.47925567626953, 0]];
  var cp6 =  [[144.27694702148438, 130.77630615234375, 0],[158.46566772460938, 130.64117431640625, -20],[181.302734375, 130.91143798828125, -20],[195.49143981933594, 131.45196533203125, 0]];
  var cp7 =  [[146.7093048095703, 136.9923095703125, 0],[160.49261474609375, 137.2625732421875, -19],[179.00550842285156, 137.938232421875, -19],[192.92396545410156, 139.01927185058594, 0]];
  var cp8 =  [[149.5470428466797, 143.61370849609375, 0],[163.1952362060547, 143.61370849609375, -16],[176.5731658935547, 143.61370849609375, -16],[189.1403045654297, 144.9650115966797, 0]];
  var cp9 =  [[154.276611328125, 147.80276489257812, 0],[165.35731506347656, 148.07302856445312, -9],[173.87054443359375, 148.07302856445312, -9],[184.95126342773438, 148.74867248535156, 0]];
  var cp10 =  [[162.5195770263672, 152.66746520996094, 0],[167.38427734375, 152.66746520996094, 0],[172.7895050048828, 152.53233337402344, 0],[177.24880981445312, 152.26206970214844, 0]];

var volumeOut = createCurveSurface([169.41123962402344, 103.88532257080078, 0],[169.95176696777344, 152.66746520996094, 0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10]);
DRAW(COLOR(mattGold)(MAP(volumeOut)(domain2)));

 //Inner Control point 

  var cp1 =  [[162.5195770263672, 106.45279693603516, 0],[167.5194091796875, 106.45279693603516, 0],[171.84359741210938, 106.58792877197266, 0],[176.97854614257812, 106.58792877197266, 0]];
  var cp2 =  [[154.817138671875, 111.99315643310547, 0],[162.1141815185547, 111.99315643310547, -7],[176.7082977294922, 111.85802459716797, -7],[184.95126342773438, 111.99315643310547, 0]];
  var cp3 =  [[150.3578338623047, 117.39837646484375, 0],[159.9521026611328, 117.26324462890625, -15],[179.54603576660156, 117.53350830078125, -15],[190.08621215820312, 117.80377197265625, 0]];
  var cp4 =  [[147.92547607421875, 123.34412384033203, 0],[159.1413116455078, 123.74951934814453, -18],[181.1676025390625, 124.1549072265625, -18],[192.38343811035156, 124.019775390625, 0]];
  var cp5 =  [[147.92547607421875, 130.91143798828125, 0],[158.46566772460938, 130.64117431640625, -18],[181.302734375, 130.91143798828125, -18],[192.11317443847656, 131.04656982421875, 0]];
  var cp6 =  [[150.0875701904297, 136.7220458984375, 0],[160.49261474609375, 137.2625732421875, -16],[179.00550842285156, 137.938232421875, -16],[189.6808319091797, 138.34361267089844, 0]];
  var cp7 =  [[154.1414794921875, 143.61370849609375, 0],[163.73574829101562, 144.15423583984375, -7],[175.7623748779297, 144.42449951171875, -7],[185.08639526367188, 144.69476318359375, 0]];
  var cp8 =  [[163.0601043701172, 149.28919982910156, 0],[167.2491455078125, 149.42433166503906, 0],[171.9787139892578, 149.42433166503906, 0],[176.1677703857422, 149.42433166503906, 0]];
  
var volumeIn = createCurveSurface([169.81663513183594, 106.45279693603516, 0],[169.54637145996094, 149.28919982910156, 0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8]);
//DRAW(volumeIn);

var lysosome3D = MAP(BEZIER(S2)([volumeIn,volumeOut]))(domain3);
DRAW(COLOR(mattLightYellow)(lysosome3D));

/******************************************************************PAIR OF LYSOSOMES ABOVE THE CENTRIOLE*****************************************************/
//Outer Control point 
  var cp1 =  [[78.77911376953125, 153.96864318847656, 0],[82.96263885498047, 153.9113311767578, 0],[86.5157699584961, 153.85401916503906, 0],[90.98583221435547, 153.85401916503906, 0]];
  var cp2 =  [[74.13711547851562, 156.9486846923828, 0],[81.07145690917969, 156.8340606689453, -8],[88.52156829833984, 156.66213989257812, -8],[94.88282012939453, 156.37559509277344, 0]];
  var cp3 =  [[71.50092315673828, 159.69949340820312, 0],[78.7218017578125, 159.4702606201172, -14],[90.58467864990234, 159.35565185546875, -14],[97.46170043945312, 159.1837158203125, 0]];
  var cp4 =  [[69.89628601074219, 163.0233917236328, 0],[77.1171646118164, 162.96607971191406, -18],[92.36124420166016, 162.5076141357422, -18],[99.52481079101562, 162.45030212402344, 0]];
  var cp5 =  [[69.20858001708984, 166.6338348388672, 0],[76.20022583007812, 166.28997802734375, -20],[93.79395294189453, 166.00343322753906, -20],[100.6136703491211, 165.94613647460938, 0]];
  var cp6 =  [[69.2658920288086, 170.35888671875, 0],[76.14291381835938, 170.1869659423828, -20],[93.73664855957031, 169.78579711914062, -20],[100.7282943725586, 169.5565643310547, 0]];
  var cp7 =  [[70.60904693603516, 174.27346801757812, 0],[77.2890853881836, 174.25587463378906, -18],[92.53316497802734, 173.74009704589844, -18],[99.69673919677734, 173.45355224609375, 0]];
  var cp8 =  [[72.24593353271484, 177.5224609375, 0],[78.60718536376953, 177.57977294921875, -14],[90.8712158203125, 177.4078369140625, -14],[97.86286163330078, 177.12130737304688, 0]];
  var cp9 =  [[74.710205078125, 180.559814453125, 0],[81.01414489746094, 180.6744384765625, -8],[88.57887268066406, 180.559814453125, -8],[94.88282012939453, 180.559814453125, 0]];
  var cp10 =  [[78.95103454589844, 183.4825439453125, 0],[83.07725524902344, 183.53985595703125, 0],[86.34384155273438, 183.59716796875, 0],[90.92852783203125, 183.53985595703125, 0],];

var volumeOut = createCurveSurface([84.84607696533203, 153.96864318847656, 0],[84.74455261230469, 183.4825439453125, 0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10]);
var volumeOutMap=(COLOR(mattGold)(MAP(volumeOut)(domain2)));
DRAW(volumeOutMap);

 //Inner Control point 

  var cp1 =  [[80.1759033203125, 156.49356079101562, 0],[83.32319641113281, 156.49356079101562, 0],[86.77506256103516, 156.49356079101562, 0],[90.83609008789062, 156.49356079101562, 0]];
  var cp2 =  [[76.21640014648438, 160.53933715820312, 0],[81.69878387451172, 160.23475646972656, -6],[87.48574829101562, 160.1332244873047, -6],[93.272705078125, 160.93017578125, 0]];
  var cp3 =  [[73.67826080322266, 162.88967895507812, 0],[80.1759033203125, 162.68663024902344, -10],[89.00862884521484, 162.48358154296875, -10],[96.21694946289062, 162.1790008544922, 0]];
  var cp4 =  [[73.06910705566406, 166.24002075195312, 0],[78.95759582519531, 166.03697204589844, -14],[90.02388763427734, 165.83392333984375, -14],[97.13067626953125, 165.73239135742188, 0]];
  var cp5 =  [[72.96758270263672, 170.09799194335938, 0],[78.95759582519531, 170.09799194335938, -14],[89.92235565185547, 169.79342651367188, -14],[97.53678131103516, 169.8949432373047, 0]];
  var cp6 =  [[74.49046325683594, 174.0574951171875, 0],[80.1759033203125, 173.8544464111328, -10],[88.9071044921875, 173.44834899902344, -10],[96.623046875, 173.54986572265625, 0]];
  var cp7 =  [[76.82555389404297, 177.50936889648438, 0],[82.00336456298828, 177.2047882080078, -6],[87.79032135009766, 177.2047882080078, -6],[93.78033447265625, 177.103271484375, 0]];
  var cp8 =  [[78.7545394897461, 179.53988647460938, 0],[83.62776947021484, 179.6414031982422, 0],[86.87659454345703, 179.6414031982422, 0],[90.32846069335938, 179.4383544921875, 0]];
  
var volumeIn = createCurveSurface([85.04913330078125, 156.49356079101562, 0],[85.35370635986328, 179.53988647460938, 0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8]);
//DRAW(volumeIn);

var lysosome3D = MAP(BEZIER(S2)([volumeIn,volumeOut]))(domain3);
var lysosome3Dmap=(COLOR(mattLightYellow)(lysosome3D));
DRAW (lysosome3Dmap);

var lysosome3Dstructure = STRUCT ([volumeOutMap,lysosome3Dmap,]);
var lysosome3DstructureT =  T([0,1])([45,23])(lysosome3Dstructure);
DRAW(lysosome3DstructureT);

/********************************************************************LYSOSOME SMALLER ABOVE THE CENTRIOLE******************************************************/
//Outer Control point 
  var cp1 =  [[55.283721923828125, 185.0208282470703, 0],[58.72223663330078, 184.9062042236328, 0],[60.49879837036133, 184.84889221191406, 0],[64.39578247070312, 184.9062042236328, 0]];
  var cp2 =  [[51.44404602050781, 187.31317138671875-1, 0],[56.48720169067383, 187.02662658691406-1, -8],[62.73383331298828, 186.91200256347656-1, -8],[67.71968078613281, 187.02662658691406-1, 0]];
  var cp3 =  [[49.14259719848633, 191.255126953125, 0],[53.33523178100586, 191.21014404296875, -13],[65.54195404052734, 191.2674560546875, -13],[70.52780151367188, 191.2674560546875, 0]];
  var cp4 =  [[48.4640007019043, 194.87789916992188, 0],[52.360984802246094, 194.82058715820312, -14],[67.37582397460938, 194.5913543701172, -14],[70.81433868408203, 194.5913543701172, 0]];
  var cp5 =  [[49.15170669555664, 198.94680786132812, 0],[54.53871154785156, 198.83218383789062, -13],[65.4846420288086, 198.7175750732422, -13],[70.35587310791016, 198.77487182617188, 0]];
  var cp6 =  [[51.673282623291016, 202.84378051757812, 0],[56.716434478759766, 202.90109252929688, -8],[63.13499450683594, 202.90109252929688, -8],[68.6366195678711, 202.84378051757812, 0]];
  var cp7 =  [[56.20065689086914, 205.7665252685547, 0],[59.23801040649414, 205.7665252685547, 0],[60.61341857910156, 205.82383728027344, 0],[63.30691909790039, 205.7665252685547, 0]];
  
var volumeOut = createCurveSurface([59.663516998291016, 183.93405151367188+0.5, 0],[59.93377685546875, 206.635986328125-1, 0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7]);
//DRAW(COLOR(mattGold)(MAP(volumeOut)(domain2)));

 //Inner Control point 

  var cp1 =  [[56.15011978149414, 187.98797607421875, 0],[58.17707824707031, 187.98797607421875, 0],[60.87969207763672, 187.98797607421875, 0],[63.04178237915039, 187.98797607421875, 0]];
  var cp2 =  [[53.042118072509766, 190.96084594726562, 0],[56.28525161743164, 190.82571411132812, -9],[62.636390686035156, 190.69058227539062, -9],[66.55517578125, 190.69058227539062, 0]];
  var cp3 =  [[51.96107482910156, 194.4742431640625, 0],[55.33933639526367, 194.4742431640625, -11],[63.312042236328125, 194.06884765625, -11],[67.90647888183594, 193.9337158203125, 0]];
  var cp4 =  [[52.50159454345703, 198.5281524658203+2, 0],[57.77168655395508, 198.12277221679688+2, -9],[62.09586715698242, 198.12277221679688+2, -9],[67.36595916748047, 198.12277221679688+2, 0]];
  var cp5 =  [[55.60960006713867, 201.23077392578125+2, 0],[58.98786544799805, 201.36590576171875+2, 0],[61.01482391357422, 201.36590576171875+2, 0],[64.3930892944336, 201.23077392578125+2, 0]];
  
var volumeIn = createCurveSurface([59.663516998291016, 187.17718505859375+0.5, 0],[60.06890869140625, 202.1766815185547-1, 0],[cp1,cp2,cp3,cp4]);
//DRAW(volumeIn);

var lysosome3D = MAP(BEZIER(S2)([volumeIn,volumeOut]))(domain3);
var Tlysosome3D = T ([1])([+80])(lysosome3D);
DRAW(COLOR(mattLightYellow)(Tlysosome3D));

/******************************************************************LYSOSOME UNDER BIG MITHOCONDRION***********************************************************/
 //Outer Control point 
  var cp1 =  [[117.40863800048828,  481.0681457519531-1,  0],[120.78690338134766,  481.9330139160156-1,  0],[124.03003692626953,  481.933013916015-1,  0],[127.6785659790039,  481.7978820800781-1,  0]];
  var cp2 =  [[112.67906951904297,  484.1761474609375,  0],[119.43560028076172,  483.50048828125,  -10],[126.05699920654297,  483.50048828125,  -10],[132.4081268310547,  483.230224609375,  0]];
  var cp3 =  [[110.38185119628906,  486.6084899902344,  0],[117.27350616455078,  486.4733581542969,  -11],[127.81369018554688,  486.3382263183594,  -11],[134.97561645507812,  485.9328308105469,  0]];
  var cp4 =  [[108.08462524414062,  490.12188720703125,  0],[115.78707122802734,  490.12188720703125,  -15],[129.7055206298828,  489.31109619140625,  -15],[136.73231506347656,  489.04083251953125,  0]];
  var cp5 =  [[107.27384185791016,  493.7704162597656,  0],[115.11141967773438,  493.2298889160156,  -16],[130.5163116455078,  492.5542297363281,  -16],[138.0836181640625,  492.2839660644531,  0]];
  var cp6 =  [[107.27871765136719,  497.689208984375,  0],[115.24655151367188,  497.5540771484375,  -16],[130.1109161376953,  497.148681640625,  -16],[138.6241455078125,  497.0135498046875,  0]];
  var cp7 =  [[108.08950103759766,  501.7431335449219,  0],[116.32759094238281,  501.7431335449219,  -15],[129.5703887939453,  501.6080017089844,  -15],[137.13771057128906,  502.55389404296875,  0]];
  var cp8 =  [[110.24671936035156,  505.2565002441406,  0],[117.40863800048828,  505.6618957519531,  -11],[128.21908569335938,  505.5267639160156,  -11],[135.38101196289062,  505.6618957519531,  0]];
  var cp9 =  [[112.67958923339844,  508.905029296875,  0],[119.16533660888672,  509.0401611328125,  -10],[126.46238708496094,  508.905029296875,  -10],[132.8135223388672,  509.0401611328125,  0]];
  var cp10 =  [[117.67890167236328,  510.796875,  0],[120.78690338134766,  510.796875,  0],[124.16516876220703,  510.796875,  0],[128.08395385742188,  510.6617431640625,  0]];

var volumeOut = createCurveSurface([122.5436019897461, 480.8519592285156+0.5, 0],[122.6787338256836, 511.148193359375-0.5, 0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10]);
DRAW(COLOR(mattGold)(MAP(volumeOut)(domain2)));

 //Inner Control point 

  var cp1 =  [[117.70804595947266,  483.8537902832031+0.5,  0],[120.68287658691406,  483.7774963378906+1,  0],[124.42047882080078,  483.70123291015625+1,  0],[127.70042419433594,  483.70123291015625+1,  0]];
  var cp2 =  [[113.9704360961914,  486.52349853515625,  0],[118.9284896850586,  486.44720458984375,  -8],[126.17487335205078,  486.1421203613281,  -8],[130.8278045654297,  486.0658264160156,  0]];
  var cp3 =  [[111.30072021484375,  490.1085510253906,  0],[117.25038146972656,  489.87969970703125,  -13],[127.92926025390625,  489.42205810546875,  -13],[134.18402099609375,  489.42205810546875,  0]];
  var cp4 =  [[110.38538360595703,  493.38848876953125,  0],[115.11141967773438,  493.2298889160156,  -14],[129.83619689941406,  492.85455322265625,  -14],[135.63330078125,  492.77825927734375,  0]];
  var cp5 =  [[110.38538360595703,  497.5837707519531,  0],[115.24655151367188,  497.5540771484375,  -14],[129.83619689941406,  496.9735412597656,  -14],[135.32818603515625,  496.8972473144531,  0]];
  var cp6 =  [[112.36860656738281,  501.62646484375,  0],[117.63176727294922,  501.47393798828125,  -13],[128.31063842773438,  501.2450866699219,  -13],[133.87892150878906,  501.092529296875,  0]];
  var cp7 =  [[114.80949401855469,  504.90643310546875,  0],[119.15731811523438,  505.13525390625,  -8],[126.70881652832031,  505.13525390625,  -8],[130.75152587890625,  504.9826965332031,  0]];
  var cp8 =  [[118.4708251953125,  507.4998474121094,  0],[121.29309844970703,  507.4998474121094,  0],[124.6493148803711,  507.3473205566406,  0],[128.08181762695312,  507.19476318359375,  0]];
  
var volumeIn = createCurveSurface([122.5898208618164,  483.1672668457031+0.5,  0],[123.0474853515625,  508.0338134765625-0.5,  0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8]);
//DRAW(volumeIn);

var lisosome3D = MAP(BEZIER(S2)([volumeIn,volumeOut]))(domain3);
DRAW(COLOR(mattLightYellow)(lisosome3D));

/****************************************************************************LYSOSOME ABOVE BIG MITHOCONDRION******************************************/

 //Outer Control point 
  var cp1 =  [[31.58462142944336, 302.5011901855469-1, 0],[34.16350555419922, 302.5011901855469-1, 0],[36.22661590576172, 302.5011901855469-1, 0],[39.14935302734375, 302.3865661621094-1,  0]];
  var cp2 =  [[28.08880043029785, 304.4496765136719, 0],[32.90271759033203, 304.4496765136719, -8],[37.37278747558594, 304.27777099609375, -8],[42.53055953979492, 304.6216125488281,  0]];
  var cp3 =  [[25.28067970275879, 307.08587646484375, 0],[31.12615394592285, 307.1431884765625, -9],[38.86280822753906, 306.97125244140625, -9],[45.3959846496582, 307.20050048828125,  0]];
  var cp4 =  [[23.160263061523438, 310.23785400390625, 0],[29.979982376098633, 309.89398193359375, -12],[40.12359619140625, 309.5501403808594, -12],[47.11524200439453,  309.9512939453125,  0]];
  var cp5 =  [[22.300634384155273, 313.5044250488281, 0],[28.719194412231445, 313.16058349609375, -13],[41.556312561035156, 312.8740539550781, -13],[48.03218078613281,  313.103271484375,  0]];
  var cp6 =  [[22.47256088256836, 316.7710266113281, 0],[28.661884307861328, 316.4844665527344, -13],[41.49900436401367, 315.9114074707031, -13],[48.37602996826172, 315.9114074707031,  0]];
  var cp7 =  [[23.618730545043945, 319.9230041503906, 0],[29.979982376098633, 319.6364440917969, -12],[40.238216400146484, 319.00604248046875, -12],[47.97487258911133,  318.6622009277344,  0]];
  var cp8 =  [[25.395296096801758, 322.38726806640625, 0],[31.47000503540039, 322.15802001953125, -9],[38.80550003051758, 321.8714904785156, -9],[46.82870101928711, 321.6995544433594,  0]];
  var cp9 =  [[27.74494743347168, 324.9088439941406, 0],[33.2465705871582, 324.7942199707031, -8],[37.143550872802734, 324.6795959472656, -8],[43.39018630981445, 324.45037841796875,  0]];
  var cp10 =  [[31.35538673400879, 327.0865783691406, 0],[34.27812576293945, 327.0292663574219, 0],[36.34123229980469, 327.0292663574219, 0],[38.748191833496094, 326.9719543457031,  0]];

var volumeOut = createCurveSurface([35.19506072998047,  301.9281005859375+0.1,  0],[35.36698532104492,  327.5450439453125-0.5,  0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp10]);
DRAW(COLOR(mattGold)(MAP(volumeOut)(domain2)));

 //Inner Control point 

  var cp1 =  [[31.97028923034668, 305.44268798828125, 0],[34.09070587158203, 305.3853759765625, 0],[36.612281799316406, 305.32806396484375, 0],[39.42040252685547, 305.21343994140625,  0]];
  var cp2 =  [[29.448713302612305, 307.3338623046875, 0],[32.42875671386719, 307.0473327636719, -5],[38.04499816894531, 307.0473327636719, -5],[42.11390686035156, 307.1046447753906,  0]];
  var cp3 =  [[27.21367835998535, 310.0273742675781, 0],[31.339895248413086, 310.0846862792969, -10],[40.05079650878906, 309.56890869140625, -10],[44.005088806152344, 309.45428466796875,  0]];
  var cp4 =  [[26.525976181030273, 313.2366638183594, 0],[29.620637893676758, 313.2366638183594, -11],[41.556312561035156, 312.8740539550781, -11],[45.781654357910156, 312.8927917480469,  0]];
  var cp5 =  [[26.583284378051758, 316.1593933105469, 0],[29.563329696655273, 316.1020812988281, -11],[41.48351287841797, 315.700927734375, -11],[45.6097297668457, 315.64361572265625,  0]];
  var cp6 =  [[27.500221252441406, 318.6236572265625, 0],[30.365650177001953, 318.68096923828125, -10],[40.91042709350586, 318.45172119140625,-10],[45.15126037597656, 318.2225036621094,  0]];
  var cp7 =  [[29.39140510559082, 320.9159851074219, 0],[32.829917907714844, 321.0879211425781, -5],[39.19116973876953, 321.0306091308594, -5],[43.317386627197266, 320.85870361328125,  0]];
  var cp8 =  [[31.74105453491211, 322.9790954589844, 0],[34.721099853515625, 323.0937194824219, 0],[37.58652877807617, 323.0937194824219, 0],[40.56657409667969, 322.9790954589844,  0]];
  
var volumeIn = createCurveSurface([35.294185638427734, 304.9842224121094+0.5, 0],[36.211124420166016, 323.55218505859375-0.5, 0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8]);
//DRAW(volumeIn);

var lysosome3D = MAP(BEZIER(S2)([volumeIn,volumeOut]))(domain3);
DRAW(COLOR(mattLightYellow)(lysosome3D)); 

/************************************************************************ VACUOLE **********************************************************/
//Outer Control point 
  var cp1 =  [[151.8223114013672, 372.81591796875, 0],[154.36044311523438, 372.81591796875, 0],[156.59400939941406, 372.81591796875, 0],[158.82757568359375, 372.81591796875, 0]];
  var cp2 =  [[147.5582275390625, 376.36932373046875, 0],[151.4162139892578, 376.36932373046875, -10],[156.1879119873047, 376.36932373046875, -10],[161.26419067382812, 376.36932373046875, 0]];
  var cp3 =  [[145.22314453125, 380.02423095703125, 0],[149.89332580566406, 379.71966552734375, -14],[156.1879119873047, 379.6181335449219, -14],[161.6702880859375, 379.3135681152344, 0]];
  var cp4 =  [[143.0911102294922, 384.1867980957031, 0],[148.06585693359375, 383.7806701660156, -15],[156.39096069335938, 383.4761047363281, -15],[160.3504638671875, 383.4761047363281, 0]];
  var cp5 =  [[141.16212463378906, 388.8569641113281, 0],[146.13687133789062, 388.45086669921875, -19],[155.27418518066406, 387.9432373046875, -19],[159.03062438964844, 387.9432373046875, 0]];
  var cp6 =  [[140.75601196289062, 392.9179992675781, 0],[145.62924194335938, 392.81646728515625, -20],[154.66502380371094, 392.4103698730469, -20],[158.92910766601562, 392.2073059082031, 0]];
  var cp7 =  [[141.0605926513672, 397.8927307128906, 0],[146.74603271484375, 397.48663330078125, -19],[156.1879119873047, 396.97900390625, -19],[161.5687713623047, 396.5729064941406, 0]];
  var cp8 =  [[142.0758514404297, 402.2583312988281, 0],[147.65975952148438, 401.750732421875, -15],[158.01536560058594, 401.4461364746094, -15],[163.80233764648438, 401.3446044921875, 0]];
  var cp9 =  [[143.39569091796875, 406.3193664550781, 0],[149.69027709960938, 406.0148010253906, -14],[157.71080017089844, 405.5071716308594, -14],[163.7008056640625, 404.89801025390625, 0]];
  var cp10 =  [[146.74603271484375, 409.56817626953125, 0],[152.32994079589844, 409.4666748046875, -10],[156.49249267578125, 409.3651428222656, -10],[162.27944946289062, 409.060546875, 0]];
  var cp11 =  [[149.89332580566406, 412.2078552246094, 0],[153.44671630859375, 412.2078552246094, 0],[155.88333129882812, 412.1063232421875, 0],[159.03062438964844, 412.0047912597656, 0]];

var volumeOut = createCurveSurface([155.57875061035156, 372.00372314453125+0.5, 0],[154.66502380371094, 413.32464599609375-1, 0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9,cp11]);
DRAW(COLOR(mattDarkOrange)(MAP(volumeOut)(domain2)));

 //Inner Control point 
  var cp0 = [[153.1421356201172,374.846435546875,0],[154.66502380371094,375.0494689941406,0],[155.7818145751953,375.1510009765625,0],[157.0001220703125,375.2525329589844,0]]
  var cp1 =  [[151.11163330078125, 376.876953125, 0],[153.04061889648438, 376.97845458984375, -8],[155.1726531982422, 377.0799865722656, -8],[158.01536560058594, 377.38458251953125, 0]];
  var cp2 =  [[148.3704376220703, 380.227294921875, 0],[151.923828125, 379.71966552734375, -9],[154.66502380371094, 379.8211975097656, -9],[158.5229949951172, 379.71966552734375, 0]];
  var cp3 =  [[147.253662109375, 383.57763671875, 0],[150.19790649414062, 383.57763671875, -15],[154.56350708007812, 383.57763671875, -15],[158.3199462890625, 383.57763671875, 0]];
  var cp4 =  [[145.12161254882812, 388.45086669921875, 0],[148.3704376220703, 388.45086669921875, -16],[155.27418518066406, 387.9432373046875, -16],[157.91384887695312, 388.0447692871094, 0]];
  var cp5 =  [[144.0048370361328, 392.9179992675781, 0],[145.62924194335938, 392.81646728515625, -16],[154.66502380371094, 392.4103698730469, -16],[157.91384887695312, 392.2073059082031, 0]];
  var cp6 =  [[144.2078857421875, 397.689697265625, 0],[146.74603271484375, 397.48663330078125, -15],[156.1879119873047, 396.97900390625, -15],[158.72605895996094, 396.87750244140625, 0]];
  var cp7 =  [[144.51246643066406, 401.85223388671875, 0],[147.65975952148438, 401.750732421875, -9],[158.01536560058594, 401.4461364746094, -9],[161.06114196777344, 401.24310302734375, 0]];
  var cp8 =  [[145.62924194335938, 406.1163330078125, 0],[149.69027709960938, 406.0148010253906, -8],[157.71080017089844, 405.5071716308594, -8],[161.4672393798828, 405.20257568359375, 0]];
  var cp9 =  [[148.87806701660156, 409.56817626953125, 0],[152.32994079589844, 409.4666748046875, 0],[156.49249267578125, 409.3651428222656, 0],[160.1474151611328, 409.26361083984375, 0]];

var volumeIn = createCurveSurface([155.1726531982422-1,374.4403381347656+1.5,0],[154.66502380371094, 410.27886962890625, 0],[cp1,cp2,cp3,cp4,cp5,cp6,cp7,cp8,cp9]);
//DRAW(volumeIn);

var vacuole3D = MAP(BEZIER(S2)([volumeIn,volumeOut]))(domain3);
DRAW(COLOR(mattOrange)(vacuole3D));



/********************************************************************* NUCLEOLUS ******************************************************************/
var nucleolus = BEZIER(S0)([[0,0,0],[30,0,0],[30,0,45],[0,0,45]]);
//var curve0 = MAP(nucleolus)(domain1);
var mapping = ROTATIONAL_SURFACE(nucleolus);
var nucleolusMap = COLOR(mattLightSeaGreen) (T([0,1,2])([280,297,-25]) ((MAP(mapping)(domainCircle))));
DRAW (nucleolusMap)


/********************************************************************* NUCLEUS ******************************************************************/
var nucleus = BEZIER(S0)([[0,0,0],[65,0,0],[65,0,97.5],[0,0,97.5]]);
//var curve0 = MAP(nucleus)(domain1);
var mapping = ROTATIONAL_SURFACE(nucleus);
var nucleusMap = COLOR(mattDarkSeaGreen) (T([0,1,2])([280,297,-60]) ((MAP(mapping)(domainCircle))));
 DRAW (nucleusMap)


 //---------------------------------------------------------------ROUGH ENDOPLASMATIC RETICULUM PART 1 DX-----------------------------------------------------------------------


var controlsUpper = [[187.6236114501953, 248.28280639648438, 0],[187.6236114501953, 248.28280639648438, 0],[190.86106872558594, 249.18209838867188, 0],[194.81796264648438, 248.46266174316406, 0],[198.055419921875, 246.12449645996094, 0],[200.75331115722656, 243.78634643554688, 0],[204.35047912597656, 240.00930786132812, 0],[206.6886444091797, 237.31141662597656, 0],[208.84695434570312, 234.97325134277344, 0],[211.90455627441406, 233.71424865722656, 0],[213.88299560546875, 235.1531219482422, 0],[211.90455627441406, 237.8509979248047, 0],[207.2282257080078, 241.62803649902344, 0],[202.01231384277344, 245.76478576660156, 0],[200.93316650390625, 249.7216796875, 0],[202.55189514160156, 253.1389923095703, 0],[206.3289337158203, 255.6570281982422, 0],[212.08441162109375, 256.0167236328125, 0],[215.32186889648438, 254.93759155273438, 0],[218.19961547851562, 253.49871826171875, 0],[220.89749145507812, 251.3404083251953, 0],[223.41551208496094, 249.7216796875, 0],[225.76597595214844, 247.8705596923828, 0],[227.37240600585938, 246.48422241210938, 0],[229.52243041992188, 244.41868591308594, 0],[231.68902587890625, 242.52732849121094, 0],[233.84732055664062, 240.3690185546875, 0],[237.4445037841797, 237.13156127929688, 0],[239.57347106933594, 234.976806640625, 0],[243.0253448486328, 232.43865966796875, 0],[248.2360382080078, 229.2177734375, 0],[255.43038940429688, 226.5198974609375, 0],[262.21368408203125, 224.11355590820312, 0],[269.99896240234375, 222.92271423339844, 0],[274.49542236328125, 222.20327758789062, 0],[280.79046630859375, 222.20327758789062, 0],[286.9056701660156, 222.3831329345703, 0],[292.4812927246094, 223.28244018554688, 0],[298.9562072753906, 223.64215087890625, 0],[303.9922790527344, 223.64215087890625, 0],[307.9002380371094, 223.19981384277344, 0],[310.03228759765625, 221.06777954101562, 0],[309.8292236328125, 218.52964782714844, 0]];
var nubsUpper = createNubs(controlsUpper);
var nubsUpperMap = MAP(nubsUpper)(domain1);
//DRAW(nubsUpperMap);

var controlsUnder = [[246.97702026367188, 266.8082580566406, -50],[248.4158935546875, 265.9089660644531, -50],[249.1353302001953, 265.0096740722656, -50],[249.85476684570312, 263.75067138671875, -50],[251.47349548339844, 262.85137939453125, -50],[252.37278747558594, 261.772216796875, -50],[254.17137145996094, 261.05279541015625, -50],[255.79010009765625, 260.69305419921875, -50],[256.68939208984375, 261.2326354980469, -50],[256.8692626953125, 262.1319274902344, -50],[255.79010009765625, 263.3909606933594, -50],[254.53109741210938, 264.829833984375, -50],[253.45193481445312, 266.44854736328125, -50],[253.45193481445312, 267.34783935546875, -50],[253.45193481445312, 268.24713134765625, -50],[253.6317901611328, 268.7867126464844, -50],[254.53109741210938, 268.9665832519531, -50],[256.5095520019531, 268.24713134765625, -50],[258.48797607421875, 266.8082580566406, -50],[260.28656005859375, 266.2686767578125, -50],[261.36572265625, 265.0096740722656, -50],[262.9844665527344, 263.9305114746094, -50],[264.6031799316406, 262.85137939453125, -50],[265.8621826171875, 261.772216796875, -50],[267.3010559082031, 260.69305419921875, -50],[269.4593811035156, 259.25421142578125, -50],[271.9773864746094, 258.5347595214844, -50],[274.8551330566406, 257.4555969238281, -50],[277.19329833984375, 257.2757568359375, -50],[280.4307556152344, 256.9160461425781, -50],[282.7689208984375, 256.9160461425781, -50],[284.5675048828125, 256.9160461425781, -50],[286.3660888671875, 256.9160461425781, -50],[287.9848327636719, 256.7361755371094, -50],[289.4237060546875, 256.0167236328125, -50],[289.9632873535156, 255.29730224609375, -50],[289.7834167480469, 253.67857360839844, -50],[289.6035461425781, 253.31886291503906, -50],[289.0639953613281, 252.95913696289062, -50],[288.1647033691406, 252.59942626953125, -50]];
var nubsUnder = createNubs(controlsUnder);
var Dx1 = nubsUnder;
var nubsUnderMap = MAP(nubsUnder)(domain1);
//DRAW(nubsUnderMap);


var pointsLateral1 = [[187.6236114501953, 248.28280639648438, 0],[217,249,-40],[247,251,-48],[246.97702026367188, 266.8082580566406, -50]];
var bLateral1 = BEZIER(S1)(pointsLateral1);

//var bLateral10 = BEZIER(S0)(pointsLateral1);
//var bLateral10Map = MAP(bLateral10)(domain1);
//DRAW(bLateral10Map);


var pointsLateral2 = [[309.8292236328125, 218.52964782714844, 0],[300,230,-40],[295,240,-48],[288.1647033691406, 252.59942626953125, -50]];
var bLateral2 = BEZIER(S1)(pointsLateral2);
var bL1Dx = bLateral1;
var bL2Dx = bLateral2;
//var bLateral20 = BEZIER(S0)(pointsLateralDx2);
//var bLateral20Map = MAP(bLateral20)(domain1);
//DRAW(bLateral20Map);

var volumeRerPart1Dx = MAP(COONS_PATCH([nubsUpper,nubsUnder,bLateral1,bLateral2]))(domain2);
DRAW(COLOR(mattDarkOrchid)(volumeRerPart1Dx));

//Boundary 

var controlsIntDx = [[188.94554138183594, 246.1443328857422, 0],[191.82327270507812, 246.1443328857422, 0],[194.16143798828125, 245.42489624023438, 0],[195.9600372314453, 243.98602294921875, 0],[197.9384765625, 242.18743896484375, 0],[200.27664184570312, 240.38885498046875, 0],[202.07522583007812, 238.410400390625, 0],[204.59324645996094, 236.25210571289062, 0],[206.75155639648438, 233.55421447753906, 0],[209.0897216796875, 232.2952117919922, 0],[212.5070343017578, 230.85633850097656, 0],[215.56463623046875, 231.03619384765625, 0],[217.3632354736328, 233.73406982421875, 0],[217.3632354736328, 235.7125244140625, 0],[215.20492553710938, 238.410400390625, 0],[212.14732360839844, 240.74856567382812, 0],[209.2695770263672, 242.72702026367188, 0],[206.93141174316406, 244.70545959472656, 0],[204.23353576660156, 247.22348022460938, 0],[203.8738250732422, 249.92137145996094, 0],[206.2119903564453, 251.71995544433594, 0],[208.55014038085938, 251.89981079101562, 0],[211.96746826171875, 252.07968139648438, 0],[216.10421752929688, 250.10122680664062, 0],[219.1618194580078, 248.662353515625, 0],[222.7589874267578, 244.88531494140625, 0],[226.1763153076172, 242.36729431152344, 0],[230.3130645751953, 238.94998168945312, 0],[233.0109405517578, 236.61181640625, 0],[238.58656311035156, 232.47506713867188, 0],[243.62261962890625, 229.0577392578125, 0],[247.03993225097656, 226.89944458007812, 0],[252.0759735107422, 225.10084533691406, 0],[257.2919006347656, 222.9425506591797, 0],[263.5869445800781, 221.50367736816406, 0],[268.9826965332031, 220.06480407714844, 0],[273.47918701171875, 219.5252227783203, 0],[278.155517578125, 219.34536743164062, 0],[284.0908508300781, 219.88494873046875, 0],[287.6880187988281, 220.24465942382812, 0],[292.18450927734375, 220.60438537597656, 0],[297.58026123046875, 221.14395141601562, 0],[302.256591796875, 221.14395141601562, 0],[306.3933410644531, 219.88494873046875, 0]];
var nubsIntDx = createNubs(controlsIntDx);
var boundaryDx = BEZIER(S1)([nubsUpper,nubsIntDx]);
var boundaryDxMap= MAP (boundaryDx)(domain2);
DRAW (COLOR(mattLightYellow)(boundaryDxMap));

//---------------------------------------------------------------ROUGH ENDOPLASMATIC RETICULUM PART 1 SX-----------------------------------------------------------------------



var controlsUpper = [[187.6236114501953, 248.28280639648438, 0],[185.10195922851562, 246.90902709960938, 0],[184.02279663085938, 244.03128051757812, 0],[185.461669921875, 241.33340454101562, 0],[186.54083251953125, 239.1750946044922, 0],[189.23870849609375, 237.1966552734375, 0],[191.03729248046875, 235.75778198242188, 0],[193.55531311035156, 233.77932739257812, 0],[193.7351837158203, 231.441162109375, 0],[191.93658447265625, 231.08145141601562, 0],[188.51927185058594, 231.80088806152344, 0],[185.461669921875, 233.41961669921875, 0],[181.32492065429688, 234.49876403808594, 0],[178.62704467773438, 233.23976135253906, 0],[175.74929809570312, 232.1605987548828, 0],[173.05142211914062, 229.28286743164062, 0],[171.97225952148438, 226.2252655029297, 0],[172.5118408203125, 223.16766357421875, 0],[174.67015075683594, 221.0093536376953, 0],[177.7277374267578, 219.5704803466797, 0],[180.60548400878906, 219.03091430664062, 0],[182.9436492919922, 218.85105895996094, 0],[187.44012451171875, 219.5704803466797, 0],[190.13800048828125, 220.64964294433594, 0],[192.65602111816406, 221.72879028320312, 0],[194.8143310546875, 223.88710021972656, 0],[197.15249633789062, 225.86553955078125, 0],[199.49066162109375, 227.30441284179688, 0],[202.5482635498047, 228.7432861328125, 0],[205.0662841796875, 228.9231414794922, 0],[206.8648681640625, 227.30441284179688, 0],[205.0662841796875, 224.24681091308594, 0],[201.6489715576172, 222.08851623535156, 0],[202.18853759765625, 218.13162231445312, 0],[204.8864288330078, 215.9733123779297, 0],[209.02317810058594, 214.1747283935547, 0],[213.87936401367188, 212.19627380371094, 0],[217.8362579345703, 211.83656311035156, 0],[221.07371520996094, 212.01641845703125, 0],[223.7716064453125, 214.1747283935547, 0],[225.21046447753906, 216.6927490234375, 0],[223.41188049316406, 219.93020629882812, 0],[222.33273315429688, 222.80795288085938, 0],[221.97300720214844, 225.68568420410156, 0],[223.59173583984375, 226.58497619628906, 0],[226.2896270751953, 226.40512084960938, 0],[228.44793701171875, 224.06695556640625, 0],[231.68539428710938, 221.54893493652344, 0],[234.38327026367188, 219.5704803466797, 0],[235.6422882080078, 217.23233032226562, 0],[237.26101684570312, 213.81500244140625, 0],[238.6998748779297, 211.6566925048828, 0],[239.95889282226562, 209.49839782714844, 0],[242.11720275878906, 206.6206512451172, 0],[246.0740966796875, 203.20333862304688, 0],[249.31155395507812, 201.22488403320312, 0],[253.62815856933594, 198.88671875, 0],[258.1246337890625, 196.9082794189453, 0],[262.62109375, 196.1888427734375, 0],[267.1175842285156, 197.2679901123047, 0],[269.09600830078125, 199.7860107421875, 0],[268.9161682128906, 202.66375732421875, 0],[267.1175842285156, 206.08106994628906, 0],[263.880126953125, 208.2393798828125, 0],[259.5635070800781, 210.21783447265625, 0],[255.78646850585938, 211.83656311035156, 0],[252.00942993164062, 214.1747283935547, 0],[248.5921173095703, 216.33302307128906, 0],[247.51296997070312, 218.4913330078125, 0],[249.4914093017578, 218.6711883544922, 0],[252.00942993164062, 218.6711883544922, 0],[255.96632385253906, 217.23233032226562, 0],[259.7433776855469, 214.8941650390625, 0],[262.2613830566406, 213.45529174804688, 0],[266.2182922363281, 211.6566925048828, 0],[269.09600830078125, 210.21783447265625, 0],[272.6932067871094, 209.31854248046875, 0],[275.5709533691406, 208.59910583496094, 0],[279.8875427246094, 208.4192352294922, 0],[284.5638732910156, 208.9588165283203, 0],[287.981201171875, 209.49839782714844, 0],[292.65753173828125, 209.67825317382812, 0],[295.175537109375, 210.21783447265625, 0],[298.05328369140625, 211.29698181152344, 0],[300.9310302734375, 212.19627380371094, 0],[305.0677795410156, 213.63514709472656, 0],[307.40594482421875, 214.71429443359375, 0],[308.8448181152344, 217.7718963623047, 0],[309.8292236328125, 218.52964782714844, 0]];
var nubsUpper = createNubs(controlsUpper);
var nubsUpperMap = MAP(nubsUpper)(domain1);
//DRAW(nubsUpperMap);

var controlsUnder = [[246.97702026367188, 266.8082580566406, -60],[245.63967895507812, 266.973876953125, -60],[245.10009765625, 266.6141662597656, -60],[244.74037170410156, 265.8947448730469, -60],[244.9202423095703, 265.17529296875, -60],[245.10009765625, 264.9954528808594, -60],[245.9993896484375, 264.2760009765625, -60],[247.43826293945312, 263.55657958984375, -60],[247.9778289794922, 263.0169982910156, -60],[248.87713623046875, 262.29754638671875, -60],[249.4167022705078, 260.8586730957031, -60],[249.4167022705078, 260.3191223144531, -60],[248.697265625, 260.1392517089844, -60],[247.25840759277344, 260.3191223144531, -60],[245.8195343017578, 261.39825439453125, -60],[245.10009765625, 262.1177062988281, -60],[244.56051635742188, 262.8371276855469, -60],[244.2008056640625, 263.7364196777344, -60],[243.12164306640625, 264.6357116699219, -60],[241.6827850341797, 264.9954528808594, -60],[241.32305908203125, 264.2760009765625, -60],[241.50291442871094, 262.65728759765625, -60],[242.5820770263672, 260.8586730957031, -60],[243.301513671875, 259.779541015625, -60],[244.2008056640625, 259.2399597167969, -60],[244.74037170410156, 258.3406677246094, -60],[244.74037170410156, 257.4413757324219, -60],[243.4813690185547, 256.721923828125, -60],[240.24391174316406, 256.721923828125, -60],[238.98489379882812, 256.721923828125, -60],[237.72589111328125, 256.3622131347656, -60],[237.18630981445312, 255.46292114257812, -60],[237.72589111328125, 254.2039031982422, -60],[238.2654571533203, 253.48446655273438, -60],[239.52447509765625, 253.3046112060547, -60],[241.86264038085938, 253.3046112060547, -60],[243.84107971191406, 254.2039031982422, -60],[244.74037170410156, 255.10321044921875, -60],[245.8195343017578, 256.00250244140625, -60],[247.0785369873047, 256.1823425292969, -60],[247.6181182861328, 256.90179443359375, -60],[249.4167022705078, 256.00250244140625, -60],[249.59657287597656, 255.10321044921875, -60],[249.59657287597656, 253.3046112060547, -60],[249.59657287597656, 251.68588256835938, -60],[250.3159942626953, 249.52757263183594, -60],[251.75486755371094, 248.8081512451172, -60],[253.37359619140625, 248.62828063964844, -60],[254.6326141357422, 248.98800659179688, -60],[254.99232482910156, 250.78659057617188, -60],[253.91317749023438, 252.2254638671875, -60],[253.553466796875, 253.8441925048828, -60],[253.7333221435547, 254.92333984375, -60],[255.89161682128906, 254.7434844970703, -60],[257.33050537109375, 253.66433715820312, -60],[259.4888000488281, 252.2254638671875, -60],[261.4672546386719, 251.1463165283203, -60],[263.4457092285156, 250.06715393066406, -60],[265.0644226074219, 248.98800659179688, -60],[266.5032958984375, 247.90884399414062, -60],[268.3018798828125, 246.82969665527344, -60],[269.7407531738281, 245.93040466308594, -60],[271.8990478515625, 245.3908233642578, -60],[273.5177917480469, 245.03111267089844, -60],[274.5969543457031, 245.03111267089844, -60],[275.3163757324219, 245.03111267089844, -60],[275.3163757324219, 246.2901153564453, -60],[273.6976318359375, 248.8081512451172, -60],[271.5393371582031, 250.06715393066406, -60],[268.3018798828125, 252.0456085205078, -60],[267.22271728515625, 253.48446655273438, -60],[268.6615905761719, 254.38377380371094, -60],[270.999755859375, 253.48446655273438, -60],[273.5177917480469, 252.4053192138672, -60],[275.4962463378906, 251.86573791503906, -60],[277.83441162109375, 251.326171875, -60],[280.1725769042969, 250.78659057617188, -60],[282.33087158203125, 250.78659057617188, -60],[283.5898742675781, 250.78659057617188, -60],[285.2086181640625, 250.78659057617188, -60],[286.2877502441406, 251.1463165283203, -60],[287.1870422363281, 251.86573791503906, -60],[288.1647033691406, 252.59942626953125, -60]];
var nubsUnder = createNubs(controlsUnder);
var Sx1 = nubsUnder;
var nubsUnderMap = MAP(nubsUnder)(domain1);
//DRAW(nubsUnderMap);


var pointsLateral1 = [[187.6236114501953, 248.28280639648438, 0],[217,249,-48],[247,251,-57,8],[246.97702026367188, 266.8082580566406, -60]];
var bLateral1 = BEZIER(S1)(pointsLateral1);

//var bLateral10 = BEZIER(S0)(pointsLateral1);
//var bLateral10Map = MAP(bLateral10)(domain1);
//DRAW(bLateral10Map);


var pointsLateral2 = [[309.8292236328125, 218.52964782714844, 0],[300,230,-48],[295,240,-57,8],[288.1647033691406, 252.59942626953125, -60]];
var bLateral2 = BEZIER(S1)(pointsLateral2);
var bL1Sx = bLateral1;
var bL2Sx = bLateral2;

//var bLateral20 = BEZIER(S0)(pointsLateralDx2);
//var bLateral20Map = MAP(bLateral20)(domain1);
//DRAW(bLateral20Map);

var volumeRerPart1Sx = MAP(COONS_PATCH([nubsUpper,nubsUnder,bLateral1,bLateral2]))(domain2);
DRAW(COLOR(mattDarkOrchid)(volumeRerPart1Sx));


//Boundary 

var controlsIntSx = [[188.94554138183594, 246.05392456054688, 0],[187.7293701171875, 245.51341247558594, 0],[187.323974609375, 243.7567138671875, 0],[187.99961853027344, 242.13514709472656, 0],[189.89144897460938, 240.91896057128906, 0],[190.97250366210938, 239.56765747070312, 0],[192.99945068359375, 238.2163543701172, 0],[194.6210174560547, 236.72991943359375, 0],[195.2966766357422, 234.9732208251953, 0],[195.8372039794922, 233.35165405273438, 0],[195.9723358154297, 231.18955993652344, 0],[194.8912811279297, 229.432861328125, 0],[193.53997802734375, 228.89234924316406, 0],[191.7832794189453, 228.89234924316406, 0],[189.08065795898438, 230.10850524902344, 0],[186.6483154296875, 230.64903259277344, 0],[184.21595764160156, 231.18955993652344, 0],[181.7836151123047, 231.73007202148438, 0],[179.21612548828125, 231.45982360839844, 0],[176.78378295898438, 230.51390075683594, 0],[175.83786010742188, 229.16259765625, 0],[174.75682067871094, 227.13563537597656, 0],[175.02708435058594, 225.37893676757812, 0],[175.56759643554688, 223.4871063232422, 0],[178.1350860595703, 222.27093505859375, 0],[181.2430877685547, 221.4601593017578, 0],[184.62135314941406, 221.4601593017578, 0],[187.45909118652344, 222.67633056640625, 0],[190.5670928955078, 223.8925018310547, 0],[193.13458251953125, 224.97354125976562, 0],[195.70205688476562, 226.86537170410156, 0],[198.40467834472656, 228.892333984375, 0],[200.97215270996094, 230.64903259277344, 0],[203.5396270751953, 231.59494018554688, 0],[207.4584197998047, 230.64903259277344, 0],[208.94485473632812, 228.2166748046875, 0],[208.53945922851562, 224.7032928466797, 0],[206.9178924560547, 222.81146240234375, 0],[205.29632568359375, 221.3250274658203, 0],[205.70172119140625, 219.16293334960938, 0],[207.8638153076172, 217.40623474121094, 0],[210.83668518066406, 215.6495361328125, 0],[213.67442321777344, 214.83876037597656, 0],[217.0526885986328, 214.56849670410156, 0],[219.48504638671875, 215.1090087890625, 0],[221.6471405029297, 216.73057556152344, 0],[221.78225708007812, 219.29806518554688, 0],[219.89044189453125, 222.13580322265625, 0],[219.07965087890625, 224.8384246826172, 0],[219.21478271484375, 227.54103088378906, 0],[220.8363494873047, 229.16259765625, 0],[223.67408752441406, 229.432861328125, 0],[226.2415771484375, 229.2977294921875, 0],[229.48471069335938, 228.351806640625, 0],[232.18731689453125, 225.64920043945312, 0],[235.02505493164062, 222.54119873046875, 0],[237.45741271972656, 219.70346069335938, 0],[239.214111328125, 216.59544372558594, 0],[241.37620544433594, 213.08206176757812, 0],[243.6734161376953, 209.9740447998047, 0],[247.1868133544922, 206.19039916992188, 0],[251.10560607910156, 203.6229248046875, 0],[254.48387145996094, 201.73109436035156, 0],[258.80804443359375, 199.83926391601562, 0],[263.9430236816406, 199.43386840820312, 0],[265.969970703125, 201.19056701660156, 0],[265.429443359375, 204.02830505371094, 0],[261.9160461425781, 206.7309112548828, 0],[257.1864929199219, 209.02813720703125, 0],[252.4569091796875, 212.0010223388672, 0],[246.10577392578125, 215.24415588378906, 0],[243.53829956054688, 219.29806518554688, 0],[245.56524658203125, 222.54119873046875, 0],[248.2678680419922, 222.81146240234375, 0],[252.7271728515625, 221.1898956298828, 0],[257.1864929199219, 219.16293334960938, 0],[262.0511779785156, 217.135986328125, 0],[265.69970703125, 215.514404296875, 0],[270.1590270996094, 213.48745727539062, 0],[275.6993713378906, 211.4604949951172, 0],[280.8343505859375, 211.4604949951172, 0],[287.18548583984375, 212.0010223388672, 0],[292.0501708984375, 212.67666625976562, 0],[297.1851501464844, 213.62258911132812, 0],[301.6444396972656, 214.97389221191406, 0],[305.83349609375, 217.135986328125, 0],[306.3740234375, 219.97372436523438, 0]];
var nubsIntSx = createNubs(controlsIntSx);
var boundarySx = BEZIER(S1)([nubsUpper,nubsIntSx]);
var boundarySxMap= MAP (boundarySx)(domain2);
DRAW (COLOR(mattLightYellow)(boundarySxMap));

var lateralClosure = createBezierS2([bL1Sx, bL1Dx], mattDarkOrchid);
var lateralClosure = createBezierS2([bL2Sx, bL2Dx], mattDarkOrchid);


//---------------------------------------------------------------ROUGH ENDOPLASMATIC RETICULUM PART 3 DX-----------------------------------------------------------------------


var controlsUpper = [[301.860107421875, 199.86654663085938, 0],[301.679931640625, 202.7663116455078, 0],[303.29644775390625, 205.1331787109375, 0],[304.493408203125, 206.56951904296875, 0],[307.4668884277344, 208.3502197265625, 0],[310.23883056640625, 209.44223022460938, 0],[312.1539611816406, 210.160400390625, 0],[315.3858947753906, 211.5990447998047, 0],[319.7514953613281, 212.91888427734375, 0],[323.4053955078125, 213.03311157226562, 0],[326.5174865722656, 213.03311157226562, 0],[328.4326171875, 211.5967559814453, 0],[328.9114074707031, 209.44223022460938, 0],[328.9114074707031, 206.56951904296875, 0],[329.62957763671875, 203.45742797851562, 0],[331.0659484863281, 201.06350708007812, 0],[333.6992492675781, 200.584716796875, 0],[336.3325500488281, 200.584716796875, 0],[339.4446716308594, 201.78167724609375, 0],[342.8993225097656, 204.08615112304688, 0],[346.38702392578125, 206.56951904296875, 0],[350.2173156738281, 209.9210205078125, 0],[352.8488464355469, 212.30972290039062, 0],[355.96270751953125, 214.7088623046875, 0],[359.5535888671875, 217.82095336914062, 0],[363.3838806152344, 220.4542694091797, 0],[366.0171813964844, 222.36940002441406, 0],[369.1292724609375, 222.60879516601562, 0],[371.2838134765625, 221.65122985839844, 0],[373.677734375, 219.01791381835938, 0]];
var nubsUpper = createNubs(controlsUpper);
var Dx3 =nubsUnder;
var nubsUpperMap = MAP(nubsUpper)(domain1);
//DRAW(nubsUpperMap);

var controlsUnder = [[289.5251159667969, 265.2079772949219, -70],[290.7220764160156, 267.3625183105469, -70],[292.63720703125, 268.7988586425781, -70],[294.791748046875, 269.51702880859375, -70],[296.9462585449219, 270.2352294921875, -70],[299.3401794433594, 270.474609375, -70],[301.4947204589844, 270.9533996582031, -70],[304.367431640625, 270.7139892578125, -70],[306.2825622558594, 269.9958190917969, -70],[308.4371032714844, 269.7564392089844, -70],[309.6340637207031, 269.51702880859375, -70],[310.8310241699219, 268.7988586425781, -70],[311.0704040527344, 267.6018981933594, -70],[309.3946533203125, 266.4049377441406, -70],[308.6764831542969, 264.72918701171875, -70],[309.6340637207031, 263.2928466796875, -70],[310.35223388671875, 262.09588623046875, -70],[312.2673645019531, 261.85650634765625, -70],[313.4643249511719, 262.5746765136719, -70],[315.14007568359375, 263.7716369628906, -70],[316.3370361328125, 264.72918701171875, -70],[317.0552062988281, 266.1655578613281, -70],[318.2521667480469, 267.6018981933594, -70],[319.4491271972656, 269.7564392089844, -70],[320.8854675292969, 270.7139892578125, -70],[322.80059814453125, 271.67156982421875, -70],[325.19451904296875, 272.629150390625, -70],[327.58843994140625, 273.82611083984375, -70],[329.50360107421875, 274.5442810058594, -70],[330.93994140625, 274.7836608886719, -70],[332.8550720214844, 274.7836608886719, -70]];
var nubsUnder = createNubs(controlsUnder);
var nubsUnderMap = MAP(nubsUnder)(domain1);
//DRAW(nubsUnderMap);


var pointsLateral1 = [[301.860107421875, 199.86654663085938, 0],[297,221,-60],[293,243,-68],[289.5251159667969, 265.2079772949219, -70]];
var bLateral1 = BEZIER(S1)(pointsLateral1);

//var bLateral10 = BEZIER(S0)(pointsLateral1);
//var bLateral10Map = MAP(bLateral10)(domain1);
//DRAW(bLateral10Map);


var pointsLateral2 = [[373.677734375, 219.01791381835938, 0],[360,237,-60],[347,255,-68],[332.8550720214844, 274.7836608886719, -70]];
var bLateral2 = BEZIER(S1)(pointsLateral2);

//var bLateral20 = BEZIER(S0)(pointsLateralDx2);
//var bLateral20Map = MAP(bLateral20)(domain1);
//DRAW(bLateral20Map);

var volumeRerPart1Dx = MAP(COONS_PATCH([nubsUpper,nubsUnder,bLateral1,bLateral2]))(domain2);
DRAW(COLOR(mattDarkOrchid)(volumeRerPart1Dx));

var bL1Dx = bLateral1;
var bL2Dx = bLateral2;


//Boundary 

var controlsIntDx = reverseR([[369.8474426269531, 216.86338806152344, 0],[368.889892578125, 218.19821166992188, 0],[367.8746337890625, 218.70584106445312, 0],[365.03192138671875, 218.09669494628906, 0],[362.189208984375, 216.16770935058594, 0],[358.2297058105469, 213.426513671875, 0],[355.7930908203125, 211.2944793701172, 0],[353.0518798828125, 208.55328369140625, 0],[348.7878112792969, 205.10140991210938, 0],[344.52374267578125, 202.15716552734375, 0],[341.47796630859375, 200.1266632080078, 0],[336.7062683105469, 198.5022430419922, 0],[333.3559265136719, 198.09613037109375, 0],[330.5132141113281, 198.90834045410156, 0],[328.68572998046875, 200.22817993164062, 0],[327.36590576171875, 202.664794921875, 0],[326.8582763671875, 205.91360473632812, 0],[327.06134033203125, 208.2487030029297, 0],[326.5537109375, 209.46701049804688, 0],[325.1323547363281, 210.1776885986328, 0],[322.69573974609375, 210.27920532226562, 0],[319.64996337890625, 209.97463989257812, 0],[316.0965576171875, 209.2639617919922, 0],[313.6599426269531, 208.1471710205078, 0],[311.22332763671875, 207.1319122314453, 0],[308.380615234375, 205.71055603027344, 0],[307.1623229980469, 204.7968292236328, 0],[306.0455322265625, 203.7815704345703, 0],[305.7409362792969, 202.15716552734375, 0],[305.6394348144531, 200.8373260498047, 0]]);
var nubsIntDx = createNubs(controlsIntDx);
var boundaryDx = BEZIER(S1)([nubsUpper,nubsIntDx]);
var boundaryDxMap= MAP (boundaryDx)(domain2);
DRAW (COLOR(mattLightYellow)(boundaryDxMap));

//---------------------------------------------------------------ROUGH ENDOPLASMATIC RETICULUM PART 3 SX-----------------------------------------------------------------------



var controlsUpper = [[301.860107421875, 199.86654663085938, 0],[302.51763916015625, 198.62460327148438, 0],[304.751220703125, 197.60934448242188, 0],[307.390869140625, 197.5078125, 0],[309.5229187011719, 197.81239318847656, 0],[311.0458068847656, 198.5230712890625, 0],[313.1778259277344, 199.538330078125, 0],[314.80224609375, 200.3505401611328, 0],[316.32513427734375, 201.46731567382812, 0],[318.2541198730469, 202.07647705078125, 0],[320.4876708984375, 201.97494506835938, 0],[321.5029296875, 200.6551055908203, 0],[321.6044616699219, 198.92918395996094, 0],[319.98004150390625, 197.5078125, 0],[318.66021728515625, 195.78189086914062, 0],[317.4419250488281, 193.85289001464844, 0],[317.8480224609375, 191.72085571289062, 0],[319.37091064453125, 190.70559692382812, 0],[321.40142822265625, 189.5888214111328, 0],[324.34564208984375, 189.08119201660156, 0],[326.274658203125, 189.08119201660156, 0],[330.234130859375, 189.6903533935547, 0],[332.0616149902344, 190.19796752929688, 0],[334.3966979980469, 191.0101776123047, 0],[335.9195861816406, 190.29949951171875, 0],[337.2394104003906, 189.28424072265625, 0],[336.5287170410156, 186.4415283203125, 0],[335.7165222167969, 184.51254272460938, 0],[334.7012634277344, 182.075927734375, 0],[334.49822998046875, 180.34999084472656, 0],[335.51348876953125, 179.33473205566406, 0],[338.2546691894531, 178.7255859375, 0],[340.6912841796875, 179.33473205566406, 0],[342.7218017578125, 180.75608825683594, 0],[344.24468994140625, 182.1774444580078, 0],[346.376708984375, 184.00491333007812, 0],[347.89959716796875, 185.32473754882812, 0],[349.72705078125, 187.35525512695312, 0],[350.94537353515625, 189.08119201660156, 0],[352.1636657714844, 191.0101776123047, 0],[352.8743591308594, 192.9391632080078, 0],[352.97589111328125, 195.07119750976562, 0],[352.1636657714844, 196.3910369873047, 0],[350.94537353515625, 197.3047637939453, 0],[349.5240173339844, 198.01544189453125, 0],[349.72705078125, 199.03070068359375, 0],[350.5392761230469, 200.14749145507812, 0],[353.28045654296875, 201.26426696777344, 0],[356.0216369628906, 201.26426696777344, 0],[358.5597839355469, 201.6703643798828, 0],[361.3009948730469, 202.07647705078125, 0],[363.6360778808594, 202.888671875, 0],[365.5650634765625, 204.00546264648438, 0],[366.9864196777344, 205.02072143554688, 0],[369.0169372558594, 206.64512634277344, 0],[370.5398254394531, 208.67564392089844, 0],[371.961181640625, 211.01072692871094, 0],[372.8749084472656, 213.34580993652344, 0],[373.6871032714844, 215.27479553222656, 0],[373.48406982421875, 219.03125, 0]];
var nubsUpper = createNubs(controlsUpper);
var Sx3 =nubsUnder;
var nubsUpperMap = MAP(nubsUpper)(domain1);
//DRAW(nubsUpperMap);

var controlsUnder = [[289.466552734375, 264.0515441894531, -80],[290.3658447265625, 263.5119934082031, -80],[291.44500732421875, 263.3321228027344, -80],[292.7040100097656, 263.3321228027344, -80],[293.6033020019531, 263.3321228027344, -80],[294.14288330078125, 263.5119934082031, -80],[294.5025939941406, 263.8717041015625, -80],[295.2220458984375, 264.59112548828125, -80],[295.94146728515625, 265.1307067871094, -80],[297.2004699707031, 265.49041748046875, -80],[299.1789245605469, 265.6702880859375, -80],[299.718505859375, 265.49041748046875, -80],[299.53863525390625, 264.4112854003906, -80],[298.9990539550781, 263.8717041015625, -80],[298.0997619628906, 263.1522521972656, -80],[297.3803405761719, 262.4328308105469, -80],[296.660888671875, 261.5335388183594, -80],[296.3011779785156, 260.2745361328125, -80],[296.4810485839844, 259.3752136230469, -80],[297.0206298828125, 258.6557922363281, -80],[300.43792724609375, 258.1162109375, -80],[302.0566711425781, 258.1162109375, -80],[303.49554443359375, 258.1162109375, -80],[304.2149658203125, 258.29608154296875, -80],[305.8337097167969, 258.6557922363281, -80],[307.4524230957031, 259.3752136230469, -80],[308.5315856933594, 260.4543762207031, -80],[309.6107482910156, 261.173828125, -80],[310.1502990722656, 261.5335388183594, -80],[311.4093322753906, 261.5335388183594, -80],[312.3086242675781, 260.8140869140625, -80],[312.48846435546875, 259.914794921875, -80],[312.48846435546875, 258.4759216308594, -80],[312.1287536621094, 256.8572082519531, -80],[311.76904296875, 255.2384796142578, -80],[311.76904296875, 254.3391876220703, -80],[312.6683349609375, 252.720458984375, -80],[314.1072082519531, 252.54058837890625, -80],[315.0065002441406, 253.08016967773438, -80],[315.9057922363281, 254.3391876220703, -80],[316.44537353515625, 255.77804565429688, -80],[317.164794921875, 257.5766296386719, -80],[317.7043762207031, 258.6557922363281, -80],[318.0640869140625, 259.7349548339844, -80],[317.8842468261719, 261.3536682128906, -80],[317.8842468261719, 262.972412109375, -80],[317.8842468261719, 264.4112854003906, -80],[318.423828125, 265.6702880859375, -80],[320.04254150390625, 266.0299987792969, -80],[321.4814147949219, 265.6702880859375, -80],[323.10015869140625, 265.49041748046875, -80],[324.89874267578125, 265.3105773925781, -80],[327.0570373535156, 266.0299987792969, -80],[328.67578125, 267.1091613769531, -80],[329.9347839355469, 268.9077453613281, -80],[331.0139465332031, 270.34661865234375, -80],[331.5534973144531, 271.42578125, -80],[332.45281982421875, 271.96533203125, -80],[332.99237060546875, 273.04449462890625, -80],[333.1722412109375, 274.84307861328125, -80]];
var nubsUnder = createNubs(controlsUnder);
var nubsUnderMap = MAP(nubsUnder)(domain1);
//DRAW(nubsUnderMap);


var pointsLateral1 = [[301.860107421875, 199.86654663085938, 0],[297,221,-68.8],[293,243,-77.7],[289.466552734375, 264.0515441894531, -80, -80]];
var bLateral1 = BEZIER(S1)(pointsLateral1);

//var bLateral10 = BEZIER(S0)(pointsLateral1);
//var bLateral10Map = MAP(bLateral10)(domain1);
//DRAW(bLateral10Map);


var pointsLateral2 = [[373.48406982421875, 219.03125, 0],[360,237,-68.8],[347,255,-77.7],[333.1722412109375, 274.84307861328125, -80]];
var bLateral2 = BEZIER(S1)(pointsLateral2);

//var bLateral20 = BEZIER(S0)(pointsLateralDx2);
//var bLateral20Map = MAP(bLateral20)(domain1);
//DRAW(bLateral20Map);

var volumeRerPart1Sx = MAP(COONS_PATCH([nubsUpper,nubsUnder,bLateral1,bLateral2]))(domain2);
DRAW(COLOR(mattDarkOrchid)(volumeRerPart1Sx));
var bL1Sx = bLateral1;
var bL2Sx = bLateral2;


//Boundary 

var controlsIntSx = reverseR([[369.8474426269531, 216.86338806152344, 0],[369.42303466796875, 214.97023010253906, 0],[369.219970703125, 213.34580993652344, 0],[368.5093078613281, 211.82293701171875, 0],[367.5955810546875, 210.90919494628906, 0],[366.1742248535156, 209.89395141601562, 0],[365.1589660644531, 209.18325805664062, 0],[363.02691650390625, 207.2542724609375, 0],[360.7933654785156, 205.62986755371094, 0],[358.2552185058594, 204.31002807617188, 0],[355.4125061035156, 203.8024139404297, 0],[353.28045654296875, 203.59934997558594, 0],[349.8285827636719, 202.6856231689453, 0],[345.9706115722656, 200.24900817871094, 0],[344.54925537109375, 197.10171508789062, 0],[345.3614501953125, 195.47731018066406, 0],[347.59503173828125, 195.57882690429688, 0],[349.21942138671875, 195.1727294921875, 0],[349.5240173339844, 193.9544219970703, 0],[349.0163879394531, 191.72085571289062, 0],[348.0011291503906, 190.19796752929688, 0],[346.1736755371094, 188.5735626220703, 0],[345.3614501953125, 187.2537384033203, 0],[343.83856201171875, 185.52780151367188, 0],[342.8233337402344, 184.6140594482422, 0],[341.0973815917969, 183.0911865234375, 0],[339.87908935546875, 182.58355712890625, 0],[338.7622985839844, 182.38050842285156, 0],[338.356201171875, 182.98965454101562, 0],[338.45770263671875, 183.70033264160156, 0],[338.6607666015625, 184.51254272460938, 0],[339.0668640136719, 185.6293182373047, 0],[339.7775573730469, 187.5583038330078, 0],[340.2851867675781, 189.48728942871094, 0],[340.7928161621094, 191.8223876953125, 0],[339.87908935546875, 193.85289001464844, 0],[338.15313720703125, 194.56358337402344, 0],[334.1936340332031, 193.54832458496094, 0],[332.1631164550781, 192.43153381347656, 0],[330.0310974121094, 192.12696838378906, 0],[326.07159423828125, 191.41627502441406, 0],[324.244140625, 191.51780700683594, 0],[322.9242858886719, 192.0254364013672, 0],[321.9090576171875, 192.63458251953125, 0],[321.6044616699219, 194.157470703125, 0],[321.9090576171875, 195.3757781982422, 0],[322.9242858886719, 196.69561767578125, 0],[323.73651123046875, 198.218505859375, 0],[324.4471740722656, 199.43679809570312, 0],[324.853271484375, 201.97494506835938, 0],[323.2288818359375, 203.7008819580078, 0],[319.2693786621094, 204.41156005859375, 0],[316.02056884765625, 203.49783325195312, 0],[314.0915832519531, 202.6856231689453, 0],[312.4671630859375, 201.8734130859375, 0],[310.3351135253906, 200.6551055908203, 0],[309.1168212890625, 200.3505401611328, 0],[307.6954650878906, 200.24900817871094, 0],[307.1878356933594, 200.14749145507812, 0],[306.78173828125, 200.24900817871094, 0],[305.6394348144531, 200.8373260498047, 0]]);
var nubsIntSx = createNubs(controlsIntSx);
var boundarySx = BEZIER(S1)([nubsUpper,nubsIntSx]);
var boundarySxMap= MAP (boundarySx)(domain2);
DRAW (COLOR(mattLightYellow)(boundarySxMap));

var lateralClosure = createBezierS2([bL1Sx, bL1Dx], mattDarkOrchid);
var lateralClosure = createBezierS2([bL2Sx, bL2Dx], mattDarkOrchid);

//---------------------------------------------------------------ROUGH ENDOPLASMATIC RETICULUM PART 5 DX-----------------------------------------------------------------------


var controlsUpper = [[399.37530517578125, 276.56707763671875, 0],[397.9389343261719, 277.5246276855469, 0],[397.46014404296875, 279.4397888183594, 0],[397.9389343261719, 282.3124694824219, 0],[399.37530517578125, 285.4245910644531, 0],[400.572265625, 289.4942321777344, 0],[401.5298156738281, 293.8033142089844, 0],[402.00860595703125, 297.15478515625, 0],[402.4873962402344, 300.74566650390625, 0],[401.76922607421875, 304.8153381347656, 0],[400.3328552246094, 307.4486389160156, 0],[397.9389343261719, 307.92742919921875, 0],[395.3056335449219, 306.2516784667969, 0],[393.8692626953125, 302.90020751953125, 0],[391.475341796875, 298.11236572265625, 0],[389.5602111816406, 293.0851135253906, 0],[388.3632507324219, 288.53668212890625, 0],[386.6875, 283.74884033203125, 0],[384.5329895019531, 278.7215881347656, 0],[381.899658203125, 273.215576171875, 0],[377.3512268066406, 267.7095642089844, 0],[373.28155517578125, 263.1611022949219, 0],[369.690673828125, 258.1338806152344, 0],[369.9300537109375, 254.064208984375, 0],[373.04217529296875, 251.90968322753906, 0],[377.11181640625, 252.14907836914062, 0],[380.9421081542969, 255.02178955078125, 0],[384.7723693847656, 258.1338806152344, 0],[387.88446044921875, 262.44293212890625, 0],[390.5177917480469, 261.9641418457031, 0]];
var nubsUpper = createNubs(controlsUpper);
var nubsUpperMap = MAP(nubsUpper)(domain1);
//DRAW(nubsUpperMap);

var controlsUnder = [[318.9671325683594, 291.50848388671875, -70],[317.2913818359375, 290.5509338378906, -70],[315.85504150390625, 291.7478942871094, -70],[316.09442138671875, 293.42364501953125, -70],[316.3338317871094, 295.5781555175781, -70],[316.8126220703125, 297.4932861328125, -70],[317.5307922363281, 299.408447265625, -70],[317.5307922363281, 301.08416748046875, -70],[317.2913818359375, 302.99932861328125, -70],[317.052001953125, 304.9144592285156, -70],[316.5732116699219, 307.0689697265625, -70],[315.61566162109375, 309.462890625, -70],[312.9823303222656, 308.984130859375, -70],[311.5459899902344, 307.3083801269531, -70],[310.5884094238281, 304.4356689453125, -70],[310.109619140625, 301.5629577636719, -70],[309.630859375, 298.45086669921875, -70],[309.3914489746094, 295.099365234375, -70],[308.91265869140625, 291.50848388671875, -70],[307.476318359375, 288.1570129394531, -70],[306.03997802734375, 284.8055114746094, -70],[305.0823974609375, 281.69342041015625, -70],[306.7581481933594, 279.5389099121094, -70],[309.8702392578125, 279.5389099121094, -70],[312.0247802734375, 281.9328308105469, -70],[313.70050048828125, 284.3267517089844, -70],[315.3762512207031, 286.9600524902344, -70],[317.052001953125, 286.9600524902344, -70],[318.24896240234375, 285.7630920410156, -70]];
var nubsUnder = createNubs(controlsUnder);
var Dx5 =nubsUnder;
var nubsUnderMap = MAP(nubsUnder)(domain1);
//DRAW(nubsUnderMap);


var pointsLateral1 = [[399.37530517578125, 276.56707763671875, 0],[372,281,-60],[345,286,-68],[318.9671325683594, 291.50848388671875, -70]];
var bLateral1 = BEZIER(S1)(pointsLateral1);

//var bLateral10 = BEZIER(S0)(pointsLateral1);
//var bLateral10Map = MAP(bLateral10)(domain1);
//DRAW(bLateral10Map);


var pointsLateral2 = [[390.5177917480469, 261.9641418457031, 0],[366,269,-60],[342,278,-68],[318.24896240234375, 285.7630920410156, -70]];
var bLateral2 = BEZIER(S1)(pointsLateral2);

//var bLateral20 = BEZIER(S0)(pointsLateralDx2);
//var bLateral20Map = MAP(bLateral20)(domain1);
//DRAW(bLateral20Map);

var volumeRerPart1Dx = MAP(COONS_PATCH([nubsUpper,nubsUnder,bLateral1,bLateral2]))(domain2);
DRAW(COLOR(mattDarkOrchid)(volumeRerPart1Dx));
var bL1Dx = bLateral1;
var bL2Dx = bLateral2;


//Boundary 

var controlsIntDx = reverseR([[392.2210693359375, 264.69659423828125, 0],[389.8271484375, 266.8511047363281, 0],[386.7150573730469, 265.17535400390625, 0],[384.0817565917969, 262.0632629394531, 0],[380.25146484375, 257.9936218261719, 0],[377.6181640625, 255.36029052734375, 0],[374.7454528808594, 254.8815155029297, 0],[374.02728271484375, 257.0360412597656, 0],[375.2242431640625, 259.90875244140625, 0],[378.57574462890625, 264.2178039550781, 0],[383.60296630859375, 269.96319580078125, 0],[385.75750732421875, 275.2298278808594, 0],[389.5877685546875, 282.4115905761719, 0],[390.78472900390625, 287.4388427734375, 0],[391.981689453125, 292.466064453125, 0],[393.6574401855469, 297.4932861328125, 0],[395.57257080078125, 301.8023681640625, 0],[397.2483215332031, 303.7174987792969, 0],[399.1634521484375, 303.23870849609375, 0],[399.8816223144531, 300.3659973144531, 0],[398.924072265625, 296.7751159667969, 0],[397.96649169921875, 292.9448547363281, 0],[397.0089111328125, 289.11456298828125, 0],[396.2907409667969, 285.523681640625, 0],[394.8544006347656, 281.69342041015625, 0],[394.8544006347656, 278.8207092285156, 0],[395.0937805175781, 276.1874084472656, 0],[397.4877014160156, 273.7934875488281, 0]]);
var nubsIntDx = createNubs(controlsIntDx);
var boundaryDx = BEZIER(S1)([nubsUpper,nubsIntDx]);
var boundaryDxMap= MAP (boundaryDx)(domain2);
DRAW (COLOR(mattLightYellow)(boundaryDxMap));

//---------------------------------------------------------------ROUGH ENDOPLASMATIC RETICULUM PART 5 SX-----------------------------------------------------------------------



var controlsUpper = [[399.37530517578125, 276.56707763671875, 0],[402.27557373046875, 277.3843688964844, 0],[405.1482849121094, 280.9752502441406, 0],[406.3452453613281, 285.2843017578125, 0],[406.8240051269531, 290.5509338378906, 0],[406.1058349609375, 297.0145263671875, 0],[405.3876647949219, 304.1962890625, 0],[405.3876647949219, 309.94171142578125, 0],[406.1058349609375, 316.6446838378906, 0],[408.499755859375, 320.71435546875, 0],[412.5694274902344, 322.15069580078125, 0],[416.1603088378906, 321.6719055175781, 0],[419.7511901855469, 319.2779846191406, 0],[421.42694091796875, 316.6446838378906, 0],[422.6239013671875, 312.57501220703125, 0],[422.86328125, 307.0690002441406, 0],[421.9057312011719, 298.21148681640625, 0],[420.22998046875, 290.0721435546875, 0],[417.5966491699219, 282.41162109375, 0],[413.28759765625, 273.7934875488281, 0],[409.2179260253906, 264.45721435546875, 0],[405.6270446777344, 258.7117919921875, 0],[401.3179931640625, 251.76942443847656, 0],[397.2483215332031, 245.0664520263672, 0],[394.13623046875, 239.5604248046875, 0],[388.8695983886719, 233.0968475341797, 0],[385.0393371582031, 228.78778076171875, 0],[380.2514953613281, 227.3514404296875, 0],[376.8999938964844, 230.22413635253906, 0],[376.6606140136719, 234.05441284179688, 0],[379.5333251953125, 240.2786102294922, 0],[382.4060363769531, 243.86949157714844, 0],[384.560546875, 247.93914794921875, 0],[386.715087890625, 252.2482147216797, 0],[388.8695983886719, 255.3603057861328, 0],[390.30596923828125, 259.1905822753906, 0],[390.5177917480469, 261.9641418457031, 0]];
var nubsUpper = createNubs(controlsUpper);
var nubsUpperMap = MAP(nubsUpper)(domain1);
//DRAW(nubsUpperMap);

var controlsUnder = [[318.9671325683594, 291.50848388671875, -80],[323.28936767578125, 291.9063415527344, -80],[324.54840087890625, 294.96392822265625, -80],[325.8074035644531, 297.4819641113281, -80],[325.6275329589844, 300.1798400878906, -80],[324.3685302734375, 302.51800537109375, -80],[323.28936767578125, 306.1152038574219, -80],[323.28936767578125, 310.79150390625, -80],[325.44769287109375, 313.66925048828125, -80],[328.864990234375, 313.3095397949219, -80],[330.4837341308594, 311.5109558105469, -80],[331.74273681640625, 308.27349853515625, -80],[332.8218994140625, 304.4964599609375, -80],[333.3614807128906, 300, -80],[332.8218994140625, 295.8632507324219, -80],[331.922607421875, 291.0070495605469, -80],[330.6636047363281, 286.5105895996094, -80],[329.4045715332031, 283.27313232421875, -80],[328.325439453125, 279.31622314453125, -80],[327.1064453125, 275.2298583984375, -80],[326.1671142578125, 273.02117919921875, -80],[325.6275329589844, 270.3232727050781, -80],[324.7282409667969, 267.985107421875, -80],[323.8289489746094, 265.46710205078125, -80],[322.0303649902344, 263.1289367675781, -80],[320.2317810058594, 262.76922607421875, -80],[317.7137451171875, 263.8483581542969, -80],[317.89361572265625, 266.0066833496094, -80],[318.4331970214844, 268.3448486328125, -80],[319.69219970703125, 270.3232727050781, -80],[320.0519104003906, 272.3017272949219, -80],[320.4116516113281, 274.81976318359375, -80],[320.9512023925781, 276.7982177734375, -80],[320.9512023925781, 278.7766418457031, -80],[320.9512023925781, 281.11480712890625, -80],[320.59149169921875, 282.91339111328125, -80],[318.24896240234375, 285.7630920410156, -80]];
var nubsUnder = createNubs(controlsUnder);
var Sx5 =nubsUnder;
var nubsUnderMap = MAP(nubsUnder)(domain1);
//DRAW(nubsUnderMap);


var pointsLateral1 = [[399.37530517578125, 276.56707763671875, 0],[372,281,-68.6],[345,286,-77.7],[318.9671325683594, 291.50848388671875, -80]];
var bLateral1 = BEZIER(S1)(pointsLateral1);

//var bLateral10 = BEZIER(S0)(pointsLateral1);
//var bLateral10Map = MAP(bLateral10)(domain1);
//DRAW(bLateral10Map);


var pointsLateral2 = [[390.5177917480469, 261.9641418457031, 0],[366,269,-68.6],[342,278,-77.7],[318.24896240234375, 285.7630920410156, -80]];
var bLateral2 = BEZIER(S1)(pointsLateral2);

//var bLateral20 = BEZIER(S0)(pointsLateralDx2);
//var bLateral20Map = MAP(bLateral20)(domain1);
//DRAW(bLateral20Map);

var volumeRerPart1Sx = MAP(COONS_PATCH([nubsUpper,nubsUnder,bLateral1,bLateral2]))(domain2);
DRAW(COLOR(mattDarkOrchid)(volumeRerPart1Sx));
var bL1Sx = bLateral1;
var bL2Sx = bLateral2;


//Boundary 

var controlsIntSx = reverseR([[392.4604797363281, 263.739013671875, 0],[393.1786804199219, 260.14813232421875, 0],[391.9817199707031, 254.40274047851562, 0],[389.8271789550781, 251.76942443847656, 0],[387.1938781738281, 248.1785430908203, 0],[384.7999572753906, 243.3907012939453, 0],[381.92724609375, 239.79981994628906, 0],[379.5333251953125, 234.53318786621094, 0],[379.772705078125, 232.378662109375, 0],[380.4908752441406, 230.7029266357422, 0],[383.8423767089844, 230.7029266357422, 0],[386.2362976074219, 235.01197814941406, 0],[390.54534912109375, 240.5179901123047, 0],[394.3756408691406, 245.7846221923828, 0],[398.924072265625, 252.4875946044922, 0],[402.27557373046875, 259.1905822753906, 0],[406.5846252441406, 264.69659423828125, 0],[411.3724670410156, 274.27227783203125, 0],[415.2027282714844, 282.6510009765625, 0],[418.075439453125, 290.5509338378906, 0],[419.27239990234375, 298.6902770996094, 0],[419.7511901855469, 306.82958984375, 0],[419.7511901855469, 312.0962219238281, 0],[419.03302001953125, 314.2507629394531, 0],[417.8360595703125, 315.6871032714844, 0],[415.9209289550781, 317.36285400390625, 0],[412.5694274902344, 317.36285400390625, 0],[410.1755065917969, 316.8840637207031, 0],[408.7391662597656, 314.72955322265625, 0],[407.7815856933594, 310.42047119140625, 0],[407.5422058105469, 304.9144592285156, 0],[409.69671630859375, 297.7326965332031, 0],[409.45733642578125, 290.3115539550781, 0],[409.2179260253906, 284.3267517089844, 0],[407.5422058105469, 280.0177001953125, 0],[402.51495361328125, 274.7510681152344, 0],[397.9665222167969, 273.7934875488281, 0]]);
var nubsIntSx = createNubs(controlsIntSx);
var boundarySx = BEZIER(S1)([nubsUpper,nubsIntSx]);
var boundarySxMap= MAP (boundarySx)(domain2);
DRAW (COLOR(mattLightYellow)(boundarySxMap));

var lateralClosure = createBezierS2([bL1Sx, bL1Dx], mattDarkOrchid);
var lateralClosure = createBezierS2([bL2Sx, bL2Dx], mattDarkOrchid);

//---------------------------------------------------------------ROUGH ENDOPLASMATIC RETICULUM PART 7 DX-----------------------------------------------------------------------


var controlsUpper = [[240.6220245361328, 391.0994873046875, 0],[243.49473571777344, 388.2267761230469, 0],[249.24014282226562, 387.98736572265625, 0],[253.07041931152344, 389.4237365722656, 0],[257.14007568359375, 391.0994873046875, 0],[260.4915771484375, 391.5782470703125, 0],[264.08245849609375, 392.29644775390625, 0],[268.1521301269531, 393.0146179199219, 0],[271.50360107421875, 393.2539978027344, 0],[274.6156921386719, 393.0146179199219, 0],[274.8551025390625, 391.3388671875, 0],[272.7005615234375, 389.6631164550781, 0],[268.87030029296875, 388.9449462890625, 0],[264.5612487792969, 388.70556640625, 0],[260.9703674316406, 387.50860595703125, 0],[257.8582458496094, 385.59344482421875, 0],[254.50677490234375, 383.917724609375, 0],[252.5916290283203, 381.2843933105469, 0],[251.63406372070312, 376.7359619140625, 0],[253.07041931152344, 373.8632507324219, 0],[256.90069580078125, 372.6662902832031, 0],[262.1673278808594, 373.14508056640625, 0],[267.9127197265625, 373.38446044921875, 0],[273.4187316894531, 374.1026306152344, 0],[278.9247741699219, 374.1026306152344, 0],[285.3883361816406, 374.342041015625, 0],[291.1337585449219, 374.82080078125, 0],[296.400390625, 373.14508056640625, 0],[300.4700622558594, 373.14508056640625, 0],[305.7366638183594, 374.342041015625, 0],[309.3275451660156, 375.77838134765625, 0],[310.5245056152344, 378.6510925292969, 0],[310.0457458496094, 381.0450134277344, 0],[307.8912048339844, 384.396484375, 0],[300.4700622558594, 386.3116455078125, 0],[293.04888916015625, 387.0298156738281, 0],[288.02166748046875, 387.98736572265625, 0],[285.1489562988281, 389.4237365722656, 0],[284.670166015625, 391.5782470703125, 0],[288.02166748046875, 393.0146179199219, 0],[293.7670593261719, 393.0146179199219, 0],[302.8639831542969, 393.7327880859375, 0]];
var nubsUpper = createNubs(controlsUpper);
var nubsUpperMap = MAP(nubsUpper)(domain1);
//DRAW(nubsUpperMap);

var controlsUnder = [[264.7491455078125, 324.7549133300781, -50],[266.1855163574219, 322.1216125488281, -50],[268.5794372558594, 322.1216125488281, -50],[270.2551574707031, 323.07916259765625, -50],[271.6915283203125, 324.276123046875, -50],[274.5642395019531, 325.7124938964844, -50],[276.9581604003906, 326.4306640625, -50],[279.3520812988281, 327.3882141113281, -50],[282.9429626464844, 327.86700439453125, -50],[283.9005126953125, 326.6700439453125, -50],[283.4217224121094, 324.276123046875, -50],[281.0278015136719, 323.5579528808594, -50],[278.1551208496094, 323.3185729980469, -50],[274.3248291015625, 321.8822021484375, -50],[271.4521179199219, 320.44586181640625, -50],[269.5369873046875, 318.29132080078125, -50],[269.5369873046875, 315.89739990234375, -50],[271.930908203125, 314.9398498535156, -50],[274.8036193847656, 315.1792297363281, -50],[278.873291015625, 315.65802001953125, -50],[281.506591796875, 315.65802001953125, -50],[286.0550537109375, 315.65802001953125, -50],[290.3641052246094, 316.1368103027344, -50],[293.4761962890625, 316.1368103027344, -50],[296.5882873535156, 316.1368103027344, -50],[299.46099853515625, 316.3761901855469, -50],[302.09429931640625, 316.85498046875, -50],[303.5306701660156, 318.5307312011719, -50],[302.3337097167969, 320.2064514160156, -50],[299.46099853515625, 322.1216125488281, -50],[295.8701171875, 323.07916259765625, -50],[292.7580261230469, 324.0367431640625, -50],[290.8428955078125, 324.0367431640625, -50],[289.4065246582031, 325.9518737792969, -50],[290.3641052246094, 327.3882141113281, -50],[294.1943664550781, 327.62762451171875, -50],[296.82769775390625, 327.3882141113281, -50],[299.22161865234375, 326.4306640625, -50],[301.85491943359375, 325.47308349609375, -50],[304.48822021484375, 324.0367431640625, -50],[305.9245910644531, 324.0367431640625, -50],[307.600341796875, 325.47308349609375, -50],[307.600341796875, 327.1488342285156, -50],[307.600341796875, 328.5851745605469, -50]];
var nubsUnder = createNubs(controlsUnder);
var Dx7 =nubsUnder;
var nubsUnderMap = MAP(nubsUnder)(domain1);
//DRAW(nubsUnderMap);


var pointsLateral1 = [[240.6220245361328, 391.0994873046875, 0],[248,368,-40],[256,346,-48],[264.7491455078125, 324.7549133300781, -50]];
var bLateral1 = BEZIER(S1)(pointsLateral1);

//var bLateral10 = BEZIER(S0)(pointsLateral1);
//var bLateral10Map = MAP(bLateral10)(domain1);
//DRAW(bLateral10Map);


var pointsLateral2 = [[302.8639831542969, 393.7327880859375, 0],[303.5,370,-40],[305.5,349,-48],[307.600341796875, 328.5851745605469, -50]];
var bLateral2 = BEZIER(S1)(pointsLateral2);

//var bLateral20 = BEZIER(S0)(pointsLateralDx2);
//var bLateral20Map = MAP(bLateral20)(domain1);
//DRAW(bLateral20Map);

var volumeRerPart1Dx = MAP(COONS_PATCH([nubsUpper,nubsUnder,bLateral1,bLateral2]))(domain2);
DRAW(COLOR(mattDarkOrchid)(volumeRerPart1Dx));
var bL1Dx = bLateral1;
var bL2Dx = bLateral2;


//Boundary 

var controlsIntDx = reverseR([[305.97607421875, 395.8873291015625, 0],[308.609375, 398.28125, 0],[305.4972839355469, 399.47821044921875, 0],[303.5821533203125, 397.32366943359375, 0],[301.6670227050781, 397.08428955078125, 0],[294.7246398925781, 396.3660888671875, 0],[288.26104736328125, 396.126708984375, 0],[282.7550354003906, 393.97216796875, 0],[280.6004943847656, 390.6206970214844, 0],[282.036865234375, 387.2691955566406, 0],[286.82470703125, 385.59344482421875, 0],[291.8519287109375, 384.8752746582031, 0],[298.5549011230469, 383.4389343261719, 0],[304.5397033691406, 382.0025634765625, 0],[305.4972839355469, 379.3692626953125, 0],[304.5397033691406, 378.17230224609375, 0],[302.38519287109375, 377.4541320800781, 0],[297.59735107421875, 377.6935119628906, 0],[292.5700988769531, 377.93292236328125, 0],[285.1489562988281, 377.6935119628906, 0],[278.68536376953125, 377.6935119628906, 0],[273.65814208984375, 377.2147216796875, 0],[266.9551696777344, 376.7359619140625, 0],[262.4067077636719, 376.2571716308594, 0],[259.29461669921875, 377.2147216796875, 0],[258.09765625, 378.17230224609375, 0],[257.8582458496094, 380.56622314453125, 0],[261.2097473144531, 382.72076416015625, 0],[263.6036682128906, 383.917724609375, 0],[266.47637939453125, 384.6358947753906, 0],[270.5460510253906, 386.3116455078125, 0],[273.4187316894531, 386.7904052734375, 0],[276.05206298828125, 388.2267761230469, 0],[277.0096130371094, 390.38128662109375, 0],[277.7278137207031, 393.493408203125, 0],[276.05206298828125, 395.8873291015625, 0],[273.89752197265625, 396.8448791503906, 0],[270.306640625, 396.8448791503906, 0],[266.9551696777344, 396.6054992675781, 0],[264.5612487792969, 395.6479187011719, 0],[260.4915771484375, 394.4509582519531, 0],[256.6612854003906, 393.493408203125, 0],[252.3522491455078, 391.5782470703125, 0],[249.4795379638672, 390.38128662109375, 0],[245.64926147460938, 390.8600769042969, 0],[243.97352600097656, 392.53582763671875, 0]]);
var nubsIntDx = createNubs(controlsIntDx);
var boundaryDx = BEZIER(S1)([nubsUpper,nubsIntDx]);
var boundaryDxMap= MAP (boundaryDx)(domain2);
DRAW (COLOR(mattLightYellow)(boundaryDxMap));

//---------------------------------------------------------------ROUGH ENDOPLASMATIC RETICULUM PART 7 SX-----------------------------------------------------------------------



var controlsUpper = [[240.6220245361328, 391.0994873046875, 0],[241.5281219482422, 394.4179992675781, 0],[242.9644775390625, 397.53009033203125, 0],[245.5977783203125, 400.1634216308594, 0],[249.18865966796875, 401.1209716796875, 0],[252.06137084960938, 401.83917236328125, 0],[255.1734619140625, 402.5573425292969, 0],[259.0037536621094, 403.2755126953125, 0],[261.6370544433594, 403.2755126953125, 0],[264.0309753417969, 403.2755126953125, 0],[266.1855163574219, 403.7543029785156, 0],[267.3824768066406, 405.4300537109375, 0],[265.94610595703125, 406.86639404296875, 0],[262.1158447265625, 408.0633544921875, 0],[257.8067932128906, 407.823974609375, 0],[254.69468688964844, 407.823974609375, 0],[253.01893615722656, 409.02093505859375, 0],[251.34320068359375, 410.2178955078125, 0],[250.62501525878906, 412.8511962890625, 0],[251.58258056640625, 416.9208679199219, 0],[253.97650146484375, 419.7935791015625, 0],[257.8067932128906, 421.46929931640625, 0],[261.3976745605469, 421.9480895996094, 0],[264.2703552246094, 421.7087097167969, 0],[267.14306640625, 420.2723388671875, 0],[269.5369873046875, 418.59661865234375, 0],[271.6915283203125, 417.6390380859375, 0],[273.3672790527344, 415.9632873535156, 0],[275.7611999511719, 415.0057373046875, 0],[279.8308410644531, 416.68145751953125, 0],[282.70355224609375, 418.59661865234375, 0],[285.3368835449219, 420.7511291503906, 0],[288.6883544921875, 422.4268798828125, 0],[292.7580261230469, 423.62384033203125, 0],[297.06707763671875, 424.5814208984375, 0],[301.3761291503906, 424.82080078125, 0],[304.48822021484375, 423.38446044921875, 0],[307.8397216796875, 420.5117492675781, 0],[308.0791015625, 417.399658203125, 0],[306.40338134765625, 413.3299865722656, 0],[302.3337097167969, 411.65423583984375, 0],[297.5458679199219, 410.457275390625, 0],[291.8004455566406, 409.9784851074219, 0],[287.49139404296875, 408.302734375, 0],[285.3368835449219, 406.3876037597656, 0],[287.49139404296875, 404.23309326171875, 0],[293.4761962890625, 404.23309326171875, 0],[298.2640380859375, 404.71185302734375, 0],[302.8639831542969, 393.7327880859375, 0]];
var nubsUpper = createNubs(controlsUpper);
var nubsUpperMap = MAP(nubsUpper)(domain1);
//DRAW(nubsUpperMap);

var controlsUnder = [[264.7491455078125, 324.7549133300781, -60],[264.6896057128906, 325.3401794433594,  -60],[265.47686767578125, 327.1882629394531,  -60],[266.604736328125, 328.4522705078125,  -60],[268.5198974609375, 329.64923095703125,  -60],[269.95623779296875, 330.3674011230469,  -60],[271.8713684082031, 330.6068115234375,  -60],[274.665771484375, 331.2421875,  -60],[277.0981140136719, 331.78271484375,  -60],[278.71966552734375, 332.593505859375,  -60],[279.53192138671875, 334.67645263671875,  -60],[278.5743408203125, 337.07037353515625,  -60],[276.180419921875, 337.07037353515625,  -60],[273.0683288574219, 337.78857421875,  -60],[271.1531982421875, 337.78857421875,  -60],[269.4774475097656, 339.22491455078125,  -60],[269.2380676269531, 340.6612548828125,  -60],[269.2380676269531, 342.0976257324219,  -60],[271.392578125, 343.77337646484375,  -60],[273.0683288574219, 344.25213623046875,  -60],[277.13800048828125, 344.01275634765625,  -60],[279.53192138671875, 343.2945861816406,  -60],[281.2076721191406, 341.85821533203125,  -60],[283.3621826171875, 341.1400451660156,  -60],[285.0379333496094, 340.1824951171875,  -60],[287.91064453125, 339.9430847167969,  -60],[290.065185546875, 339.9430847167969,  -60],[291.9803161621094, 340.6612548828125,  -60],[293.65606689453125, 342.0976257324219,  -60],[295.8105773925781, 343.2945861816406,  -60],[298.68328857421875, 344.01275634765625,  -60],[300.83782958984375, 343.77337646484375,  -60],[303.47113037109375, 342.3370056152344,  -60],[304.4287109375, 341.61883544921875,  -60],[305.86505126953125, 340.1824951171875,  -60],[306.10443115234375, 338.267333984375,  -60],[303.9499206542969, 337.5491638183594,  -60],[301.07720947265625, 337.07037353515625,  -60],[298.5838623046875, 337.05279541015625,  -60],[296.6920471191406, 336.51226806640625,  -60],[294.8002014160156, 336.1069030761719,  -60],[293.31378173828125, 334.3501892089844,  -60],[295.0704650878906, 333.1340026855469,  -60],[297.2325744628906, 332.3232421875,  -60],[299.800048828125, 331.3773193359375,  -60],[301.5567321777344, 330.5665283203125,  -60],[303.1783142089844, 330.431396484375,  -60],[305.07012939453125, 330.0260009765625,  -60],[306.96197509765625, 328.9449768066406,  -60],[307.600341796875, 328.5851745605469, -60]];
var nubsUnder = createNubs(controlsUnder);
var Sx7 =nubsUnder;
var nubsUnderMap = MAP(nubsUnder)(domain1);
//DRAW(nubsUnderMap);


var pointsLateral1 = [[240.6220245361328, 391.0994873046875, 0],[248,368,-48],[256,346,-57.8],[264.7491455078125, 324.7549133300781, -60]];
var bLateral1 = BEZIER(S1)(pointsLateral1);

//var bLateral10 = BEZIER(S0)(pointsLateral1);
//var bLateral10Map = MAP(bLateral10)(domain1);
//DRAW(bLateral10Map);


var pointsLateral2 = [[302.8639831542969, 393.7327880859375, 0],[303.5,370,-48],[305.5,349,-57,8],[307.600341796875, 328.5851745605469, -60]];
var bLateral2 = BEZIER(S1)(pointsLateral2);

//var bLateral20 = BEZIER(S0)(pointsLateralDx2);
//var bLateral20Map = MAP(bLateral20)(domain1);
//DRAW(bLateral20Map);

var volumeRerPart1Sx = MAP(COONS_PATCH([nubsUpper,nubsUnder,bLateral1,bLateral2]))(domain2);
DRAW(COLOR(mattDarkOrchid)(volumeRerPart1Sx));
var bL1Sx = bLateral1;
var bL2Sx = bLateral2;


//Boundary 

var controlsIntSx = reverseR([[305.44580078125, 399.44525146484375, 0],[305.44580078125, 400.1634216308594, 0],[304.48822021484375, 401.1209716796875, 0],[303.5306701660156, 401.3603820800781, 0],[298.9822082519531, 401.3603820800781, 0],[293.9549865722656, 401.83917236328125, 0],[287.0126037597656, 401.5997619628906, 0],[282.70355224609375, 403.2755126953125, 0],[282.2247619628906, 405.66943359375, 0],[283.1823425292969, 409.02093505859375, 0],[286.5338134765625, 410.457275390625, 0],[290.6034851074219, 411.41485595703125, 0],[296.82769775390625, 412.8511962890625, 0],[300.8973388671875, 414.5269470214844, 0],[303.7700500488281, 415.4844970703125, 0],[304.9670104980469, 417.6390380859375, 0],[303.7700500488281, 419.7935791015625, 0],[300.8973388671875, 420.5117492675781, 0],[297.30645751953125, 420.7511291503906, 0],[294.67315673828125, 420.7511291503906, 0],[291.5610656738281, 419.7935791015625, 0],[288.2095642089844, 417.399658203125, 0],[284.85809326171875, 415.9632873535156, 0],[282.70355224609375, 414.04815673828125, 0],[277.67633056640625, 411.65423583984375, 0],[273.8460388183594, 411.65423583984375, 0],[271.6915283203125, 413.5693664550781, 0],[269.297607421875, 415.7239074707031, 0],[267.14306640625, 416.68145751953125, 0],[263.55218505859375, 418.1178283691406, 0],[259.2431335449219, 418.1178283691406, 0],[255.65225219726562, 417.1602478027344, 0],[253.97650146484375, 414.7663269042969, 0],[253.97650146484375, 411.89361572265625, 0],[256.13104248046875, 410.6966552734375, 0],[260.4400939941406, 410.457275390625, 0],[264.509765625, 410.2178955078125, 0],[269.7763977050781, 407.823974609375, 0],[271.4521179199219, 404.9512634277344, 0],[269.7763977050781, 401.3603820800781, 0],[264.509765625, 400.4028015136719, 0],[259.0037536621094, 400.1634216308594, 0],[252.06137084960938, 399.68463134765625, 0],[247.51292419433594, 397.7695007324219, 0],[246.3159637451172, 396.09375, 0],[245.3583984375, 393.46044921875, 0],[245.3583984375, 391.7846984863281, 0]]);
var nubsIntSx = createNubs(controlsIntSx);
var boundarySx = BEZIER(S1)([nubsUpper,nubsIntSx]);
var boundarySxMap= MAP (boundarySx)(domain2);
DRAW (COLOR(mattLightYellow)(boundarySxMap));

var lateralClosure = createBezierS2([bL1Sx, bL1Dx], mattDarkOrchid);
var lateralClosure = createBezierS2([bL2Sx, bL2Dx], mattDarkOrchid);

var point = BEZIER(S1)([[285, 297, -79]]);
var closure1 = createBezierS2([Dx1,point], mattDarkOrchid);
var closure2 = createBezierS2([Sx1, point], mattDarkOrchid);
var closure2 = createBezierS2([Dx3, point], mattDarkOrchid);
var closure2 = createBezierS2([Dx5, point], mattDarkOrchid);
var closure2 = createBezierS2([Dx7, point], mattDarkOrchid);
var closure2 = createBezierS2([Sx3, point], mattDarkOrchid);
var closure2 = createBezierS2([Sx5, point], mattDarkOrchid);
var closure2 = createBezierS2([Sx7, point], mattDarkOrchid);

/********************************************SMOOTH ENDOPLASMIC RETICULUM ****************************************/
//________________________________________________________________________________PART 1_________________________________________________________________________________

//Dx Control curves

var n1 = createNubs([[218.7066192626953, 418.1972961425781, 0],[220.50521850585938, 414.77996826171875, 0],[223.74267578125, 412.6216735839844, 0],[228.59886169433594, 411.18280029296875, 0],[232.196044921875, 410.6432189941406, 0],[237.23208618164062, 410.1036376953125, 0],[242.6278533935547, 410.8230895996094, 0],[246.58474731445312, 412.4418029785156, 0],[249.4624786376953, 415.3195495605469, 0],[250.90135192871094, 418.0174255371094, 0],[250.3617706298828, 420.7153015136719, 0]]);
var n2 = createNubs([[215.82888793945312, 417.8375549316406, -10],[217.98719787597656, 413.5209655761719, -10],[221.76422119140625, 409.5640563964844, -10],[228.41900634765625, 408.3050537109375, -10],[231.65646362304688, 407.5856018066406, -10],[237.05223083496094, 406.8661804199219, -10],[242.98756408691406, 407.5856018066406, -10],[248.38333129882812, 409.38421630859375, -10],[252.8798065185547, 413.88067626953125, -10],[253.7790985107422, 418.0174255371094, -10],[252.52008056640625, 421.0750427246094, -10]]);
var n3 = createNubs([[212.7712860107422, 417.2980041503906, -20],[213.85043334960938, 414.4202575683594, -20],[215.289306640625, 412.08209228515625, -20],[221.40451049804688, 407.40576171875, -20],[228.59886169433594, 405.42730712890625, -20],[231.83631896972656, 404.8877258300781, -20],[237.23208618164062, 404.7078857421875, -20],[243.16741943359375, 406.32659912109375, -20],[247.84375, 410.4633483886719, -20],[251.80064392089844, 414.77996826171875, -20],[252.34022521972656, 418.0174255371094, -20],[251.62078857421875, 421.0750427246094, -20]]);
var n4 = createNubs([[217.44761657714844, 422.33404541015625, -30],[221.40451049804688, 418.0174255371094, -30],[224.10238647460938, 416.0389709472656, -30],[225.3614044189453, 415.3195495605469, -30],[228.23915100097656, 413.88067626953125, -30],[232.73561096191406, 413.5209655761719, -30],[237.05223083496094, 413.5209655761719, -30],[242.44798278808594, 413.7008056640625, -30],[245.3257293701172, 415.3195495605469, -30],[246.58474731445312, 416.9382629394531, -30],[247.30418395996094, 418.37713623046875, -30],[247.48403930664062, 420.3555908203125, -30]]);
var n5 = createNubs([[225.00167846679688, 421.0750427246094, -40],[225.541259765625, 419.8160095214844, -40],[226.4405517578125, 418.73687744140625, -40],[229.13844299316406, 418.0174255371094, -40],[232.3759002685547, 417.8375549316406, -40],[237.23208618164062, 418.73687744140625, -40],[240.64939880371094, 419.8160095214844, -40],[241.18898010253906, 420.8951721191406, -40],[241.7285614013672, 421.9743347167969, -40],[241.7285614013672, 423.053466796875, -40],[241.7285614013672, 424.13262939453125, -40]]);
var n6 = createNubs([[226.80027770996094, 423.4131774902344, -50],[226.98013305664062, 422.33404541015625, -50],[229.13844299316406, 421.2548828125, -50],[230.75717163085938, 421.0750427246094, -50],[233.0953369140625, 421.6145935058594, -50],[234.8939208984375, 422.33404541015625, -50],[235.793212890625, 423.5930480957031, -50],[236.15293884277344, 424.4923400878906, -50],[236.33279418945312, 425.2117919921875, -50],[236.33279418945312, 425.93121337890625, -50],[227.51971435546875, 426.6506652832031, -50]]);
var nRac1Dx = createNubs([[229.49815368652344+30, 426.83050537109375, -60],[230.93702697753906+30, 426.83050537109375, -60],[232.01617431640625+30, 426.83050537109375+1, -57],[232.73561096191406+30, 426.83050537109375+2, -56.5],[233.27519226074223+30, 427.0103759765625+3, -56],[233.8147735595703+30, 427.0103759765625+4, -56.5],[234.8939208984375+30, 427.3700866699219+5, -57],[235.9730682373047+30, 427.3700866699219+6, -60],[236.6925048828125+30, 427.3700866699219+6, -60]]);

var volumeDx = createBezierS1([n1,n2,n3,n4,n5,n6,nRac1Dx])
DRAW(COLOR(mattSteelBlue)(MAP(volumeDx)(domain2)));

//Boundary Dx
var cPBoundDx =[[223.10598754882812,417.7926025390625,0 ],[223.91677856445312,415.9007568359375,0 ],[225.94374084472656,414.4143371582031,0 ],[229.32199096679688,413.3332824707031,0 ],[232.70025634765625,412.6576232910156,0 ],[235.94338989257812,412.2522277832031,0 ],[239.05140686035156,412.6576232910156,0 ],[242.02427673339844,413.7386779785156,0 ],[244.7268829345703,415.22509765625,0 ],[246.61871337890625,416.9818115234375,0 ],[247.5646209716797,419.2790222167969,0 ]];
var nBoundDx= createNubs(cPBoundDx);
var surBoundDx = createBezierS1([nBoundDx,n1])
DRAW(COLOR(mattSkyBlue)(MAP(surBoundDx)(domain2)));

//Link Rought Reticulum
var nRet8 = createNubs([[221.47772216796875,401.8037109375-6,-20],[223.0006103515625,402.31134033203125-9,-20],[225.1326446533203,403.02203369140625-10,-20],[226.4524688720703,403.4281311035156-10,-20],[228.17840576171875,403.7326965332031-9,-20],[229.7012939453125,403.834228515625-9,-20],[231.52874755859375,403.7326965332031-6,-20]]);
var volumeSx = createBezierS1([n1,n2,n3,nRet8])
DRAW(COLOR(mattSteelBlue)(MAP(volumeSx)(domain2)));

 //Sx Control curves 

var n1 = createNubs([[218.7066192626953, 418.1972961425781, 0],[219.39688110351562, 420.3992614746094, 0 ],[220.7167205810547, 422.2267150878906, 0 ],[222.8487548828125, 423.6481018066406, 0 ],[227.21435546875, 423.7496032714844, 0 ],[231.98605346679688, 423.343505859375, 0 ],[237.7730255126953, 424.2572326660156, 0 ],[242.3416748046875, 425.4755554199219, 0 ],[246.60574340820312, 425.6785888671875, 0 ],[249.0423583984375, 424.05419921875, 0 ],[250.3617706298828, 420.7153015136719, 0]]);
var n2 = createNubs([[215.82888793945312, 417.8375549316406, -10],[219.06634521484375, 419.63616943359375, -10],[222.48365783691406, 422.5138854980469, -10],[225.541259765625, 423.9527587890625, -10],[229.31829833984375, 425.03192138671875, -10],[231.65646362304688, 425.3916320800781, -10],[235.793212890625, 426.111083984375, -10],[237.95152282714844, 426.2909240722656, -10],[241.7285614013672, 426.2909240722656, -10],[247.30418395996094, 423.9527587890625, -10],[252.52008056640625, 421.0750427246094, -10]]);
var n3 = createNubs([[212.7712860107422, 417.2980041503906, -20],[213.3108673095703, 421.7944641113281, -20],[216.1885986328125, 425.2117919921875, -20],[219.78578186035156, 427.5499572753906, -20],[229.67800903320312, 429.708251953125, -20],[235.25363159179688, 429.708251953125, -20],[241.54869079589844, 429.3485412597656, -20],[246.7646026611328, 427.5499572753906, -20],[249.28262329101562, 424.85205078125, -20],[251.62078857421875, 421.0750427246094, -20]]);
var n4 = createNubs([[217.44761657714844, 422.33404541015625, -30],[220.14549255371094, 424.3125, -30],[222.66351318359375, 424.85205078125, -30],[226.6204071044922, 425.5715026855469, -30],[229.49815368652344, 425.5715026855469, -30],[233.2751922607422, 425.5715026855469, -30],[236.6925048828125, 425.5715026855469, -30],[241.7285614013672, 425.7513427734375, -30],[245.50558471679688, 424.85205078125, -30],[247.48403930664062, 420.3555908203125, -30]]);
var n5 = createNubs([[225.00167846679688, 421.0750427246094, -40],[226.08084106445312, 423.23333740234375, -40],[226.08084106445312, 423.23333740234375, -40],[227.87942504882812, 423.9527587890625, -40],[230.57730102539062, 424.4923400878906, -40],[232.01617431640625, 424.4923400878906, -40],[233.45504760742188, 424.13262939453125, -40],[234.53419494628906, 423.7729187011719, -40],[235.793212890625, 423.7729187011719, -40],[237.591796875, 423.7729187011719, -40],[241.7285614013672, 424.13262939453125, -40]]);
var n6 = createNubs([[226.80027770996094, 423.4131774902344, -50],[227.69956970214844, 426.111083984375, -50],[229.67800903320312, 426.6506652832031, -50],[230.21759033203125, 426.83050537109375, -50],[232.01617431640625, 427.0103759765625, -50],[233.8147735595703, 427.0103759765625, -50],[234.1744842529297, 426.83050537109375, -50],[234.53419494628906, 426.6506652832031, -50],[235.25363159179688, 426.2909240722656, -50],[236.5126495361328, 425.93121337890625, -50],[227.51971435546875, 426.6506652832031, -50]]);
var nRac1Sx = createNubs([[229.49815368652344+30, 426.83050537109375, -60],[230.93702697753906+30, 426.83050537109375, -60],[232.01617431640625+30, 426.83050537109375+1, -63],[232.73561096191406+30, 426.83050537109375+2, -63.5],[233.27519226074223+30, 427.0103759765625+3, -64],[233.8147735595703+30, 427.0103759765625+4, -63.5],[234.8939208984375+30, 427.3700866699219+5, -63],[235.9730682373047+30, 427.3700866699219+6, -60],[236.6925048828125+30, 427.3700866699219+6, -60]]);

var volumeSx = createBezierS1([n1,n2,n3,n4,n5,n6,nRac1Sx])
DRAW(COLOR(mattSteelBlue)(MAP(volumeSx)(domain2)));

//Boundary Sx
var nBoundSx= createNubs([[223.10598754882812,417.7926025390625,0 ],[223.51138305664062,419.2790222167969,0 ],[224.45729064941406,420.9006042480469,0 ],[226.619384765625,421.4411315917969,0 ],[230.26791381835938,421.4411315917969,0 ],[233.51104736328125,421.1708679199219,0 ],[236.48391723632812,421.5762634277344,0 ],[239.72705078125,422.79241943359375,0 ],[243.37557983398438,423.87347412109375,0 ],[245.94305419921875,423.06268310546875,0 ],[247.42950439453125,421.7113952636719,0 ],[247.5646209716797,419.1438903808594,0 ]]);
var surBoundSx = createBezierS1([nBoundSx,n1])
DRAW(COLOR(mattSkyBlue)(MAP(surBoundSx)(domain2)));

//Link Rought Reticulum
var nRet9 = createNubs([[221.47772216796875,401.8037109375-6,-20],[223.0006103515625,402.31134033203125-9,-20],[225.1326446533203,403.02203369140625-10,-20],[226.4524688720703,403.4281311035156-10,-20],[228.17840576171875,403.7326965332031-9,-20],[229.7012939453125,403.834228515625-9,-20],[231.52874755859375,403.7326965332031-6,-20]]);
var volumeSx = createBezierS1([n1,n2,n3,nRet9])
DRAW(COLOR(mattSteelBlue)(MAP(volumeSx)(domain2)));

//Closure
var linkSx = createBezierS1([nRac1Dx, nRac1Sx])
DRAW(COLOR(mattSteelBlue)(MAP(linkSx)(domain2)));

//________________________________________________________________________________PART 6_________________________________________________________________________________

//Dx Control curves

var n1 = createNubs([[227.43763732910156,438.0393371582031,0],[226.16311645507812,434.21575927734375,0],[227.7562713623047,431.34808349609375,0],[230.94256591796875,429.11767578125,0],[237.315185546875,428.48040771484375,0],[241.77601623535156,429.11767578125,0],[246.87411499023438,431.9853515625,0],[250.6976776123047,437.720703125,0]]);
var n2 = createNubs([[230.30531311035156,437.4020690917969,-20],[229.34942626953125,434.85302734375,-20],[229.98667907714844,432.94122314453125,-20],[232.5357208251953,431.6667175292969,-20],[236.6779327392578,431.6667175292969,-20],[240.50149536132812,432.6225891113281,-20],[243.05055236816406,433.8971252441406,-20],[246.55548095703125,436.7648010253906,-20]]);
var n3 = createNubs([[232.85435485839844,437.4020690917969,-40],[231.89846801757812,436.1275329589844,-40],[232.21710205078125,434.21575927734375,-40],[234.12887573242188,434.21575927734375,-40],[237.95245361328125,434.21575927734375,-40],[239.86424255371094,435.4902648925781,-40],[240.82012939453125,436.4461669921875,-40],[241.77601623535156,436.7648010253906,-40]]);

var volumeDx = createBezierS1([n1,n2,n3,nRac1Sx])
DRAW(COLOR(mattSteelBlue)(MAP(volumeDx)(domain2)));

//Boundary Dx
var n2up= createNubs([[230.30531311035156,437.4020690917969,0],[229.34942626953125,434.85302734375,0],[229.98667907714844,432.94122314453125,0],[232.5357208251953,431.6667175292969,0],[236.6779327392578,431.6667175292969,0],[240.50149536132812,432.6225891113281,0],[243.05055236816406,433.8971252441406,0],[246.55548095703125,436.7648010253906,0]]);
var surBoundDx = createBezierS1([n1,n2up])
DRAW(COLOR(mattSkyBlue)(MAP(surBoundDx)(domain2)));

 //Sx Control curves 

var n1 = createNubs([[227.43763732910156,438.0393371582031,0],[229.76995849609375,442.181884765625,0],[232.63539123535156,444.30230712890625,0],[237.22007751464844,446.48004150390625,0],[241.9766845703125,447.39697265625,0],[246.21751403808594,447.11041259765625,0],[249.1975555419922,445.04730224609375,0],[250.8022003173828,441.15032958984375,0],[250.6976776123047,437.720703125,0]]);
var n2 = createNubs([[230.30531311035156,437.4020690917969,-20],[232.40614318847656,440.8638000488281,-20],[234.18270874023438,442.0672607421875,-20],[237.62123107910156,444.13037109375,-20],[241.74745178222656,444.5315246582031,-20],[244.8994140625,444.18768310546875,-20],[246.61866760253906,443.44268798828125,-20],[247.47830200195312,441.03570556640625,-20],[246.55548095703125,436.7648010253906,-20]]);
var n3 = createNubs([[232.85435485839844,437.4020690917969,-40],[234.698486328125,439.94683837890625,-40],[235.5008087158203,440.7491760253906,-40],[238.19432067871094,442.0672607421875,-40],[241.5755157470703,442.46844482421875,-40],[244.0970916748047,441.8380432128906,-40],[244.84210205078125,440.9783935546875,-40],[241.77601623535156,436.7648010253906,-40]]);

var volumeSx = createBezierS1([n1,n2,n3,nRac1Dx])
DRAW(COLOR(mattSteelBlue)(MAP(volumeSx)(domain2)));

//Boundary Sx
var n2up =createNubs([[230.30531311035156,437.4020690917969,0],[232.40614318847656,440.8638000488281,0],[234.18270874023438,442.0672607421875,0],[237.62123107910156,444.13037109375,0],[241.74745178222656,444.5315246582031,0],[244.8994140625,444.18768310546875,0],[246.61866760253906,443.44268798828125,0],[247.47830200195312,441.03570556640625,0],[246.55548095703125,436.7648010253906,0]]);
var surBoundSx = createBezierS1([n1,n2up])
DRAW(COLOR(mattSkyBlue)(MAP(surBoundSx)(domain2)));


//________________________________________________________________________________PART 8_________________________________________________________________________________

//Dx Control curves

var n1 = createNubs([[185.27728271484375,451.5130310058594,0],[186.71363830566406,447.2039794921875,0],[188.62876892089844,444.5706787109375,0],[191.74085998535156,442.1767578125,0],[195.3317413330078,440.7403869628906,0],[200.8377685546875,438.58587646484375,0],[205.14682006835938,437.388916015625,0],[210.4134521484375,435.4737854003906,0],[214.96189880371094,435.4737854003906,0],[218.79217529296875,438.3464660644531,0],[221.90426635742188,451.5130310058594,0]]);
var n2 = createNubs([[190.06512451171875,451.5130310058594,-12],[192.2196502685547,449.1191101074219,-12],[195.3317413330078,446.00701904296875,-12],[198.20445251464844,443.8525085449219,-12],[202.03472900390625,441.4585876464844,-12],[205.38621520996094,440.5010070800781,-12],[209.21649169921875,439.3040466308594,-12],[212.807373046875,439.3040466308594,-12],[217.11642456054688,440.7403869628906,-12],[218.79217529296875,443.61309814453125,-12],[218.5527801513672,450.79486083984375,-12]]);
var n3 = createNubs([[187.67120361328125,443.8525085449219,-24],[187.19241333007812,439.0646667480469,-24],[188.8681640625,434.9949951171875,-24],[191.74085998535156,431.1647033691406,-24],[195.0923614501953,428.77081298828125,-24],[198.44384765625,427.0950622558594,-24],[202.2741241455078,426.85565185546875,-24],[205.14682006835938,426.1374816894531,-24],[208.73770141601562,426.37689208984375,-24],[213.52554321289062,428.2920227050781,-24],[217.11642456054688,430.2071533203125,-24],[218.79217529296875,434.5162048339844,-24],[219.03155517578125,434.5162048339844,-24]]);
var n4 = createNubs([[195.57113647460938,436.6707458496094,-36],[196.52870178222656,434.9949951171875,-36],[200.8377685546875,432.3616638183594,-36],[208.01953125,430.9253234863281,-36],[212.807373046875,430.446533203125,-36],[216.1588592529297,431.64349365234375,-36],[219.2709503173828,432.60107421875,-36],[220.46791076660156,434.5162048339844,-36],[221.6648712158203,435.9525451660156,-36],[222.6224365234375,438.3464660644531,-36],[223.3406219482422,440.022216796875,-36],[224.53758239746094,442.8949279785156,-36]]);

var volumeDx = createBezierS1([n1,n2,n3,n4,nRac1Dx])
DRAW(COLOR(mattSteelBlue)(MAP(volumeDx)(domain2)));

//Boundary Dx
var n2up= createNubs([[190.06512451171875,451.5130310058594,0],[192.2196502685547,449.1191101074219,0],[195.3317413330078,446.00701904296875,0],[198.20445251464844,443.8525085449219,0],[202.03472900390625,441.4585876464844,0],[205.38621520996094,440.5010070800781,0],[209.21649169921875,439.3040466308594,0],[212.807373046875,439.3040466308594,0],[217.11642456054688,440.7403869628906,0],[218.79217529296875,443.61309814453125,0],[219.03155517578125,447.2039794921875,0],[219.03155517578125,451.0342712402344,0]]);
var surBoundDx = createBezierS1([n1,n2up])
DRAW(COLOR(mattSkyBlue)(MAP(surBoundDx)(domain2)));

 //Sx Control curves 

var n1 = createNubs(reverseR([[221.90426635742188,451.5130310058594,0],[220.46791076660156,453.6675720214844,0],[219.03155517578125,456.3008728027344,0],[215.68006896972656,458.4554138183594,0],[212.32858276367188,457.73724365234375,0],[208.73770141601562,457.73724365234375,0],[205.86500549316406,458.6947937011719,0],[201.55593872070312,462.2856750488281,0],[197.7256622314453,465.15838623046875,0],[190.78329467773438,463.96142578125,0],[186.4742431640625,459.173583984375,0],[185.27728271484375,451.5130310058594,0]]));
var n2 = createNubs(reverseR([[218.5527801513672,450.79486083984375,-12],[216.8770294189453,453.18878173828125,-12],[215.2012939453125,455.1039123535156,-12],[212.0891876220703,455.1039123535156,-12],[208.9770965576172,454.3857421875,-12],[205.86500549316406,454.6251525878906,-12],[201.31654357910156,457.4978332519531,-12],[198.92262268066406,460.37054443359375,-12],[195.3317413330078,461.328125,-12],[190.06512451171875,458.6947937011719,-12],[189.10755920410156,455.58270263671875,-12],[190.06512451171875,451.5130310058594,-12]]));
var n3 = createNubs(reverseR([[219.03155517578125,434.5162048339844,-24],[219.03155517578125,436.43133544921875,-24],[218.07398986816406,439.0646667480469,-24],[215.68006896972656,442.1767578125,-24],[208.73770141601562,443.8525085449219,-24],[203.71046447753906,444.3312683105469,-24],[196.76809692382812,444.81005859375,-24],[194.13478088378906,444.81005859375,-24],[191.98025512695312,444.5706787109375,-24],[187.67120361328125,443.8525085449219,-24]]));
var n4 = createNubs(reverseR([[224.53758239746094,442.8949279785156,-36],[221.18609619140625,444.0918884277344,-36],[219.51034545898438,444.81005859375,-36],[214.72250366210938,445.2888488769531,-36],[210.4134521484375,444.81005859375,-36],[205.38621520996094,442.1767578125,-36],[202.2741241455078,440.022216796875,-36],[198.92262268066406,438.58587646484375,-36],[196.76809692382812,437.8677062988281,-36],[195.57113647460938,436.6707458496094,-36]]));

var volumeSx = createBezierS1([n1,n2,n3,n4,nRac1Sx])
DRAW(COLOR(mattSteelBlue)(MAP(volumeSx)(domain2)));

//Boundary Sx
var n2up =createNubs(reverseR([[219.03155517578125,451.0342712402344,0],[218.5527801513672,450.79486083984375,0],[216.8770294189453,453.18878173828125,0],[215.2012939453125,455.1039123535156,0],[212.0891876220703,455.1039123535156,0],[208.9770965576172,454.3857421875,0],[205.86500549316406,454.6251525878906,0],[201.31654357910156,457.4978332519531,0],[198.92262268066406,460.37054443359375,0],[195.3317413330078,461.328125,0],[190.06512451171875,451.5130310058594,0]]));
var surBoundSx = createBezierS1([n1,n2up])
DRAW(COLOR(mattSkyBlue)(MAP(surBoundSx)(domain2)));

//________________________________________________________________________________PART 9_________________________________________________________________________________

//Dx Control curves

var n1 = createNubs([[203.94985961914062,470.90380859375,0],[207.0619659423828,474.9734802246094,0],[210.89222717285156,476.6492004394531,0],[215.68006896972656,478.0855712890625,0],[219.51034545898438,480.0007019042969,0],[223.81939697265625,483.8309631347656,0],[229.08602905273438,487.1824645996094,0],[235.07083129882812,488.85821533203125,0],[242.25259399414062,486.46429443359375,0],[246.80104064941406,483.3522033691406,0],[247.9980010986328,477.8461608886719,0],[246.5616455078125,472.5795593261719,0]]);
var n2 = createNubs([[208.01953125,470.6643981933594,-40],[210.4134521484375,473.7765197753906,-40],[214.4831085205078,474.73406982421875,-40],[217.59521484375,475.2128601074219,-40],[221.18609619140625,477.3674011230469,-40],[224.53758239746094,480.7188720703125,-40],[229.08602905273438,484.5491638183594,-40],[234.11326599121094,485.0279235839844,-40],[240.33746337890625,483.5915832519531,-40],[243.2101593017578,480.9582824707031,-40],[244.40711975097656,477.6067810058594,-40],[242.73138427734375,472.34014892578125,-40]]);
var n3 = createNubs([[215.440673828125,454.3857421875,-80],[216.39825439453125,458.6947937011719,-80],[219.51034545898438,460.37054443359375,-80],[221.90426635742188,460.6099548339844,-80],[224.53758239746094,459.4129943847656,-80],[226.69210815429688,459.4129943847656,-80],[229.80419921875,460.6099548339844,-80],[232.43751525878906,462.52508544921875,-80],[236.0283966064453,463.4826354980469,-80],[239.61927795410156,463.4826354980469,-80],[242.97076416015625,461.8069152832031,-80],[244.8859100341797,456.540283203125,-80]]);
var n4 = createNubs([[219.03155517578125,436.9101257324219,-70],[220.228515625,440.5010070800781,-70],[222.14366149902344,442.6555480957031,-70],[224.53758239746094,443.37371826171875,-70],[226.93150329589844,443.1343078613281,-70],[228.1284637451172,442.6555480957031,-70],[230.76177978515625,441.9373474121094,-70],[233.87387084960938,442.1767578125,-70],[236.0283966064453,444.5706787109375,-70],[237.94354248046875,444.81005859375,-70],[240.8162384033203,443.37371826171875,-70],[242.97076416015625,439.0646667480469,-70]]);

var volumeDx = createBezierS1([n1,n2,n3,n4,nRac1Sx])
DRAW(COLOR(mattSteelBlue)(MAP(volumeDx)(domain2)));

//Boundary Dx
var n2up= createNubs([[208.01953125,470.6643981933594,0],[210.4134521484375,473.7765197753906,0],[214.4831085205078,474.73406982421875,0],[217.59521484375,475.2128601074219,0],[221.18609619140625,477.3674011230469,0],[224.53758239746094,480.7188720703125,0],[229.08602905273438,484.5491638183594,0],[234.11326599121094,485.0279235839844,0],[240.33746337890625,483.5915832519531,0],[243.2101593017578,480.9582824707031,0],[244.40711975097656,477.6067810058594,0],[242.73138427734375,472.34014892578125,0]]);
var surBoundDx = createBezierS1([n1,n2up])
DRAW(COLOR(mattSkyBlue)(MAP(surBoundDx)(domain2)));

 //Sx Control curves 

var n1 = createNubs(reverseR([[246.5616455078125,472.5795593261719,0],[243.68894958496094,468.0310974121094,0],[240.33746337890625,465.6371765136719,0],[235.07083129882812,464.2008361816406,0],[229.80419921875,464.2008361816406,0],[226.21331787109375,465.3977966308594,0],[222.86183166503906,465.6371765136719,0],[219.2709503173828,464.6795959472656,0],[215.2012939453125,463.7220458984375,0],[211.3710174560547,463.4826354980469,0],[206.34378051757812,465.6371765136719,0],[203.94985961914062,470.90380859375,0]]));
var n2 = createNubs(reverseR([[242.73138427734375,472.34014892578125,-40],[240.57684326171875,469.94622802734375,-40],[237.7041473388672,468.0310974121094,-40],[233.6344757080078,466.8341369628906,-40],[230.28298950195312,466.8341369628906,-40],[228.1284637451172,467.7917175292969,-40],[223.58001708984375,468.749267578125,-40],[217.59521484375,467.7917175292969,-40],[214.96189880371094,466.3553466796875,-40],[211.13162231445312,466.3553466796875,-40],[208.01953125,470.6643981933594,-40]]));
var n3 = createNubs(reverseR([[244.8859100341797,456.540283203125,-80],[244.40711975097656,454.6251525878906,-80],[241.7738037109375,453.4281921386719,-80],[239.61927795410156,452.4706115722656,-80],[237.22535705566406,451.2736511230469,-80],[235.07083129882812,451.5130310058594,-80],[231.47994995117188,453.18878173828125,-80],[227.1708984375,454.1463623046875,-80],[224.53758239746094,453.4281921386719,-80],[223.10122680664062,451.9918212890625,-80],[219.51034545898438,450.55548095703125,-80],[215.440673828125,454.3857421875,-80]]));
var n4 = createNubs(reverseR([[242.97076416015625,439.0646667480469,-70],[241.534423828125,437.388916015625,-70],[239.3798828125,435.9525451660156,-70],[237.22535705566406,435.4737854003906,-70],[234.83143615722656,434.5162048339844,-70],[233.15570068359375,434.5162048339844,-70],[231.47994995117188,434.9949951171875,-70],[229.5648193359375,435.9525451660156,-70],[225.97393798828125,435.7131652832031,-70],[224.29818725585938,434.5162048339844,-70],[221.6648712158203,434.2768249511719,-70],[219.03155517578125,436.9101257324219,-70]]));

var volumeSx = createBezierS1([n1,n2,n3,n4,nRac1Dx])
DRAW(COLOR(mattSteelBlue)(MAP(volumeSx)(domain2)));

//Boundary Sx
var n2up= createNubs(reverseR([[242.73138427734375,472.34014892578125,0],[240.57684326171875,469.94622802734375,0],[237.7041473388672,468.0310974121094,0],[233.6344757080078,466.8341369628906,0],[230.28298950195312,466.8341369628906,0],[228.1284637451172,467.7917175292969,0],[223.58001708984375,468.749267578125,0],[217.59521484375,467.7917175292969,0],[214.96189880371094,466.3553466796875,0],[211.13162231445312,466.3553466796875,0],[208.9770965576172,468.0310974121094,0],[208.01953125,470.6643981933594,0]]));
var surBoundSx = createBezierS1([n1,n2up])
DRAW(COLOR(mattSkyBlue)(MAP(surBoundSx)(domain2)));



//________________________________________________________________________________PART 2_________________________________________________________________________________

//Dx Control curves

var n1 = createNubs([[269.9454650878906, 428.2642517089844, 0],[275.63092041015625, 429.5840759277344, 0],[280.4026184082031, 432.4267883300781, 0],[283.143798828125, 436.7923889160156, 0],[282.4331359863281, 439.8381652832031, 0],[279.28582763671875, 443.1885070800781, 0],[274.61566162109375, 444.0007019042969, 0],[270.3515930175781, 443.79766845703125, 0]]);
var n2 = createNubs([[270.1485290527344, 431.6145935058594, -20],[274.3110656738281, 432.7313537597656, -20],[277.5599060058594, 434.4573059082031, -20],[278.5751647949219, 435.9801940917969, -20],[278.6766662597656, 438.518310546875, -20],[277.4583740234375, 440.2442626953125, -20],[274.0065002441406, 440.548828125, -20],[270.0469970703125, 440.8534240722656, -20]]);
var n3 = createNubs([[257.15325927734375, 425.116943359375, -40],[259.48834228515625, 426.2337341308594, -40],[261.4173278808594, 427.4520263671875, -40],[262.83868408203125, 429.27947998046875, -40],[263.2447814941406, 431.9191589355469, -40],[262.2295227050781, 435.06646728515625, -40],[259.79290771484375, 435.67559814453125, -40],[254.91969299316406, 434.7618713378906, -40]]);
var n4 = createNubs([[249.2342529296875, 426.436767578125, -50],[250.65560913085938, 426.436767578125, -50],[252.5845947265625, 427.0459289550781, -50],[253.29527282714844, 428.1627197265625, -50],[253.19375610351562, 429.787109375, -50],[251.97544860839844, 430.8023681640625, -50],[250.14797973632812, 430.8023681640625, -50],[249.13272094726562, 430.29473876953125, -50]]);

var volumeDx = createBezierS1([n1,n2,n3,n4,nRac1Dx])
DRAW(COLOR(mattSteelBlue)(MAP(volumeDx)(domain2)));

//Boundary Dx
var n2up= createNubs([[270.1485290527344, 431.6145935058594, 0],[274.3110656738281, 432.7313537597656, 0],[277.5599060058594, 434.4573059082031, 0],[278.5751647949219, 435.9801940917969, 0],[278.6766662597656, 438.518310546875, 0],[277.4583740234375, 440.2442626953125, 0],[274.0065002441406, 440.548828125, 0],[270.0469970703125, 440.8534240722656, 0]]);
var surBoundDx = createBezierS1([n1,n2up])
DRAW(COLOR(mattSkyBlue)(MAP(surBoundDx)(domain2)));

 //Sx Control curves 

var n1 = createNubs([[270.3515930175781, 443.79766845703125, 0],[265.5798645019531, 443.2900390625, 0],[260.7066345214844, 442.3763122558594, 0],[257.76239013671875, 440.548828125, 0],[254.8181610107422, 437.0969543457031, 0],[254.8181610107422, 432.5283203125, 0],[256.7471618652344, 430.3962707519531, 0],[260.7066345214844, 428.2642517089844, 0],[265.2752990722656, 428.1627197265625, 0],[269.9454650878906, 428.2642517089844, 0]]);
var n2 = createNubs([[270.0469970703125, 440.8534240722656, -20],[268.7271728515625, 440.75189208984375, -20],[265.681396484375, 439.939697265625, -20],[260.80816650390625, 438.2137451171875, -20],[258.980712890625, 436.7923889160156, -20],[257.9654541015625, 434.1527099609375, -20],[260.0975036621094, 432.02069091796875, -20],[262.7371520996094, 431.4115295410156, -20],[266.2905578613281, 431.4115295410156, -20],[270.1485290527344, 431.6145935058594, -20]]);
var n3 = createNubs([[254.91969299316406, 434.7618713378906, -40],[252.5845947265625, 434.2542419433594, -40],[250.4525604248047, 432.02069091796875, -40],[249.53883361816406, 430.5993347167969, -40],[249.2342529296875, 428.46728515625, -40],[250.24951171875, 426.2337341308594, -40],[251.87391662597656, 425.2184753417969, -40],[253.49832153320312, 424.91387939453125, -40],[255.32579040527344, 424.60931396484375, -40],[257.15325927734375, 425.116943359375, -40]]);
var n4 = createNubs(reverseR([[249.13272094726562, 430.29473876953125, -50],[247.60984802246094, 430.29473876953125, -50],[246.39154052734375, 430.0917053222656, -50],[245.8839111328125, 429.4825439453125, -50],[246.0869598388672, 428.1627197265625, -50],[246.899169921875, 427.3504943847656, -50],[247.81289672851562, 427.0459289550781, -50],[248.0159454345703, 426.7413635253906, -50],[248.62509155273438, 426.5382995605469, -50],[249.2342529296875, 426.436767578125, -50]]));

var volumeSx = createBezierS1([n1,n2,n3,n4,nRac1Sx])
DRAW(COLOR(mattSteelBlue)(MAP(volumeSx)(domain2)));

//Boundary Sx
var n2up =createNubs([[270.0469970703125, 440.8534240722656, 0],[268.7271728515625, 440.75189208984375, 0],[265.681396484375, 439.939697265625, 0],[260.80816650390625, 438.2137451171875, 0],[258.980712890625, 436.7923889160156, 0],[257.9654541015625, 434.1527099609375, 0],[260.0975036621094, 432.02069091796875, 0],[262.7371520996094, 431.4115295410156, 0],[266.2905578613281, 431.4115295410156, 0],[270.1485290527344, 431.6145935058594, 0]]);
var surBoundSx = createBezierS1([n1,n2up])
DRAW(COLOR(mattSkyBlue)(MAP(surBoundSx)(domain2)));


//________________________________________________________________________________PART 5_________________________________________________________________________________

//Dx Control curves

var n1 = createNubs([[256.7492370605469, 446.23846435546875, 0],[253.57290649414062, 447.8266296386719, 0],[250.22010803222656, 451.0029602050781, 0],[247.5731658935547, 456.120361328125, 0],[247.22024536132812, 460.7084045410156, 0],[249.1613311767578, 466.7081298828125, 0],[251.45535278320312, 470.0609436035156, 0],[254.45521545410156, 474.11956787109375, 0], [257.455078125, 476.7665100097656, 0]]);
var n2 = createNubs([[256.2198486328125, 450.1206359863281, -30],[254.27874755859375, 451.3558654785156, -30],[252.69058227539062, 453.1205139160156, -30],[250.57302856445312, 456.4732971191406, -30],[250.22010803222656, 460.35546875, -30],[251.2788848876953, 465.29644775390625, -30],[252.86705017089844, 468.4727783203125, -30],[254.98460388183594, 471.1197204589844, -30],[257.27862548828125, 472.7078857421875, -30]]);
var n3 = createNubs([[254.102294921875, 436.70947265625, -50],[250.22010803222656, 437.2388610839844, -50],[248.10255432128906, 438.2976379394531, -50],[246.16146850585938, 439.88580322265625, -50],[245.10269165039062, 441.6504211425781, -50],[244.04391479492188, 443.4150390625, -50],[243.3380584716797, 445.1796875, -50],[242.8086700439453, 447.1207580566406, -50],[242.6322021484375, 449.0618591308594, -50]]);
var n4 = createNubs([[250.57302856445312, 433.1802062988281, -70],[247.5731658935547, 433.1802062988281, -70],[246.51438903808594, 433.53314208984375, -70],[244.57330322265625, 434.2389831542969, -70],[243.16159057617188, 435.4742126464844, -70],[242.6322021484375, 436.1800842285156, -70],[241.74989318847656, 437.2388610839844, -70],[241.04403686523438, 438.4740905761719, -70]]);

var volumeDx = createBezierS1([n1,n2,n3,n4,nRac1Sx])
DRAW(COLOR(mattSteelBlue)(MAP(volumeDx)(domain2)));

//Boundary Dx
var n2up= createNubs([[256.2198486328125, 450.1206359863281, 0],[254.27874755859375, 451.3558654785156, 0],[252.69058227539062, 453.1205139160156, 0],[250.57302856445312, 456.4732971191406, 0],[250.22010803222656, 460.35546875, 0],[251.2788848876953, 465.29644775390625, 0],[252.86705017089844, 468.4727783203125, 0],[254.98460388183594, 471.1197204589844, 0],[257.27862548828125, 472.7078857421875, 0]]);
var surBoundDx = createBezierS1([n1,n2up])
DRAW(COLOR(mattSkyBlue)(MAP(surBoundDx)(domain2)));

 //Sx Control curves 

var n1 = createNubs(reverseR([[256.7492370605469, 446.23846435546875, 0],[258.51385498046875, 447.1207580566406, 0],[260.4549560546875, 448.532470703125, 0],[262.2195739746094, 451.1794128417969, 0],[262.572509765625, 455.2380676269531, 0],[263.63128662109375, 459.6496276855469, 0],[264.86651611328125, 463.8847351074219, 0],[265.5723571777344, 469.53155517578125, 0],[264.86651611328125, 473.76666259765625, 0],[262.9254150390625, 476.5900573730469, 0],[260.2784729003906, 477.8252868652344, 0], [257.455078125, 476.7665100097656, 0]]));
var n2 = createNubs(reverseR([[256.2198486328125, 450.1206359863281, -30],[257.455078125, 450.47357177734375, -30],[259.0432434082031, 451.70880126953125, -30],[259.5726318359375, 453.4734191894531, -30],[259.5726318359375, 455.4145202636719, -30],[259.74908447265625, 457.3556213378906, -30],[260.63140869140625, 460.17901611328125, -30],[262.3960266113281, 463.3553466796875, -30],[262.74896240234375, 468.1198425292969, -30],[262.2195739746094, 471.4726257324219, -30],[260.9843444824219, 472.3549499511719, -30],[259.0432434082031, 472.3549499511719, -30],[257.27862548828125, 472.88433837890625, -30]]));
var n3 = createNubs(reverseR([[254.102294921875, 436.70947265625, -50],[255.3375244140625, 437.9447021484375, -50],[256.2198486328125, 440.062255859375, -50],[255.69046020507812, 442.00335693359375, -50],[254.102294921875, 443.4150390625, -50],[251.45535278320312, 443.9444274902344, -50],[250.04364013671875, 445.0032043457031, -50],[249.51425170898438, 446.9443054199219, -50],[249.51425170898438, 449.7677001953125, -50],[248.10255432128906, 452.2381896972656, -50],[245.27914428710938, 453.1205139160156, -50],[242.98513793945312, 451.70880126953125, -50], [242.6322021484375, 449.0618591308594, -50],[256.2198486328125, 450.1206359863281, -30],[257.455078125, 450.47357177734375, -30],[259.0432434082031, 451.70880126953125, -30],[259.5726318359375, 453.4734191894531, -30],[259.5726318359375, 455.4145202636719, -30],[259.74908447265625, 457.3556213378906, -30],[260.63140869140625, 460.17901611328125, -30],[262.3960266113281, 463.3553466796875, -30],[262.74896240234375, 468.1198425292969, -30],[262.2195739746094, 471.4726257324219, -30],[260.9843444824219, 472.3549499511719, -30],[259.0432434082031, 472.3549499511719, -30],[257.27862548828125, 472.88433837890625, -30]]));
var n4 = createNubs(reverseR([[250.57302856445312, 433.1802062988281, -70],[250.57302856445312, 434.5919189453125, -70],[251.1024169921875, 436.00360107421875, -70],[250.74949645996094, 437.76824951171875, -70],[248.63194274902344, 438.6505432128906, -70],[246.51438903808594, 437.76824951171875, -70],[245.27914428710938, 437.4153137207031, -70],[244.57330322265625, 437.5917663574219, -70],[244.39683532714844, 439.00347900390625, -70],[244.04391479492188, 440.5916442871094, -70],[242.45574951171875, 442.00335693359375, -70],[240.5146484375, 440.944580078125, -70],[240.16172790527344, 439.7093200683594, -70], [241.04403686523438, 438.4740905761719, -70]]));

var volumeSx = createBezierS1([n1,n2,n3,n4,nRac1Dx])
DRAW(COLOR(mattSteelBlue)(MAP(volumeSx)(domain2)));

//Boundary Sx
var n2up =createNubs(reverseR([[256.2198486328125, 450.1206359863281, 0],[257.455078125, 450.47357177734375, 0],[259.0432434082031, 451.70880126953125, 0],[259.5726318359375, 453.4734191894531, 0],[259.5726318359375, 455.4145202636719, 0],[259.74908447265625, 457.3556213378906, 0],[260.63140869140625, 460.17901611328125, 0],[262.3960266113281, 463.3553466796875, 0],[262.74896240234375, 468.1198425292969, 0],[262.2195739746094, 471.4726257324219, 0],[260.9843444824219, 472.3549499511719, 0],[259.0432434082031, 472.3549499511719, 0],[257.27862548828125, 472.88433837890625, 0]]));
var surBoundSx = createBezierS1([n1,n2up])
DRAW(COLOR(mattSkyBlue)(MAP(surBoundSx)(domain2)));

//________________________________________________________________________________PART 3_________________________________________________________________________________

//Dx Control curves

var n1 = createNubs([[274.63531494140625, 483.582275390625, 0],[278.9443664550781, 484.3004455566406, 0],[281.81707763671875, 483.1034851074219, 0],[284.45037841796875, 480.47015380859375, 0],[286.3655090332031, 476.8792724609375, 0],[288.5200500488281, 471.3732604980469, 0],[289.23822021484375, 467.064208984375, 0],[289.7170104980469, 460.6006164550781, 0],[286.84429931640625, 453.4188537597656, 0],[283.0140380859375, 449.5885925292969, 0],[275.5928649902344, 447.912841796875, 0]]);
var n2 = createNubs([[275.832275390625, 479.0338134765625, -40],[278.465576171875, 479.0338134765625, -40],[281.3382873535156, 478.3156433105469, -40],[283.9715881347656, 476.1611022949219, -40],[284.68975830078125, 471.85205078125, -40],[285.407958984375, 466.3460388183594, -40],[285.6473388671875, 460.1218566894531, -40],[283.7322082519531, 454.855224609375, -40],[281.3382873535156, 451.9825134277344, -40],[275.3534851074219, 450.5461730957031, -40]]);
var n3 = createNubs([[255.2445526123047, 452.4613037109375, -60],[259.7929992675781, 453.4188537597656, -60],[262.90509033203125, 452.4613037109375, -60],[264.5808410644531, 449.8279724121094, -60],[265.29901123046875, 447.1946716308594, -60],[265.29901123046875, 443.8431701660156, -60],[264.5808410644531, 439.7735290527344, -60],[263.3838806152344, 436.90081787109375, -60],[262.1869201660156, 434.0281066894531, -60],[260.51116943359375, 432.5917663574219, -60]]);
var n4 = createNubs([[248.3021697998047, 439.7735290527344, -80],[250.4567108154297, 441.2098693847656, -80],[251.65367126464844, 441.68865966796875, -80],[253.0900115966797, 441.68865966796875, -80],[254.76576232910156, 440.49169921875, -80],[255.4839324951172, 438.5765686035156, -80],[256.2021179199219, 435.9432373046875, -80],[256.9202880859375, 433.3099365234375, -80],[256.4414978027344, 430.4372253417969, -80],[255.4839324951172, 428.0433044433594, -80]]);

var volumeDx = createBezierS1([n1,n2,n3,n4,nRac1Dx])
DRAW(COLOR(mattSteelBlue)(MAP(volumeDx)(domain2)));

//Boundary Dx
var n2up= createNubs([[275.832275390625, 479.0338134765625, 0],[278.465576171875, 479.0338134765625, 0],[281.3382873535156, 478.3156433105469, 0],[283.9715881347656, 476.1611022949219, 0],[284.68975830078125, 471.85205078125, 0],[285.407958984375, 466.3460388183594, 0],[285.6473388671875, 460.1218566894531, 0],[283.7322082519531, 454.855224609375, 0],[281.3382873535156, 451.9825134277344, 0],[275.3534851074219, 450.5461730957031, 0]]);
var surBoundDx = createBezierS1([n1,n2up])
DRAW(COLOR(mattSkyBlue)(MAP(surBoundDx)(domain2)));

 //Sx Control curves 

var n1 = createNubs([[275.5928649902344, 447.912841796875, 0] ,[271.7626037597656, 448.6310119628906, 0],[268.6505126953125, 451.0249328613281, 0],[266.0171813964844, 454.6158142089844, 0],[265.7778015136719, 458.9248962402344, 0],[267.45355224609375, 463.47332763671875, 0],[269.84747314453125, 468.5005798339844, 0],[271.2838134765625, 472.3308410644531, 0],[270.5656433105469, 476.8792724609375, 0],[271.2838134765625, 481.6671142578125, 0], [274.63531494140625, 483.582275390625, 0]]);
var n2 = createNubs([[275.3534851074219, 450.5461730957031, -40],[272.48077392578125, 451.7431335449219, -40],[269.6080627441406, 453.89764404296875, -40],[268.6505126953125, 456.7703552246094, -40],[269.84747314453125, 460.3612365722656, -40],[271.7626037597656, 464.6702880859375, -40],[273.1989440917969, 468.9793395996094, -40],[273.1989440917969, 473.28839111328125, -40],[272.9595642089844, 477.83685302734375, -40], [275.832275390625, 479.0338134765625, -40]]);
var n3 = createNubs([[260.51116943359375, 432.5917663574219, -60],[258.8354187011719, 430.6766052246094, -60],[256.2021179199219, 430.6766052246094, -60],[254.76576232910156, 432.35235595703125, -60],[254.5263671875, 436.4220275878906, -60],[255.2445526123047, 439.0553283691406, -60],[257.1596984863281, 442.4068298339844, -60],[256.9202880859375, 445.279541015625, -60],[253.80819702148438, 447.6734619140625, -60],[253.32940673828125, 451.26434326171875, -60], [255.2445526123047, 452.4613037109375, -60]]);
var n4 = createNubs([[255.4839324951172, 428.0433044433594, -80],[253.80819702148438, 426.128173828125, -80],[252.37184143066406, 423.7342529296875, -80],[250.4567108154297, 423.2554626464844, -80],[247.82339477539062, 424.2130432128906, -80],[246.86582946777344, 426.6069641113281, -80],[247.3446044921875, 429.71905517578125, -80],[248.7809600830078, 431.6341857910156, -80],[249.02035522460938, 434.74627685546875, -80],[247.58399963378906, 436.90081787109375, -80], [248.3021697998047, 439.7735290527344, -80]]);

var volumeSx = createBezierS1([n1,n2,n3,n4,nRac1Sx])
DRAW(COLOR(mattSteelBlue)(MAP(volumeSx)(domain2)));

//Boundary Sx
var n2up =createNubs([[275.3534851074219, 450.5461730957031, 0],[272.48077392578125, 451.7431335449219, 0],[269.6080627441406, 453.89764404296875, 0],[268.6505126953125, 456.7703552246094, 0],[269.84747314453125, 460.3612365722656, 0],[271.7626037597656, 464.6702880859375, 0],[273.1989440917969, 468.9793395996094, 0],[273.1989440917969, 473.28839111328125, 0],[272.9595642089844, 477.83685302734375, 0], [275.832275390625, 479.0338134765625, 0]]);
var surBoundSx = createBezierS1([n1,n2up])
DRAW(COLOR(mattSkyBlue)(MAP(surBoundSx)(domain2)));



//________________________________________________________________________________PART 4_________________________________________________________________________________

//Dx Control curves

var n1 = createNubs([[249.03439331054688, 491.335693359375, 0],[249.93368530273438, 494.0335693359375, 0],[251.01284790039062, 497.45086669921875, 0],[253.171142578125, 501.2279052734375, 0],[256.228759765625, 504.10565185546875, 0],[260.0057678222656, 504.4653625488281, 0],[262.5238037109375, 503.38623046875, 0],[265.2216796875, 501.40777587890625, 0],[265.0418395996094, 496.7314453125, 0],[264.1425476074219, 494.3932800292969, 0],[264.8619689941406, 492.2349853515625, 0]]);
var n2 = createNubs([[252.4517059326172, 491.5155334472656, -70],[252.4517059326172, 493.13427734375, -70],[252.9912872314453, 495.4724426269531, -70],[254.61001586914062, 499.0696105957031, -70],[256.228759765625, 500.8681945800781, -70],[257.6676025390625, 501.7674865722656, -70],[259.2863464355469, 502.127197265625, -70],[261.44464111328125, 501.0480651855469, -70],[263.0633850097656, 499.9689025878906, -70],[262.8835144042969, 497.2710266113281, -70],[261.9842224121094, 494.75299072265625, -70],[262.34393310546875, 492.2349853515625, -70]]);
var n3 = createNubs([[242.0198974609375, 463.09783935546875, -80],[242.55947875976562, 465.79571533203125, -80],[243.99835205078125, 467.774169921875, -80],[246.51637268066406, 468.3137512207031, -80],[247.59552001953125, 468.1338806152344, -80],[249.7538299560547, 466.3352966308594, -80],[250.2934112548828, 464.177001953125, -80],[250.6531219482422, 462.5582580566406, -80],[250.11354064941406, 460.9395446777344, -80]]);
var n4 = createNubs([[233.02696228027344, 442.0543518066406, -6-50],[233.02696228027344, 445.65155029296875, -6-50],[233.74639892578125, 447.8098449707031, -6-50],[235.90469360351562, 448.529296875, -6-50],[237.88314819335938, 448.529296875, -6-50],[239.86158752441406, 447.8098449707031, -6-50],[240.76089477539062, 446.1911315917969, -6-50],[241.3004608154297, 444.75225830078125, -6-50],[241.3004608154297, 443.673095703125, -6-50],[241.3004608154297, 442.2342224121094, -6-50]]);

var volumeDx = createBezierS1([n1,n2,n3,n4,nRac1Dx])
DRAW(COLOR(mattSteelBlue)(MAP(volumeDx)(domain2)));

//Boundary Dx
var n2up= createNubs([[252.4517059326172, 491.5155334472656, 0],[252.4517059326172, 493.13427734375, 0],[252.9912872314453, 495.4724426269531, 0],[254.61001586914062, 499.0696105957031, 0],[256.228759765625, 500.8681945800781, 0],[257.6676025390625, 501.7674865722656, 0],[259.2863464355469, 502.127197265625, 0],[261.44464111328125, 501.0480651855469, 0],[263.0633850097656, 499.9689025878906, 0],[262.8835144042969, 497.2710266113281, 0],[261.9842224121094, 494.75299072265625, 0],[262.34393310546875, 492.2349853515625, 0]]);
var surBoundDx = createBezierS1([n1,n2up])
DRAW(COLOR(mattSkyBlue)(MAP(surBoundDx)(domain2)));

 //Sx Control curves 

var n1 = createNubs([[249.03439331054688, 491.335693359375, 0],[249.39410400390625, 489.7169494628906, 0],[250.4732666015625, 486.65936279296875, 0],[253.53086853027344, 482.88232421875, 0],[257.3078918457031, 481.80316162109375, 0],[263.9626770019531, 481.4434509277344, 0],[267.020263671875, 482.5226135253906, 0],[268.4591369628906, 484.1413269042969, 0],[268.4591369628906, 486.1197814941406, 0],[265.7612609863281, 490.6162414550781, 0],[ 264.8619689941406, 492.2349853515625, 0]]);
var n2 = createNubs([[252.4517059326172, 491.5155334472656, -70],[252.4517059326172, 490.07666015625, -70],[253.3509979248047, 486.65936279296875, -70],[256.4085998535156, 485.0406188964844, -70],[262.34393310546875, 483.60174560546875, -70],[265.0418395996094, 483.9614562988281, -70],[265.2216796875, 486.1197814941406, -70],[263.24322509765625, 488.6377868652344, -70],[ 262.34393310546875, 492.2349853515625, -70]]);
var n3 = createNubs([[242.0198974609375, 463.09783935546875, -80],[242.0198974609375, 460.579833984375, -80],[242.1997528076172, 459.1409606933594, -80],[243.99835205078125, 457.8819274902344, -80],[246.69622802734375, 456.9826354980469, -80],[249.39410400390625, 457.1625061035156, -80],[250.2934112548828, 458.2416687011719, -80],[250.2934112548828, 459.8603820800781, -80],[ 250.11354064941406, 460.9395446777344, -80]]);
var n4 = createNubs([[233.02696228027344, 442.0543518066406, -6-50],[233.20681762695312, 440.2557678222656, -6-50],[233.3866729736328, 438.6370544433594, -6-50],[234.10610961914062, 437.7377624511719, -6-50],[237.16371154785156, 437.5578918457031, -6-50],[238.6025848388672, 437.7377624511719, -6-50],[240.2213134765625, 439.3564758300781, -6-50],[ 241.3004608154297, 442.2342224121094, -6-50]]);

var volumeSx = createBezierS1([n1,n2,n3,n4,nRac1Sx])
DRAW(COLOR(mattSteelBlue)(MAP(volumeSx)(domain2)));

//Boundary Sx
var n2up =createNubs([[252.4517059326172, 491.5155334472656, 0],[252.4517059326172, 490.07666015625, 0],[253.3509979248047, 486.65936279296875, 0],[256.4085998535156, 485.0406188964844, 0],[262.34393310546875, 483.60174560546875, 0],[265.0418395996094, 483.9614562988281, 0],[265.2216796875, 486.1197814941406, 0],[263.24322509765625, 488.6377868652344, 0],[ 262.34393310546875, 492.2349853515625, 0]]);
var surBoundSx = createBezierS1([n1,n2up])
DRAW(COLOR(mattSkyBlue)(MAP(surBoundSx)(domain2)));


//--------------------------------------------------------------------------------CELL MEMBRANE------------------------------------------------------------------------------------------

var controlsMembraneEx1 = [[144.06448364257812,29.968891143798828-10,0],[244.06448364257812,27.968891143798828-10,-70],[316.0644836425781,28.968891143798828-10,-70],[412.0644836425781,28.968891143798828-10,0]]
var controlsMembraneEx2 = [[88.06449127197266,55.96889114379883-10,0],[231.06448364257812,56.96889114379883-10,-80],[326.0644836425781,56.96889114379883-10,-80],[470.0644836425781,57.96889114379883-10,0]]
var controlsMembraneEx3 = [[61.06448745727539,84.96888732910156,0],[215.06448364257812,85.96888732910156,-90],[342.0644836425781,85.96888732910156,-80],[513.064453125,85.96888732910156,0]]
var controlsMembraneEx4 = [[30.064489364624023,114.96888732910156,0],[201.06448364257812,112.96888732910156,-70],[358.0644836425781,113.96888732910156,-70],[540.064453125,114.96888732910156,0]]
var controlsMembraneEx5 = [[4.064489841461182,141.96888732910156,0],[187.06448364257812,143.96888732910156,-200],[368.0644836425781,142.96888732910156,-200],[569.064453125+10,140.96888732910156,0]]
var controlsMembraneEx6 = [[4.064489841461182,141.96888732910156,0],[187.06448364257812,143.96888732910156,-120],[368.0644836425781,142.96888732910156,-120],[569.064453125,140.96888732910156,0]]
var controlsMembraneEx7 = [[-21.935508728027344,170.96888732910156,0],[173.06448364257812,170.96888732910156,-130],[384.0644836425781,169.96888732910156,-130],[578.064453125,171.96888732910156,0]]
var controlsMembraneEx8 = [[-35.935508728027344,217.96888732910156,0],[144.06448364257812,216.96888732910156,-180],[396.0644836425781,219.96888732910156,-180],[606.064453125,221.96888732910156,0]]
var controlsMembraneEx9 = [[-50.935508728027344,274.9688720703125,0],[116.06449127197266,278.9688720703125,-200],[414.0644836425781,278.9688720703125,-200],[620.064453125,279.9688720703125,0]]
var controlsMembraneEx10 = [[-31.935508728027344,309.9688720703125,0],[144.06448364257812,309.9688720703125,-240],[398.0644836425781,308.9688720703125,-240],[607.064453125,309.9688720703125,0]]
var controlsMembraneEx11 = [[-18.935508728027344,350.9688720703125,0],[159.06448364257812,350.9688720703125,-200],[379.0644836425781,348.9688720703125,-200],[577.064453125,348.9688720703125,0]]
var controlsMembraneEx12 = [[-16.935508728027344,395.9688720703125,0],[171.06448364257812,396.9688720703125,-180],[358.0644836425781,395.9688720703125,-180],[589.064453125,396.9688720703125,0]]
var controlsMembraneEx13 = [[3.0644898414611816,438.9688720703125,0],[187.06448364257812,438.9688720703125,-130],[347.0644836425781,441.9688720703125,-130],[580.064453125,435.9688720703125,0]]
var controlsMembraneEx14 = [[20.064489364624023,466.9688720703125,0],[202.06448364257812,467.9688720703125,-120],[334.0644836425781,467.9688720703125,-120],[551.064453125,466.9688720703125,0]]
var controlsMembraneEx15 = [[35.06448745727539,493.9688720703125,0],[215.06448364257812,494.9688720703125,-100],[318.0644836425781,493.9688720703125,-100],[538.064453125,495.9688720703125,0]]
var controlsMembraneEx16 = [[61.06448745727539,520.9688720703125,0],[227.06448364257812,522.9688720703125,-70],[306.0644836425781,521.9688720703125,-70],[510.0644836425781,522.9688720703125,0]]
var controlsMembraneEx17 = [[103.06449127197266,552.9688720703125+10,0],[244.06448364257812,550.9688720703125+10,-80],[283.0644836425781,549.9688720703125+10,-80],[470.0644836425781,550.9688720703125+10,0]]
var controlsMembraneEx18 = [[142.06448364257812,579.9688720703125+10,0],[259.0644836425781,580.9688720703125+10,-70],[279.0644836425781,581.9688720703125+10,-70],[416.0644836425781,578.9688720703125+10,0]]

var curveExMembrane = createCurveSurface([270.756103515625,-13.5130615234375+30,0],[280.2683410644531,614.7684936523438-30,0], [controlsMembraneEx1, controlsMembraneEx2, controlsMembraneEx3, controlsMembraneEx4, controlsMembraneEx5, controlsMembraneEx6, controlsMembraneEx7, controlsMembraneEx8, controlsMembraneEx9, controlsMembraneEx10, controlsMembraneEx11, controlsMembraneEx12, controlsMembraneEx13, controlsMembraneEx14, controlsMembraneEx15, controlsMembraneEx16, controlsMembraneEx17, controlsMembraneEx18]);
DRAW(COLOR(mattBurlywood)(MAP(curveExMembrane)(domain3)));


var controlsMembraneIn1 = [[119.26834106445312,28.76850700378418-30,0],[225.26834106445312,28.76850700378418-30,-130],[343.2683410644531,28.76850700378418-30,-130],[440.2683410644531,28.76850700378418-30,0]]
var controlsMembraneIn2 = [[62.268341064453125,56.76850509643555-30,0],[214.26834106445312,58.76850509643555-30,-140],[356.2683410644531,57.76850509643555-30,-140],[497.2683410644531,58.76850509643555-30,0]]
var controlsMembraneIn3 = [[33.268341064453125,86.76850891113281,0],[185.26834106445312,86.76850891113281,-145],[391.2683410644531,86.76850891113281,-145],[538.268310546875,87.76850891113281,0]]
var controlsMembraneIn4 = [[2.268343210220337,114.76850128173828,0],[179.26834106445312,113.76850128173828,-150],[396.2683410644531,114.76850128173828,-150],[567.268310546875,116.76850128173828,0]]
var controlsMembraneIn5 = [[-54.73165512084961,170.7685089111328,0],[140.26834106445312,169.7685089111328,-270],[461.2683410644531,170.7685089111328,-270],[611.268310546875,170.7685089111328,0]]
var controlsMembraneIn6 = [[-74.73165130615234,219.7685089111328,0],[110.26834106445312,218.7685089111328,-200],[546.268310546875,219.7685089111328,-200],[645.268310546875,221.7685089111328,0]]
var controlsMembraneIn7 = [[-103.73165130615234,273.76849365234375,0],[55.268341064453125,274.76849365234375,-221.5],[515.268310546875,275.76849365234375,-221.5],[675.268310546875,274.76849365234375,0]]
var controlsMembraneIn8 = [[-74.73165130615234,309.76849365234375,0],[166.26834106445312,309.76849365234375,-250],[428.2683410644531,306.76849365234375,-250],[643.268310546875,309.76849365234375,0]]
var controlsMembraneIn9 = [[-52.73165512084961,349.76849365234375,0],[190.26834106445312,351.76849365234375,-250],[350.2683410644531,352.76849365234375,-250],[611.268310546875,347.76849365234375,0]]
var controlsMembraneIn10 = [[-55.73165512084961,393.76849365234375,0],[190.26834106445312,395.76849365234375,-221.5],[350.2683410644531,396.76849365234375,-221.5],[625.268310546875,395.76849365234375,0]]
var controlsMembraneIn11 = [[-25.731657028198242,438.76849365234375,0],[166.26834106445312,440.76849365234375,-200],[440.2683410644531,440.76849365234375,-200],[600.2683410644531,441.76849365234375,0]]
var controlsMembraneIn12 = [[-7.731656551361084,466.76849365234375,0],[210.26834106445312,468.76849365234375,-270],[350.2683410644531,468.76849365234375,-270],[578.268310546875,467.76849365234375,0]]
var controlsMembraneIn13 = [[2.268343210220337,494.76849365234375,0],[216.26834106445312,494.76849365234375,-150],[327.2683410644531,493.76849365234375,-150],[565.268310546875,496.76849365234375,0]]
var controlsMembraneIn14 = [[34.268341064453125,523.7684936523438,0],[227.26834106445312,522.7684936523438,-145],[307.2683410644531,522.7684936523438,-145],[537.268310546875,523.7684936523438,0]]
var controlsMembraneIn15 = [[76.26834106445312,550.7684936523438+20,0],[214.26834106445312,550.7684936523438+20,-140],[356.2683410644531,550.7684936523438+20,-140],[497.2683410644531,552.7684936523438+20,0]]
var controlsMembraneIn16 = [[119.26834106445312,581.7684936523438+20,0],[225.2683410644531,580.7684936523438+20,-130],[343.2683410644531,578.7684936523438+20,-130],[440.2683410644531,578.7684936523438+20,0]]

var curveInMembrane = createCurveSurface([270.2683410644531,28.76850700378418-30,0],[279.2683410644531,581.7684936523438+20,0], [controlsMembraneIn1, controlsMembraneIn2, controlsMembraneIn3, controlsMembraneIn4, controlsMembraneIn5, controlsMembraneIn6, controlsMembraneIn7, controlsMembraneIn8, controlsMembraneIn9, controlsMembraneIn10, controlsMembraneIn11, controlsMembraneIn12, controlsMembraneIn13, controlsMembraneIn14, controlsMembraneIn15, controlsMembraneIn16]);
DRAW(COLOR(mattBisque)(MAP(curveInMembrane)(domain3)));

createBezierS2([curveExMembrane, curveInMembrane], mattBisque)

//--------------------------------------------------------------------------AXON---------------------------------------------------------------------


var controls60 = createNubs([[-2.9284915924072266-35, 273.9616394042969, 0 ],[-3.0094761848449707-30, 288.55059814453125, -30 ],[-3.0094761848449707-30, 305.0794982910156, -30],[-3.0094761848449707-35, 319.3544921875, 0 ]])
var controls61 = createNubs(controlsPointTranslation([[-92.41593933105469, 281.0374450683594, 0 ],[-90.9133071899414, 293.0584716796875, -26.7],[-90.9133071899414, 311.8413391113281, -26.7],[-92.41593933105469, 322.3597412109375, 0 ]], -25,0,0));
var controls62 = createNubs(controlsPointTranslation([[-156.27769470214844, 269.7677307128906, 0 ],[-162.2882080078125, 277.2808532714844, -23.4],[-170.55267333984375, 286.296630859375, -23.4],[-181.82240295410156, 293.8097839355469, 0 ]], -25,0,0));
var controls63 = createNubs(controlsPointTranslation([[-215.63156127929688, 233.70460510253906, 0 ],[-223.89602661132812, 237.461181640625, -20.1],[-235.9170684814453, 241.9690704345703, -20.1],[-243.43020629882812, 242.7203826904297, 0 ]], -25,0,0));
var controls64 = createNubs(controlsPointTranslation([[-264.4670104980469, 201.39808654785156, 0 ],[-274.234130859375, 206.65728759765625, -16.8],[-289.2604064941406, 213.4191131591797, -16.8],[-295.27093505859375, 214.9217529296875, 0 ]], -25,0,0));
var controls65 = createNubs(controlsPointTranslation([[-358.3813781738281, 156.31919860839844, 0 ],[-360.63531494140625, 163.83233642578125, -13.5],[-364.39190673828125, 170.59417724609375, -13.5],[-367.39715576171875, 177.3560028076172, 0 ]], -25,0,0));
var controls66 = createNubs(controlsPointTranslation([[-472.58123779296875, 151.81130981445312, 0 ],[-474.0838623046875, 158.57313537597656, -10.2],[-476.3377990722656, 164.58364868164062, -10.2],[-479.2711181640625, 171.63917541503906, 0 ]], -25,0,0));
var controls67 = createNubs(controlsPointTranslation([[-617.5849609375, 181.8638916015625, 0 ],[-615.3310546875, 185.62046813964844, -6.9 ],[-612.3258056640625, 192.38230895996094, -6.9 ],[-609.3204956054688, 196.89019775390625, 0 ]], -25,0,0));
var controls68 = createNubs(controlsPointTranslation([[-712.2506103515625, 211.91648864746094, 0 ],[-712.2506103515625, 217.17568969726562, -3.6 ],[-712.2506103515625, 223.93753051757812, -3.6],[-712.2506103515625, 229.9480438232422, 0 ]], -25,0,0));
var curveAxonOpen = createBezierS1([controls60,controls61, controls62, controls63, controls64, controls65, controls66, controls67, controls68]);
DRAW(COLOR(mattBisque)(MAP(curveAxonOpen)(domain2)));


var controls69 = createNubs([[-3.023437976837158-35, 278.32452392578125, 0 ],[-3.342068672180176-30, 292.0256652832031, -25 ],[-3.342068672180176-30, 302.2218322753906, -25 ],[-3.023437976837158-35, 315.9229736328125, 0 ]])
var controls70 = createNubs(controlsPointTranslation([[-92.24007415771484, 284.05987548828125, 0 ],[-90.96554565429688, 296.4864807128906, -22.3],[-90.96554565429688, 308.9130859375, -22.3],[-92.24007415771484, 318.15338134765625, 0 ]], -25,0,0));
var controls71 = createNubs(controlsPointTranslation([[-158.1966552734375, 273.2264404296875, 0 ],[-165.20652770996094, 280.236328125,-19.6],[-167.75558471679688, 283.7412414550781,-19.6],[-176.67724609375, 289.79522705078125, 0 ]], -25,0,0));
var controls72 = createNubs(controlsPointTranslation([[-219.69239807128906, 235.3093719482422, 0 ],[-226.0650177001953, 238.4956817626953, -16.9],[-231.4817352294922, 240.407470703125, -16.9],[-238.4916229248047, 242.63787841796875, 0 ]], -25,0,0));
var controls73 = createNubs(controlsPointTranslation([[-269.3988037109375, 204.08355712890625, 0 ],[-278.0018310546875, 208.5443878173828, -14.2],[-283.4185791015625, 211.0934295654297, -14.2],[-291.0657043457031, 213.9611053466797, 0 ]], -25,0,0));
var controls74 = createNubs(controlsPointTranslation([[-359.2527160644531, 160.43112182617188, 0 ],[-361.8017578125, 165.52920532226562, -11.5],[-363.7135314941406, 169.03414916992188, -11.5],[-365.62530517578125, 173.1763458251953, 0 ]], -25,0,0));
var controls75 = createNubs(controlsPointTranslation([[-473.3225402832031, 156.28890991210938, 0 ],[-474.91571044921875, 160.43112182617188, -8.8],[-475.87158203125, 162.66152954101562, -8.8],[-478.10198974609375, 167.1223602294922, 0 ]], -25,0,0));
var controls76 = createNubs(controlsPointTranslation([[-615.82177734375, 184.527587890625, 0 ],[-614.562744140625, 186.68588256835938, -6.1],[-613.3037719726562, 189.38377380371094, -6.1],[-611.68505859375, 193.52052307128906, 0 ]], -25,0,0));
var controls77 = createNubs(controlsPointTranslation([[-712.0462036132812, 215.82301330566406, 0 ],[-712.4059448242188, 219.42018127441406,-3.4],[-712.4059448242188, 221.3986358642578, -3.4],[-712.5857543945312, 225.35552978515625, 0 ]], -25,0,0));
var curveAxonOpenInner = createBezierS1([controls69,controls70, controls71, controls72, controls73, controls74, controls75, controls76, controls77]);
DRAW(COLOR(mattBisque)(MAP(curveAxonOpenInner)(domain2)));

createBezierS2([curveAxonOpenInner, curveAxonOpen], mattBisque);

var controls61 = [[-2.9284915924072266-35,273.9616394042969,0],[-3.0094761848449707-30,288.55059814453125,0],[-3.0094761848449707-30,305.0794982910156,0],[-3.0094761848449707-35,319.3544921875,0]]
var controls79 =  createNubs(controlsPointTranslation([[-3.6292459964752197,292.3113708496094,0],[-3.6292459964752197,294.86041259765625,0],[-3.9478769302368164,296.7721862792969,0],[-3.6292459964752197,300.9143981933594,0]], -35,0,0));
var controls80 =  createNubs(controlsPointTranslation([[-90.93409729003906,296.45355224609375,0],[-90.93409729003906,299.0025939941406,0],[-90.93409729003906,303.7820739746094,0],[-90.93409729003906,308.8801574707031,0]], -35,-8,0));
var controls81 =  createNubs(controlsPointTranslation([[-162.30740356445312,277.335693359375,0],[-165.49371337890625,279.884765625,0],[-167.40550231933594,284.3455810546875,0],[-169.9545440673828,285.9387512207031,0]], -35,-3,0));
var controls82 =  createNubs(controlsPointTranslation([[-224.1217803955078,238.1441192626953,0],[-226.67083740234375,238.46275329589844,0],[-231.1316680908203,240.05589294433594,0],[-235.9111328125,242.28631591796875,0]], -35,-8,0));
var controls83 =  createNubs(controlsPointTranslation([[-274.1468200683594,206.91830444335938,0],[-278.2890319824219,208.83009338378906,0],[-283.0685119628906,211.0605010986328,0],[-288.4852294921875,212.9722900390625,0]], -35,-14,0));
var controls84 =  createNubs(controlsPointTranslation([[-361.1330871582031,163.5845184326172,0],[-362.0889587402344,165.81492614746094,0],[-363.68212890625,169.00123596191406,0],[-364.9566345214844,171.23165893554688,0]], -35,+2,0));
var controls85 =  createNubs(controlsPointTranslation([[-473.6097717285156,158.48641967773438,0],[-474.88427734375,160.7168426513672,0],[-475.8401794433594,162.94725036621094,0],[-476.4774475097656,164.22177124023438,0]], -35,+8,0));
var controls86 =  createNubs(controlsPointTranslation([[-615.0818481445312,186.20730590820312,0],[-614.76318359375,187.16319274902344,0],[-613.4887084960938,189.07498168945312,0],[-612.2141723632812,190.6681365966797,0]], -35,+1,0));
var controls87 =  createNubs(controlsPointTranslation([[-712.2642211914062,216.79586791992188,0],[-712.9014892578125,219.34490966796875,0],[-712.2642211914062,221.25669860839844,0],[-711.9456176757812,223.16847229003906,0]], -25,0,0));
var curveAxonOpenInner2 = createBezierS1([controls79, controls80, controls81, controls82, controls83, controls84, controls85, controls86, controls87]);
DRAW(COLOR(mattIndianRed)(MAP(curveAxonOpenInner2)(domain2)));


var con1 = controlsPointTranslation([[-712.2506103515625,211.91648864746094,0],[-712.2506103515625,217.17568969726562,-3],[-712.2506103515625,223.93753051757812,-3],[-712.2506103515625,229.9480438232422,0]], -25,0,0);
var con2 = controlsPointTranslation([[-721.296630859375,206.88430786132812,0],[-721.296630859375,216.48036193847656,-5],[-721.861083984375,223.25405883789062,-5],[-721.861083984375,236.80142211914062,0]], -25,0,0);
var con3 = controlsPointTranslation([[-732.5861206054688,201.80404663085938,0],[-732.0216674804688,216.48036193847656,-8],[-732.0216674804688,222.12510681152344,-8],[-732.0216674804688,241.3172149658203,0]], -25,0,0);
var con4 = controlsPointTranslation([[-743.8756103515625,197.2882537841797,0],[-743.3110961914062,213.6580047607422,-10],[-742.7466430664062,222.12510681152344,-10],[-743.8756103515625,247.52642822265625,0]], -25,0,0);
var con5 = controlsPointTranslation([[-753.4716186523438,202.36851501464844,0],[-753.4716186523438,214.7869415283203,-8],[-753.4716186523438,219.86721801757812,-8],[-755.1651000976562,239.62379455566406,0]], -25,0,0);
var con6 = controlsPointTranslation([[-761.9387817382812,208.57772827148438,0],[-762.5032348632812,216.48036193847656,-5],[-762.5032348632812,222.12510681152344,-5],[-763.6322021484375,232.85011291503906,0]], -25,0,0);
var finalpoint = [-770.4058837890625-18,220.99615478515625,0];
var curveSinapsiOuter = createCurveSurface2(finalpoint, [con1, con2, con3, con4, con5, con6]); 
DRAW(COLOR(mattBisque)(MAP(curveSinapsiOuter)(domain2)));

var con7 = controlsPointTranslation([[-712.2506103515625,211.91648864746094,0],[-712.2506103515625,217.17568969726562,-2],[-712.2506103515625,223.93753051757812,-2],[-712.2506103515625,229.9480438232422,0]], -25,0,0);
var con8 = controlsPointTranslation([[-715.7742309570312,214.36476135253906,0],[-715.0548095703125,219.58065795898438,-4],[-715.234619140625,223.35769653320312,-4],[-715.0548095703125,227.31459045410156,0]], -25,0,0);
var con9 = controlsPointTranslation([[-721.5297241210938,211.12730407714844,0],[-721.1699829101562,216.34320068359375,-6],[-721.889404296875,223.35769653320312,-6],[-722.0692749023438,232.3506317138672,0]], -25,0,0);
var con10 = controlsPointTranslation([[-732.5010986328125,207.53012084960938,0],[-731.601806640625,216.34320068359375,-8],[-732.3212280273438,221.7389678955078,-8],[-731.601806640625,235.22837829589844,0]], -25,0,0);
var con11 = controlsPointTranslation([[-743.65234375,203.75308227539062,0],[-743.65234375,214.1848907470703,-6],[-742.7530517578125,222.45840454101562,-6],[-743.8322143554688,240.6241455078125,0]], -25,0,0);
var con12 = controlsPointTranslation([[-753.3646850585938,207.3502655029297,0],[-753.1848754882812,215.80361938476562,-4],[-753.5445556640625,219.76051330566406,-4],[-754.8035888671875,234.6887969970703,0]], -25,0,0);
var con13 = controlsPointTranslation([[-762.357666015625,212.02659606933594,0],[-762.357666015625,218.68136596679688,-2],[-762.1777954101562,224.25698852539062,-2],[-763.0770874023438,227.8541717529297,0]], -25,0,0);
var finalpoint2 = [-767.2138671875-20,221.01953125,0];
var curveSinapsiInner = createCurveSurface2(finalpoint, [con7, con8, con9, con10, con11, con12, con13]); 
DRAW(COLOR(mattBisque)(MAP(curveSinapsiInner)(domain2)));

createBezierS2([curveSinapsiInner, curveSinapsiOuter], mattBisque);

var controlsMicrofilament = [[-3.6292459964752197-35,292.3113708496094+15,0],[-90.93409729003906-35,296.45355224609375+5,0],[-162.30740356445312-35,277.335693359375-2,0],[-162.30740356445312-35,277.335693359375-3,0],[-224.1217803955078-55,238.1441192626953,0],[-274.1468200683594-85,206.91830444335938-4,0],[-361.1330871582031+3,163.5845184326172+42,-5]]
var nubsMicrofilament = createNubs(controlsMicrofilament);
DRAW(COLOR(mattGold)(MAP(nubsMicrofilament)(domain1)));

var controlsMicrofilament2 = [[-3.6292459964752197-35,292.3113708496094+20,0],[-90.93409729003906-35,296.45355224609375+10,0],[-162.30740356445312-50,277.335693359375-10,0],[-162.30740356445312-35,277.335693359375-3,0],[-224.1217803955078-55,238.1441192626953,0],[-274.1468200683594-85,206.91830444335938-4,0],[-361.1330871582031+3,163.5845184326172+42,-5]]
var nubsMicrofilament2 = createNubs(controlsMicrofilament2);
DRAW(COLOR(mattGold)(MAP(nubsMicrofilament2)(domain1)));

var controlsMicrofilament3 = [[-3.6292459964752197-35,292.3113708496094-5,0],[-90.93409729003906-35,296.45355224609375-10,0],[-162.30740356445312-55,277.335693359375-28,0],[-162.30740356445312-35,277.335693359375-20,0],[-224.1217803955078-55,238.1441192626953-12,0],[-274.1468200683594-85,206.91830444335938-10,0],[-361.1330871582031-100,163.5845184326172+30,0]]
var nubsMicrofilament3 = createNubs(controlsMicrofilament3);
var prova = COLOR(mattGold)(MAP(nubsMicrofilament3)(domain1));
DRAW(prova);


var controlsMicrofilament3 = [[-3.6292459964752197-35,292.3113708496094-5,0],[-90.93409729003906-10,296.45355224609375-15,0],[-162.30740356445312+25,277.335693359375-1,0],[-224.1217803955078+15,238.1441192626953+12,0],[-274.1468200683594,206.91830444335938+18,0],[-361.1330871582031+13,163.5845184326172+32.5,0]]
var nubsMicrofilament3 = createNubs(controlsMicrofilament3);
DRAW(COLOR(mattGold)(MAP(nubsMicrofilament3)(domain1)));

var controlsMicrofilament4 = [[-3.6292459964752197-35,292.3113708496094-10,0],[-90.93409729003906-35,296.45355224609375-15,0],[-162.30740356445312-55,277.335693359375-28,0],[-162.30740356445312-35,277.335693359375-20,0],[-224.1217803955078-55,238.1441192626953-12,0],[-274.1468200683594-85,206.91830444335938-10,0],[-361.1330871582031-100,163.5845184326172+30,0]]
var nubsMicrofilament4 = createNubs(controlsMicrofilament4);
var prova = COLOR(mattGold)(MAP(nubsMicrofilament4)(domain1));
DRAW(prova);

var controls88 = [[-719.559326171875,211.6128692626953-3,-2],[-715.6080322265625,211.6128692626953-3,-2.5],[-709.3988037109375,211.6128692626953-3,-2.5],[-707.1409301757812,210.48391723632812-3,-2]]
var controls89 = [[-724.0751342773438,207.09707641601562,-3],[-722.3817138671875,207.09707641601562,-3.75],[-720.6882934570312,205.96812438964844,-3.75],[-718.430419921875,205.40365600585938,-3]]
var controls90 = [[-735.3646240234375,197.5010223388672,-3],[-733.6712036132812,195.80760192871094,-3.25],[-732.542236328125,195.80760192871094,-3.25],[-731.413330078125,194.1141815185547,-3]]
var controls91 = [[-760.2014770507812,169.841796875,-3],[-757.943603515625,168.14837646484375,-3.125],[-756.490966796875,143.3115234375,-3.125],[-755.3619995117188,142.74703979492188,-3]]
var controls92 = [[-766.9751586914062,142.74703979492188,-3],[-773.7488403320312,117.34571838378906,-3.1],[-771.490966796875,116.78124237060547,-3.1],[-769.7975463867188,116.78124237060547,-3]]
var finalPoint7 = [-761.8948974609375,80.6549072265625,-3];

var curveDendrite1Under = createCurveSurface2(finalPoint7, [controls88, controls89, controls90, controls91, controls92]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite1Under)(domain2)));

var controls88 = [[-719.559326171875,211.6128692626953-3,-2],[-715.6080322265625,211.6128692626953-3,-2.5],[-709.3988037109375,211.6128692626953-3,-2.5],[-707.1409301757812,210.48391723632812-3,-2]];
var controls89 = [[-724.0751342773438,207.09707641601562,-3],[-722.3817138671875,207.09707641601562,-2.1],[-720.6882934570312,205.96812438964844,-2.1],[-718.430419921875,205.40365600585938,-3]]
var controls90 = [[-735.3646240234375,197.5010223388672,-3],[-733.6712036132812,195.80760192871094,-2.125],[-732.542236328125,195.80760192871094,-2.125],[-731.413330078125,194.1141815185547,-3]]
var controls91 = [[-760.2014770507812,169.841796875,-3],[-757.943603515625,168.14837646484375,-2.25],[-756.490966796875,143.3115234375,-2.25],[-755.3619995117188,142.74703979492188,-3]]
var controls92 = [[-766.9751586914062,142.74703979492188,-3],[-773.7488403320312,117.34571838378906,-2.75],[-771.490966796875,116.78124237060547,-2.75],[-769.7975463867188,116.78124237060547,-3]]
var finalPoint7 = [-761.8948974609375,80.6549072265625,-3];

var curveDendrite1Upper = createCurveSurface2(finalPoint7, [controls88, controls89, controls90, controls91, controls92]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite1Upper)(domain2)));


var controls93 = [[-767.7393798828125+4,113.60464477539062,-3],[-767.7393798828125+4,116.23796081542969,-3],[-767.7393798828125+4,117.91370391845703,-3],[-767.7393798828125+4.5,120.06822967529297,-3]]
var controls94 = controlsPointTranslation([[-764.3878784179688,115.04100036621094,0],[-764.1484985351562,115.99856567382812,0],[-763.9090576171875,117.43492126464844,0],[-763.669677734375,118.87126922607422,0]], 0,0,-3);
var controls95 = controlsPointTranslation([[-759.8394165039062,113.84403991699219,0],[-759.6000366210938,115.28038787841797,0],[-759.8394165039062,116.47734832763672,0],[-759.8394165039062,117.91370391845703,0]], 0,0,-3);
var controls96 = controlsPointTranslation([[-755.0515747070312,112.88646697998047,0],[-755.0515747070312,113.60464477539062,0],[-754.5728149414062,114.56221771240234,0],[-754.5728149414062,115.51978302001953,0]], 0,0,-3);
var finalPoint8 = [-749.5455322265625,113.12586212158203,-3]

var curveDentrite1 = createCurveSurface2(finalPoint8, [controls93, controls94, controls95, controls96]);
DRAW(COLOR(mattBisque)(MAP(curveDentrite1)(domain2)))

var con14 = [[-768.1600341796875+9,134.2810516357422,-3],[-767.9569702148438+9,134.68714904785156,-3],[-767.5508422851562+9,135.2963104248047,-3],[-767.144775390625+9,135.60089111328125,-3]]
var con15 = [[-762.373046875,130.9307098388672,-3],[-762.1699829101562,131.13375854492188,-3],[-762.0684814453125,131.53985595703125,-3],[-761.763916015625,131.8444366455078,-3]]
var con16 = [[-752.322021484375,123.3162841796875,-3],[-751.9158935546875,123.51934051513672,-3],[-751.611328125,123.62086486816406,-3],[-751.3067626953125,123.82391357421875,-3]]
var finalPoint9 = [-741.0526733398438,113.87440490722656,-3];
var curveDendrite2 = createCurveSurface2(finalPoint9,[con14, con15, con16]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite2)(domain2)));

var con17 = [[-745.0995483398438-0.1,117.72412872314453,-3],[-744.9276123046875-0.1,117.60951232910156,-3],[-744.84716796875-0.1,117.5472412109375,-3],[-744.7501220703125-0.1,117.48253631591797,-3]]
var con18 = [[-745.88232421875,115.44454193115234,-3],[-745.817626953125,115.44454193115234,0-3],[-745.7852783203125,115.41219329833984,-3],[-745.7852783203125,115.41219329833984,-3]]
var finalpoint10 = [-746.335205078125,113.37419128417969,-3]
var curveDendrite3 = createCurveSurface2(finalpoint10, [con17, con18]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite3)(domain2)))

var con19 = [[-745.7793579101562,115.40352630615234,-3],[-745.7930908203125,115.36236572265625,-3],[-745.7930908203125,115.32121276855469,-3],[-745.8067626953125,115.2800521850586,-3]]
var finalPoint11 = [-744.4348754882812,113.90812683105469,-3];
var curveDendrite4 = createCurveSurface2(finalPoint11, [con19]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite4)(domain2)));

var con20 = [[-745.8746337890625,115.33885955810547,-3],[-745.8746337890625,115.31558227539062,-3],[-745.8746337890625,115.28649139404297,-3],[-745.8746337890625,115.25740051269531,-3]]
var finalPoint12 = [-747.1138916015625,114.48356628417969,-3]
var curveDendrite5 = createCurveSurface2(finalPoint12, [con20]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite5)(domain2)));

var con21 = [[-742.810791015625,115.546142578125-0.1,-3],[-742.7560424804688,115.49136352539062-0.1,-3],[-742.6829833984375,115.49136352539062-0.1,-3],[-742.6829833984375,115.45484161376953-0.1,-3]]
var finalPoint13 = [-743.084716796875,114.15836334228516,-3]
var curveDendrite6 = createCurveSurface2(finalPoint13, [con21]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite6)(domain2)));

var con22 = [[-742.0177612304688-0.1,114.8627700805664,-3],[-741.9945068359375-0.1,114.83179473876953,-3],[-741.9867553710938-0.1,114.79307556152344,-3],[-741.9635620117188-0.1,114.76984405517578,-3]]
var finalPoint14 = [-740.848388671875,114.98667907714844,-3]
var curveDendrite7 = createCurveSurface2(finalPoint14, [con22]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite7)(domain2)));

var con23 = [[-775.4422607421875+15,125.24835205078125,-3],[-776.0067138671875+15,126.3772964477539,-3],[-776.0067138671875+15,126.3772964477539,-3],[-776.5712280273438+15,128.63519287109375,-3]]
var con24 = [[-785.602783203125,109.44307708740234,-3],[-786.1672973632812,109.44307708740234,-3],[-786.7317504882812,111.13650512695312,-3],[-788.4251708984375,112.26544952392578,-3]]
var finalPoint15 = [-811.568603515625,91.37991333007812,-3]
var curveDendrite8 = createCurveSurface2(finalPoint15, [con23, con24]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite8)(domain2)));

var con25 = [[-804.758056640625,97.09049224853516,-3],[-804.6607666015625,97.15713500976562,-3],[-804.6058959960938,97.19828796386719,-3],[-804.551025390625,97.2257308959961,-3]]
var finalPoint16 = [-804.1952514648438,92.71627807617188,-3];
var curveDendrite9 = createCurveSurface2(finalPoint16, [con25]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite9)(domain2)));

var con26 = [[-804.758056640625,97.09049224853516,-3],[-804.6607666015625,97.15713500976562,-3],[-804.6058959960938,97.19828796386719,-3],[-804.551025390625,97.2257308959961,-3]]
var finalPoint17 = [-811.6441040039062,96.11776733398438,-3]
var curveDendrite10 = createCurveSurface2(finalPoint17, [con26]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite10)(domain2)));

var con27 = [[-804.324462890625-0.1,94.69689178466797-0.1,-3],[-804.3674926757812-0.05,94.82606506347656-0.05,-3],[-804.3674926757812-0.1,94.82606506347656-0.1,-3],[-804.3674926757812-0.02,95.08440399169922-0.1,-3]]
var finalpoint11 = [-801.5257568359375,94.52466583251953,-3];
var curveDendrite11 = createCurveSurface2(finalpoint11, [con27]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite11)(domain2)));

//--------------------------------------------------------------------------------NEURON DENDRITE 1 -------------------------------------------------------------------------------------------

var controls12 = controlsPointTranslation([[531.6243896484375, 439.8178405761719, 0],[536.14013671875-10, 433.0441589355469-20, -20],[541.0733642578125-10, 423.8709411621094-20, -20],[545.7362060546875, 412.15863037109375, 0]],-60,0,-100)
var controls13 = controlsPointTranslation([[596.7022705078125, 475.6723327636719, 0 ],[599.8886108398438, 469.9369812011719, -16.6 ],[603.0748901367188, 464.8388671875, -16.6 ],[606.2611694335938, 458.7848815917969, 0 ]], -60,0,-100);
var controls14 = controlsPointTranslation([[651.1881713867188, 531.4327392578125, 0 ],[654.0897216796875, 528.93310546875, -13.2],[658.197998046875, 525.6973876953125, -13.2 ],[662.9774780273438, 521.873779296875, 0 ]], -60,0,-100);
var controls15 = controlsPointTranslation([[697.162109375, 626.8892822265625, 0 ],[700.8946533203125, 624.1543579101562, -9.8 ],[708.22314453125, 620.330810546875, -9.8 ],[712.4564208984375, 619.2421264648438, 0 ]], -60,0,-100);
var controls16 = controlsPointTranslation([[735.7164916992188, 683.2869262695312, 0 ],[739.767578125, 681.1892700195312, -6.4 ],[745.8215942382812, 678.6402587890625, -6.4 ],[750.0548706054688, 677.23291015625, 0 ]], -60,0,-100);
var controls17 = controlsPointTranslation([[794.7738037109375, 746.343017578125, 0 ],[797.779052734375, 740.33251953125, -3.0 ],[799.2816772460938, 735.0733032226562, -3.0 ],[801.5355834960938, 728.3114624023438, 0 ]], -60,0,-100);
var controls18 = controlsPointTranslation([[898.9223022460938, 776.568359375, 0 ],[901.18017578125, 771.4880981445312, 0 ],[902.8735961914062, 766.4078369140625, 0 ],[904.0025634765625, 761.8920288085938, 0 ]], -60,0,-100);
var finalPoint1 = [1016.767822265625-60, 819.8773803710938, -50 ];
var curveNeuron1Under = createCurveSurface2(finalPoint1, [controls12, controls13, controls14, controls15, controls16, controls17, controls18]);
DRAW(COLOR(mattBisque)(MAP(curveNeuron1Under)(domain2)));

var controls12 = controlsPointTranslation([[531.6243896484375, 439.8178405761719, 0],[536.14013671875+10, 433.0441589355469+20, 20],[541.0733642578125+10, 423.8709411621094+20, 20],[545.7362060546875, 412.15863037109375, 0]],-60,0,-100)
var controls13 = controlsPointTranslation([[596.7022705078125, 475.6723327636719, 0 ],[599.8886108398438, 469.9369812011719, 16.6 ],[603.0748901367188, 464.8388671875, 16.6 ],[606.2611694335938, 458.7848815917969, 0 ]], -60,0,-100);
var controls14 = controlsPointTranslation([[651.1881713867188, 531.4327392578125, 0 ],[654.0897216796875, 528.93310546875, 13.2],[658.197998046875, 525.6973876953125, 13.2 ],[662.9774780273438, 521.873779296875, 0 ]], -60,0,-100);
var controls15 = controlsPointTranslation([[697.162109375, 626.8892822265625, 0 ],[700.8946533203125, 624.1543579101562, 9.8 ],[708.22314453125, 620.330810546875, 9.8 ],[712.4564208984375, 619.2421264648438, 0 ]], -60,0,-100);
var controls16 = controlsPointTranslation([[735.7164916992188, 683.2869262695312, 0 ],[739.767578125, 681.1892700195312, 6.4 ],[745.8215942382812, 678.6402587890625, 6.4 ],[750.0548706054688, 677.23291015625, 0 ]], -60,0,-100);
var controls17 = controlsPointTranslation([[794.7738037109375, 746.343017578125, 0 ],[797.779052734375, 740.33251953125, 3.0 ],[799.2816772460938, 735.0733032226562, 3.0 ],[801.5355834960938, 728.3114624023438, 0 ]], -60,0,-100);
var controls18 = controlsPointTranslation([[898.9223022460938, 776.568359375, 0 ],[901.18017578125, 771.4880981445312, 0 ],[902.8735961914062, 766.4078369140625, 0 ],[904.0025634765625, 761.8920288085938, 0 ]], -60,0,-100);

var curveNeuron1Upper = createCurveSurface2(finalPoint1, [controls12, controls13, controls14, controls15, controls16, controls17, controls18]);
DRAW(COLOR(mattBisque)(MAP(curveNeuron1Upper)(domain2)));

//----------------------------------------------------------------------------------------BRANCH------------------------------------------------------------------------------------------------

var controls23 = controlsPointTranslation([[701.4566040039062, 594.3966064453125, 0],[703.7144775390625, 599.4768676757812, -10],[705.972412109375, 603.4281616210938, -10],[708.7947998046875, 610.2018432617188, 0]],-65,0,-100);
var controls24 = controlsPointTranslation([[775.9671630859375, 538.513671875, 0],[779.6598510742188, 543.3978271484375, -8],[784.998779296875, 547.5452270507812, -8],[789.5145263671875, 555.4478759765625, 0]], -60,0,-100);
var controls25 = controlsPointTranslation([[808.7066650390625, 508.5965270996094, 0],[812.0556030273438, 514.9810180664062, -6],[815.8792114257812, 521.6723022460938, -6],[820.5606079101562, 528.9176025390625, 0]], -60,0,-100);
var controls26 = controlsPointTranslation([[890.7574462890625, 521.6723022460938, 0],[887.8897705078125, 527.0889892578125, -4],[885.0220947265625, 532.5057373046875, -4],[881.5171508789062, 538.8783569335938, 0]], -60,0,-100);
var controls27 = controlsPointTranslation([[941.4197387695312, 535.0547485351562, 0],[941.7384033203125, 538.8783569335938, -2],[942.0570068359375, 543.6577758789062, -2],[942.6942749023438, 548.7559204101562, 0]], -60,0,-100);
var controls28 = controlsPointTranslation([[984.4349365234375, 505.4220886230469, 0],[986.25732421875, 507.2715148925781, 0],[987.6212158203125, 509.8829345703125, 0],[989.21435546875, 512.1133422851562, 0]], -65,0,-100);
var finalPoint2 = [997.2630004882812-60,451.7737731933594,-150]

var curveNeuron2Under = createCurveSurface2(finalPoint2, [controls23, controls24, controls25, controls26, controls27, controls28]);
DRAW(COLOR(mattBisque)(MAP(curveNeuron2Under)(domain2)));

var controls23 = controlsPointTranslation([[701.4566040039062, 594.3966064453125, 0],[703.7144775390625, 599.4768676757812, 10],[705.972412109375, 603.4281616210938, 10],[708.7947998046875, 610.2018432617188, 0]],-65,0,-100);
var controls24 = controlsPointTranslation([[775.9671630859375, 538.513671875, 0],[779.6598510742188, 543.3978271484375, 8],[784.998779296875, 547.5452270507812, 8],[789.5145263671875, 555.4478759765625, 0]], -60,0,-100);
var controls25 = controlsPointTranslation([[808.7066650390625, 508.5965270996094, 0],[812.0556030273438, 514.9810180664062, 6],[815.8792114257812, 521.6723022460938, 6],[820.5606079101562, 528.9176025390625, 0]], -60,0,-100);
var controls26 = controlsPointTranslation([[890.7574462890625, 521.6723022460938, 0],[887.8897705078125, 527.0889892578125, 4],[885.0220947265625, 532.5057373046875, 4],[881.5171508789062, 538.8783569335938, 0]], -60,0,-100);
var controls27 = controlsPointTranslation([[941.4197387695312, 535.0547485351562, 0],[941.7384033203125, 538.8783569335938, 2],[942.0570068359375, 543.6577758789062, 2],[942.6942749023438, 548.7559204101562, 0]], -60,0,-100);
var controls28 = controlsPointTranslation([[984.4349365234375, 505.4220886230469, 0],[986.25732421875, 507.2715148925781, 0],[987.6212158203125, 509.8829345703125, 0],[989.21435546875, 512.1133422851562, 0]], -65,0,-100);

var curveNeuron2Upper = createCurveSurface2(finalPoint2, [controls23, controls24, controls25, controls26, controls27, controls28]);
DRAW(COLOR(mattBisque)(MAP(curveNeuron2Upper)(domain2)));


//-------------------------------------------------------------------------------NEURON DENTRITE 2----------------------------------------------------------------------

var controls35 = controlsPointTransformation([[250.13494873046875,296.8428649902344-100,300],[274.1138610839844,296.71685791015625-100,300+40],[293.1138610839844,296.71685791015625-100,300+40],[313.9111328125,295.0713195800781-100,300]]);
var controls36 = controlsPointTransformation([[254.6446990966797, 351.1073913574219-100,300+40],[253.6783447265625,318.5879211425781-100,300+36.4+40],[276.7083740234375,319.8731689453125-100,300+36.4+40],[308.43231201171875,320.2813415527344-100,300+40]]);
var controls37 = controlsPointTransformation([[226.0191192626953,353.02081298828125-100,300+76],[248.36338806152344,351.7612609863281-100,300+32.8+76],[287.3377380371094,349.98968505859375-100,300+32.8+76],[305.0533447265625,349.98968505859375-100,300+76]]);
var controls38 = controlsPointTransformation([[244.8202667236328,385.4209289550781-100,300+112],[264.30743408203125,385.4209289550781-100,300+29.2+112],[296.1955261230469,385.4209289550781-100,300+29.2+112],[315.6827087402344,383.64935302734375-100,300+112]]);
var controls39 = controlsPointTransformation([[264.30743408203125,419.08056640625-100,300+148],[280.2514953613281,419.08056640625-100,300+25.6+148],[305.0533447265625,417.30902099609375-100,300+25.6+148],[320.99737548828125,417.30902099609375-100,300+148]]);
var controls40 = controlsPointTransformation([[271.3936767578125,449.1971130371094-100,300+184],[283.79461669921875,447.425537109375-100,300+22+184],[308.5964660644531,447.425537109375-100,300+22+184],[331.6267395019531,447.425537109375-100,300+184]])
var controls41 = controlsPointTransformation([[280.2514953613281,484.6283264160156-100,300+220],[292.65240478515625,482.8567810058594-100,300+18.4+220],[313.9111328125,484.6283264160156-100,300+18.4+220],[331.6267395019531,484.6283264160156-100,300+220]])
var controls42 = controlsPointTransformation([[280.2514953613281,514.744873046875-100,300+256],[289.1092834472656,518.2879638671875-100,300+14.8+256],[301.5102233886719,518.2879638671875-100,300+14.8+256],[312.13958740234375,520.0595703125-100,300+256]])
var controls43 = controlsPointTransformation([[264.30743408203125,555.4907836914062-100,300+292],[276.7083740234375,555.4907836914062-100,300+11.2+292],[290.880859375,555.4907836914062-100,300+11.2+292],[299.7386474609375,555.4907836914062-100,300+292]])
var controls44 = controlsPointTransformation([[260.7643127441406,585.6072998046875-100,300+328],[269.6221008300781,583.8357543945312-100,300+7.6+328],[276.7083740234375,583.8357543945312-100,300+7.6+328],[289.1092834472656,585.6072998046875-100,300+328]])
var controls45 = controlsPointTransformation([[260.7643127441406,622.81005859375-100,300+364],[266.0789794921875,621.0385131835938-100,300+4+364],[273.1652526855469,621.0385131835938-100,300+4+364],[282.0230407714844,621.0385131835938-100,300+364]])

var finalPoint3 = [+300+400, 283.79461669921875,-675.9569091796875-100];
var curveNeuron2Upper = createCurveSurface2(finalPoint3, [controls35, controls36, controls37, controls38, controls39, controls40, controls41, controls42, controls43, controls44, controls45]);
DRAW(COLOR(mattBisque)(MAP(curveNeuron2Upper)(domain2)));

var controls35 = controlsPointTransformation([[250.13494873046875,296.8428649902344-100,300],[274.1138610839844,296.71685791015625-100,300-40],[293.1138610839844,296.71685791015625-100,300-40],[313.9111328125,295.0713195800781-100,300]]);
var controls36 = controlsPointTransformation([[232.22833251953125,317.4589538574219-100,300+40],[253.6783447265625,318.5879211425781-100,300-36.4+40],[276.7083740234375,319.8731689453125-100,300-36.4+40],[308.43231201171875,320.2813415527344-100,300+40]]);
var controls37 = controlsPointTransformation([[226.0191192626953,353.02081298828125-100,300+76],[248.36338806152344,351.7612609863281-100,300-32.8+76],[287.3377380371094,349.98968505859375-100,300-32.8+76],[305.0533447265625,349.98968505859375-100,300+76]]);
var controls38 = controlsPointTransformation([[244.8202667236328,385.4209289550781-100,300+112],[264.30743408203125,385.4209289550781-100,300-29.2+112],[296.1955261230469,385.4209289550781-100,300-29.2+112],[315.6827087402344,383.64935302734375-100,300+112]]);
var controls39 = controlsPointTransformation([[264.30743408203125,419.08056640625-100,300+148],[280.2514953613281,419.08056640625-100,300-25.6+148],[305.0533447265625,417.30902099609375-100,300-25.6+148],[320.99737548828125,417.30902099609375-100,300+148]]);
var controls40 = controlsPointTransformation([[271.3936767578125,449.1971130371094-100,300+184],[283.79461669921875,447.425537109375-100,300-22+184],[308.5964660644531,447.425537109375-100,300-22+184],[331.6267395019531,447.425537109375-100,300+184]])
var controls41 = controlsPointTransformation([[280.2514953613281,484.6283264160156-100,300+220],[292.65240478515625,482.8567810058594-100,300-18.4+220],[313.9111328125,484.6283264160156-100,300-18.4+220],[331.6267395019531,484.6283264160156-100,300+220]])
var controls42 = controlsPointTransformation([[280.2514953613281,514.744873046875-100,300+256],[289.1092834472656,518.2879638671875-100,300-14.8+256],[301.5102233886719,518.2879638671875-100,300-14.8+256],[312.13958740234375,520.0595703125-100,300+256]])
var controls43 = controlsPointTransformation([[264.30743408203125,555.4907836914062-100,300+292],[276.7083740234375,555.4907836914062-100,300-11.2+292],[290.880859375,555.4907836914062-100,300-11.2+292],[299.7386474609375,555.4907836914062-100,300+292]])
var controls44 = controlsPointTransformation([[260.7643127441406,585.6072998046875-100,300+328],[269.6221008300781,583.8357543945312-100,300-7.6+328],[276.7083740234375,583.8357543945312-100,300-7.6+328],[289.1092834472656,585.6072998046875-100,300+328]])
var controls45 = controlsPointTransformation([[260.7643127441406,622.81005859375-100,300+364],[266.0789794921875,621.0385131835938-100,300-4+364],[273.1652526855469,621.0385131835938-100,300-4+364],[282.0230407714844,621.0385131835938-100,300+364]])

var curveNeuron2Under = createCurveSurface2(finalPoint3, [controls35, controls36, controls37, controls38, controls39, controls40, controls41, controls42, controls43, controls44, controls45]);
DRAW(COLOR(mattBisque)(MAP(curveNeuron2Under)(domain2)));

//--------------------------------------------------------------------------------------BRANCH----------------------------------------------------------------------------------------------------

var controls46 = controlsPointTransformation([[264.3957214355469+20, 419.36602783203125+20, 500+75],[266.09210205078125+20, 421.9106140136719+20, 509+75],[266.9403076171875+20, 425.3033752441406+20, 509+75],[267.7884826660156+20, 428.2720642089844+20, 500+75]])
var controls47 = controlsPointTransformation([[208.1690673828125, 426.87451171875, 500],[209.28956604003906, 427.9949951171875, 507],[210.28956604003906, 428.9949951171875, 507],[211.13775634765625, 427.4190979003906, 500]])
var controls48 = controlsPointTransformation([[180.0002899169922, 466.0167541503906, 400],[180.84848022460938, 466.0167541503906, 405],[181.2725830078125, 466.44085693359375, 405],[182.5448760986328, 466.8649597167969, 400]])
var finalPoint4 = [500,137.59051513671875,-467.4360656738281]    
var curveNeuron2Under2 = createCurveSurface2(finalPoint4, [controls46, controls47, controls48]);
DRAW(COLOR(mattBisque)(MAP(curveNeuron2Under2)(domain2)));

var controls46 = controlsPointTransformation([[264.3957214355469+20, 419.36602783203125+20, 500+75],[266.09210205078125+20, 421.9106140136719+20, 491+75],[266.9403076171875+20, 425.3033752441406+20, 491+75],[267.7884826660156+20, 428.2720642089844+20, 500+75]])
var controls47 = controlsPointTransformation([[208.1690673828125, 426.87451171875, 500],[209.28956604003906, 427.9949951171875, 489],[210.28956604003906, 428.9949951171875, 489],[211.13775634765625, 427.4190979003906, 500]])
var controls48 = controlsPointTransformation([[180.0002899169922, 466.0167541503906, 400],[180.84848022460938, 466.0167541503906, 387],[181.2725830078125, 466.44085693359375, 387],[182.5448760986328, 466.8649597167969, 400]])
var curveNeuron2Under2 = createCurveSurface2(finalPoint4, [controls46, controls47, controls48]);
DRAW(COLOR(mattBisque)(MAP(curveNeuron2Under2)(domain2)));


//----------------------------------------------------------------------------NEURON DENDRITE 3------------------------------------------------------------------------------------------

var controls50 = controlsPointTranslation([[131.18983459472656 , 537.3367309570312, 0],[139.45428466796875 +5, 544.0985717773438, -10],[152.9779510498047 +5, 552.363037109375, -10],[160.49110412597656, 554.616943359375, 0]], -30,0,-30);
var controls51 = controlsPointTranslation([[118.72698974609375, 543.1304321289062, 0],[126.64077758789062, 548.16650390625, -9],[134.3747100830078, 553.9219970703125, -9],[148.04397583007812, 560.217041015625, 0]], -30,0,-30);
var controls52 = controlsPointTranslation([[105.95701599121094, 551.5838012695312, 0],[113.1513671875, 553.9219970703125, -8],[119.44642639160156, 556.619873046875, -8],[126.82063293457031, 560.5767822265625, 0]], -30,0,-30);
var controls53 = controlsPointTranslation([[98.40294647216797, 565.4329223632812, 0],[101.28068542480469, 565.7926635742188, -7],[105.95701599121094, 567.0516967773438, -7],[108.47503662109375, 568.4905395507812, 0]], -30,0,-30);
var controls54 = controlsPointTranslation([[94.80577087402344, 577.3036499023438, 0],[97.32379150390625, 577.4834594726562, -6],[101.10082244873047, 578.5626220703125, -6],[104.1584243774414, 579.1022338867188, 0]], -30,0,-30);
var controls55 = controlsPointTranslation([[92.47355651855469, 592.7893676757812, 0],[94.80577087402344, 593.31103515625, -5],[96.66260528564453, 594.0055541992188, -5],[98.28417205810547, 594.5460815429688, 0]], -30,0,-30);
var controls56 = controlsPointTranslation([[89.90607452392578, 612.38330078125, 0],[92.20329284667969, 613.0589599609375, -4],[94.23025512695312, 613.5994873046875, -4],[96.12207794189453, 614.275146484375, 0 ]], -30,0,-30);
var controls57 = controlsPointTranslation([[85.99269104003906, 628.2036743164062, 0],[87.47372436523438, 628.5989990234375, -3],[88.96015930175781, 629.274658203125, -3],[90.31146240234375, 630.2205200195312, -30 ]], -30,0,-30);
var controls58 = controlsPointTranslation([[76.99974822998047, 640.9736328125, 0],[78.61847686767578, 642.5923461914062, -2],[79.8185043334961, 643.6663818359375, -2],[81.67607879638672, 644.9305419921875, 0]], -30,0,-30);
var controls59 = controlsPointTranslation([[61.531890869140625, 652.3047485351562, 0],[62.43050003051758, 653.4205932617188, -1],[63.6901969909668, 654.82275390625, -1],[64.40962982177734, 655.9019165039062, 0]], -30,0,-30);
var controls60 = controlsPointTranslation([[44.6183967590332, 657.6615600585938, 0],[44.805023193359375, 659.139404296875, 0],[45.16474151611328, 660.5782470703125, 0],[45.52445602416992, 662.1969604492188, 0]], -30,0,-30);
var finalPoint5 = [27.718435287475586-45, 659.3192138671875, -30 ]

var curveNeuron3Upper = createCurveSurface2(finalPoint5, [controls50 ,controls51, controls52, controls53, controls54, controls55, controls56, controls57, controls58,controls59,controls60]);
DRAW(COLOR(mattBisque)(MAP(curveNeuron3Upper)(domain2)));

var controls50 = controlsPointTranslation([[131.18983459472656, 537.3367309570312, 0 ],[139.45428466796875 +5, 544.0985717773438, 10],[152.9779510498047 +5, 552.363037109375, 10],[160.49110412597656, 554.616943359375, 0]], -30,0,-30);
var controls51 = controlsPointTranslation([[118.72698974609375, 543.1304321289062, 0],[126.64077758789062, 548.16650390625, 9],[134.3747100830078, 553.9219970703125, 9],[148.04397583007812, 560.217041015625, 0]], -30,0,-30);
var controls52 = controlsPointTranslation([[105.95701599121094, 551.5838012695312, 0],[113.1513671875, 553.9219970703125, 8],[119.44642639160156, 556.619873046875, 8],[126.82063293457031, 560.5767822265625, 0]], -30,0,-30);
var controls53 = controlsPointTranslation([[98.40294647216797, 565.4329223632812, 0],[101.28068542480469, 565.7926635742188, 7],[105.95701599121094, 567.0516967773438, 7],[108.47503662109375, 568.4905395507812, 0]], -30,0,-30);
var controls54 = controlsPointTranslation([[94.80577087402344, 577.3036499023438, 0],[97.32379150390625, 577.4834594726562, 6],[101.10082244873047, 578.5626220703125, 6],[104.1584243774414, 579.1022338867188, 0]], -30,0,-30);
var controls55 = controlsPointTranslation([[92.47355651855469, 592.7893676757812, 0],[94.80577087402344, 593.31103515625, 5],[96.66260528564453, 594.0055541992188, 5],[98.28417205810547, 594.5460815429688, 0]], -30,0,-30);
var controls56 = controlsPointTranslation([[89.90607452392578, 612.38330078125, 0],[92.20329284667969, 613.0589599609375, 4],[94.23025512695312, 613.5994873046875, 4],[96.12207794189453, 614.275146484375, 0 ]], -30,0,-30);
var controls57 = controlsPointTranslation([[85.99269104003906, 628.2036743164062, 0],[87.47372436523438, 628.5989990234375, 3],[88.96015930175781, 629.274658203125, 3],[90.31146240234375, 630.2205200195312, -30 ]], -30,0,-30);
var controls58 = controlsPointTranslation([[76.99974822998047, 640.9736328125, 0],[78.61847686767578, 642.5923461914062, 2],[79.8185043334961, 643.6663818359375, 2],[81.67607879638672, 644.9305419921875, 0]], -30,0,-30);
var controls59 = controlsPointTranslation([[61.531890869140625, 652.3047485351562, 0],[62.43050003051758, 653.4205932617188, 1],[63.6901969909668, 654.82275390625, 1],[64.40962982177734, 655.9019165039062, 0]], -30,0,-30);
var controls60 = controlsPointTranslation([[44.6183967590332, 657.6615600585938, 0],[44.805023193359375, 659.139404296875, 0],[45.16474151611328, 660.5782470703125, 0],[45.52445602416992, 662.1969604492188, 0]], -30,0,-30);
var curveNeuron3Upper = createCurveSurface2(finalPoint5, [controls50,controls51, controls52, controls53, controls54, controls55, controls56, controls57, controls58,controls59,controls60]);
DRAW(COLOR(mattBisque)(MAP(curveNeuron3Upper)(domain2)));

//--------------------------------------------------------------------------------NEURON DENDRITE 4 -------------------------------------------------------------------------------------------

var controls01 = controlsPointTranslation([[341, 50, 0],[348, 53, -8],[355, 56, -8],[360, 58, 0]],-60,0,-100)
var controls02 = controlsPointTranslation([[368, -61, 0],[376, -61, -3],[380, -59, -3],[385, -57, 0]], -60,0,-100);
var controls03 = controlsPointTranslation([[310, -169, 0],[315, -171, 0],[319, -173, 0],[324, -174, 0]], -60,0,-100);
var finalPoint4 = [393, -246, -100];

var curveNeuron4Under = createCurveSurface2(finalPoint4, [controls01, controls02, controls03]);
DRAW(COLOR(mattBisque)(MAP(curveNeuron4Under)(domain2)));

var controls01 = controlsPointTranslation([[341, 50, 0],[348, 53, 8],[355, 56, 8],[360, 58, 0]],-60,0,-100)
var controls02 = controlsPointTranslation([[368, -61, 0],[376, -61, 3],[380, -59, 3],[385, -57, 0]], -60,0,-100);
var controls03 = controlsPointTranslation([[310, -169, 0],[315, -171, 0],[319, -173, 0],[324, -174, 0]], -60,0,-100);

var curveNeuron4Upper = createCurveSurface2(finalPoint4, [controls01, controls02, controls03]);
DRAW(COLOR(mattBisque)(MAP(curveNeuron4Upper)(domain2)));


//--------------------------------------------------------------------------------NEURON DENDRITE 5 -------------------------------------------------------------------------------------------

var controls01 = controlsPointTranslation([[133.7630157470703, 97.48199462890625, 0],[137.75601196289062, 90.82699584960938, -10],[143.08001708984375, 85.50299072265625, -10],[145.74200439453125, 82.84099578857422, 0]],-50,75,-100)
var controls02 = controlsPointTranslation([[-27.287982940673828, -10.329005241394043, 0],[-25.95698356628418, -16.984004974365234, -54],[-21.9639835357666, -23.639005661010742, 0-4],[-16.639984130859375, -32.95600509643555, 0]], -50,75,-100);
var controls03 = controlsPointTranslation([[-52.57698440551758, -163.3939971923828, 0],[-47.25298309326172, -168.71800231933594, 0],[-44.59098434448242, -170.0489959716797, 0],[-39.26698303222656, -172.71099853515625, 0]], -50,65,-100);
var finalPoint4 = [-36.604984283447266-50, -292.5010070800781+75, 0];

var curveNeuron4Under = createCurveSurface2(finalPoint4, [controls01, controls02, controls03]);
DRAW(COLOR(mattBisque)(MAP(curveNeuron4Under)(domain2)));

var controls01 = controlsPointTranslation([[133.7630157470703, 97.48199462890625, 0],[137.75601196289062, 90.82699584960938, 10],[143.08001708984375, 85.50299072265625, 10],[145.74200439453125, 82.84099578857422, 0]],-50,75,-100)
var controls02 = controlsPointTranslation([[-27.287982940673828, -10.329005241394043, 0],[-25.95698356628418, -16.984004974365234, 4],[-21.9639835357666, -23.639005661010742, 4],[-16.639984130859375, -32.95600509643555, 0]], -50,75,-100);
var controls03 = controlsPointTranslation([[-52.57698440551758, -163.3939971923828, 0],[-47.25298309326172, -168.71800231933594, 0],[-44.59098434448242, -170.0489959716797, 0],[-39.26698303222656, -172.71099853515625, 0]], -50,75,-100);

var curveNeuron4Upper = createCurveSurface2(finalPoint4, [controls01, controls02, controls03]);
DRAW(COLOR(mattBisque)(MAP(curveNeuron4Upper)(domain2)));

//------------------------------------------------------------------------------SECOND BRANCH--------------------------------------------------------------------------------

var con28 = [[-721.7300415039062,226.4208526611328-3,0],[-720.1238403320312,226.85365295410156-3,0],[-718.430419921875,227.98260498046875-4.3,0],[-717.8659057617188,228.54708862304688-4.3,0]]
var con29 = controlsPointTranslation([[-733.5193481445312,238.210205078125,0],[-731.4132690429688,238.70761108398438,0],[-729.69580078125,239.80335998535156,0],[-728.7399291992188,241.077880859375,0]],0,+7,0);
var con30 = controlsPointTranslation([[-771.7550659179688,246.49459838867188,0],[-772.055419921875,247.73919677734375,0],[-771.490966796875,249.4326171875,0],[-772.055419921875,251.12603759765625,0]],0,+7,0);
var con31 = controlsPointTranslation([[-833.2508544921875,242.35240173339844,0],[-833.5830688476562,243.22340393066406,0],[-834.5253295898438,244.26419067382812,0],[-835.16259765625,245.22007751464844,0]],0,+7,0);
var finalpoint12 = [-881.5633544921875,251.12603759765625+7,0];
var curveDendrite12 = createCurveSurface2(finalpoint12, [con28, con29, con30, con31]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite12)(domain2)));


var con32 = controlsPointTranslation([[-873.7169189453125,249.99954223632812,0],[-872.4424438476562,249.99954223632812,0],[-872.4424438476562,249.99954223632812,0],[-871.4865112304688,249.99954223632812,0]],+15,+5,0);
var finalPoint13 = [-880.0895385742188+15,237.57293701171875+5,0];
var curveDendrite13 = createCurveSurface2(finalPoint13, [con32]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite13)(domain2)));

var con33 = [[-873.7169189453125+9,249.99954223632812+6,0],[-872.4424438476562+9,249.99954223632812+6,0],[-872.4424438476562+9,249.99954223632812+6,0],[-871.4865112304688+9,249.99954223632812+6,0]]
var finalPoint14 = [-875.3101196289062+9,260.19573974609375+6.5,0];
var curveDendrite14 = createCurveSurface2(finalPoint14, [con33]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite14)(domain2)));

var con34 = [[-823.373291015625,242.35240173339844+12,0],[-822.0987548828125,242.35240173339844+12,0],[-820.505615234375,242.35240173339844+12,0],[-819.5496826171875,242.35240173339844+12,0]]
var finalPoint15 = [-827.8341064453125,197.42544555664062+12,0];
var curveDendrite15 = createCurveSurface2(finalPoint15, [con34]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite15)(domain2)));

var con35 = [[-824.3291625976562-2.5,216.22467041015625,0],[-824.6478271484375-2.5,214.31288146972656,0],[-824.6478271484375-2.5,214.31288146972656,0],[-824.6478271484375-2.5,213.03836059570312,0]]
var finalPoint16 = [-843.12841796875-2.5,205.0725860595703,0]
var curveDendrite16 = createCurveSurface2(finalPoint16, [con35]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite16)(domain2)));

var con36 = [[-824.3291625976562-1,216.22467041015625+12,0],[-824.6478271484375-1,214.31288146972656+12,0],[-824.6478271484375-1,214.31288146972656+12,0],[-824.6478271484375-1,213.03836059570312+12,0]]
var finalPoint17 = [-810.3093872070312,199.9744873046875+12,0];
var curveDendrite17 = createCurveSurface2(finalPoint17, [con36]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite17)(domain2)));

var con37 = [[-831.8896484375+9,240.96551513671875+1,0],[-831.8896484375+6,241.5299835205078,0],[-831.3251953125+7,240.96551513671875,0],[-830.1962280273438+7,239.27207946777344,0]]
var finalPoint18 = [-874.7896728515625+6,198.6299591064453,0]
var curveDendrite18 = createCurveSurface2(finalPoint18, [con37]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite18)(domain2)));

var con38 = [[-866.7070922851562+6,205.39122009277344+1,0],[-866.388427734375+6,205.39122009277344+1,0],[-866.06982421875+6,206.34710693359375+1,0],[-865.1138916015625+6,206.66574096679688+1,0]]
var finalPoint19 = [-862.2462158203125+6,192.96461486816406+0.5,0];
var curveDendrite19 = createCurveSurface2(finalPoint19, [con38]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite19)(domain2)));

var con39 = [[-866.7070922851562+5,205.39122009277344,0],[-866.388427734375+5,205.39122009277344,0],[-866.06982421875+5,206.34710693359375,0],[-865.1138916015625+5,206.66574096679688,0]]
var finalPoint20 = [-882.9572143554688+5,212.40109252929688,0];
var curveDendrite20 = createCurveSurface2(finalPoint20, [con39]);
DRAW(COLOR(mattBisque)(MAP(curveDendrite20)(domain2)));

//--------------------------------------------------------------------------------SYNAPSIS-------------------------------------------------------------------------------------------

//Synapsy 1
var cp1 =[-752.65576171875, 213.56027221679688, 0]
var cp2 =[[-752.202880859375, 211.87811279296875, 0],[-752.073486328125, 213.20443725585938, -1.5],[-752.073486328125, 213.81906127929688, -1.5],[-752.0411376953125, 215.2100830078125,0]]
var cp3 =[[-750.908935546875, 211.2311248779297, 0],[-750.8118896484375, 212.2663116455078, -2],[-750.71484375, 214.75718688964844, -2],[-750.6824951171875, 215.72767639160156,0]]
var cp4 =[[-749.5502319335938, 211.74871826171875, 0],[-749.5178833007812, 213.0103302001953, -1.5],[-749.5178833007812, 214.04551696777344, -1.5],[-749.3884887695312, 215.1453857421875,0]]
var cp5 =[-749.0326538085938, 213.43087768554688, 0]

var curve = createCurveSurface(cp1, cp5, [cp2,cp3,cp4]);
DRAW (COLOR(mattDarkOrange)(MAP(curve)(domain2)));

//Synapsy 2
var cp1 =[-752.65576171875+4, 213.56027221679688+4, 0]
var cp2 =controlsPointTranslation([[-752.202880859375, 211.87811279296875, 0],[-752.073486328125, 213.20443725585938, -1.5],[-752.073486328125, 213.81906127929688, -1.5],[-752.0411376953125, 215.2100830078125,0]],4,4,0)
var cp3 =controlsPointTranslation([[-750.908935546875, 211.2311248779297, 0],[-750.8118896484375, 212.2663116455078, -2],[-750.71484375, 214.75718688964844, -2],[-750.6824951171875, 215.72767639160156,0]],4,4,0)
var cp4 =controlsPointTranslation([[-749.5502319335938, 211.74871826171875, 0],[-749.5178833007812, 213.0103302001953, -1.5],[-749.5178833007812, 214.04551696777344, -1.5],[-749.3884887695312, 215.1453857421875,0]],4,4,0)
var cp5 =[-749.0326538085938+4, 213.43087768554688+4, 0]

var curve = createCurveSurface(cp1, cp5, [cp2,cp3,cp4]);
DRAW (COLOR(mattDarkOrange)(MAP(curve)(domain2)));

//Synapsy 3
var cp1 =[-752.65576171875-8, 213.56027221679688+8, 0]
var cp2 =controlsPointTranslation([[-752.202880859375, 211.87811279296875, 0],[-752.073486328125, 213.20443725585938, -1.5],[-752.073486328125, 213.81906127929688, -1.5],[-752.0411376953125, 215.2100830078125,0]],-8,8,0)
var cp3 =controlsPointTranslation([[-750.908935546875, 211.2311248779297, 0],[-750.8118896484375, 212.2663116455078, -2],[-750.71484375, 214.75718688964844, -2],[-750.6824951171875, 215.72767639160156,0]],-8,8,0)
var cp4 =controlsPointTranslation([[-749.5502319335938, 211.74871826171875, 0],[-749.5178833007812, 213.0103302001953, -1.5],[-749.5178833007812, 214.04551696777344, -1.5],[-749.3884887695312, 215.1453857421875,0]],-8,8,0)
var cp5 =[-749.03265380859388-8, 213.430877685546888+8, 0]

var curve = createCurveSurface(cp1, cp5, [cp2,cp3,cp4]);
DRAW (COLOR(mattDarkOrange)(MAP(curve)(domain2)));

//Synapsy 4
var cp1 =[-752.65576171875-18, 213.56027221679688+10, 0]
var cp2 =controlsPointTranslation([[-752.202880859375, 211.87811279296875, 0],[-752.073486328125, 213.20443725585938, -1.5],[-752.073486328125, 213.81906127929688, -1.5],[-752.0411376953125, 215.2100830078125,0]],-18,10,0)
var cp3 =controlsPointTranslation([[-750.908935546875, 211.2311248779297, 0],[-750.8118896484375, 212.2663116455078, -2],[-750.71484375, 214.75718688964844, -2],[-750.6824951171875, 215.72767639160156,0]],-18,10,0)
var cp4 =controlsPointTranslation([[-749.5502319335938, 211.74871826171875, 0],[-749.5178833007812, 213.0103302001953, -1.5],[-749.5178833007812, 214.04551696777344, -1.5],[-749.3884887695312, 215.1453857421875,0]],-18,10,0)
var cp5 =[-749.03265380859388-18, 213.430877685546888+10, 0]

var curve = createCurveSurface(cp1, cp5, [cp2,cp3,cp4]);
DRAW (COLOR(mattDarkOrange)(MAP(curve)(domain2)));

//Synapsy 5
var cp1 =[-752.65576171875-14, 213.56027221679688+4, 0]
var cp2 =controlsPointTranslation([[-752.202880859375, 211.87811279296875, 0],[-752.073486328125, 213.20443725585938, -1.5],[-752.073486328125, 213.81906127929688, -1.5],[-752.0411376953125, 215.2100830078125,0]],-14,4,0)
var cp3 =controlsPointTranslation([[-750.908935546875, 211.2311248779297, 0],[-750.8118896484375, 212.2663116455078, -2],[-750.71484375, 214.75718688964844, -2],[-750.6824951171875, 215.72767639160156,0]],-14,4,0)
var cp4 =controlsPointTranslation([[-749.5502319335938, 211.74871826171875, 0],[-749.5178833007812, 213.0103302001953, -1.5],[-749.5178833007812, 214.04551696777344, -1.5],[-749.3884887695312, 215.1453857421875,0]],-14,4,0)
var cp5 =[-749.03265380859388-14, 213.430877685546888+4, 0]

var curve = createCurveSurface(cp1, cp5, [cp2,cp3,cp4]);
DRAW (COLOR(mattDarkOrange)(MAP(curve)(domain2)));

//Synapsy 6
var cp1 =[-752.65576171875-22, 213.56027221679688+6, 0]
var cp2 =controlsPointTranslation([[-752.202880859375, 211.87811279296875, 0],[-752.073486328125, 213.20443725585938, -1.5],[-752.073486328125, 213.81906127929688, -1.5],[-752.0411376953125, 215.2100830078125,0]],-22,6,0)
var cp3 =controlsPointTranslation([[-750.908935546875, 211.2311248779297, 0],[-750.8118896484375, 212.2663116455078, -2],[-750.71484375, 214.75718688964844, -2],[-750.6824951171875, 215.72767639160156,0]],-22,6,0)
var cp4 =controlsPointTranslation([[-749.5502319335938, 211.74871826171875, 0],[-749.5178833007812, 213.0103302001953, -1.5],[-749.5178833007812, 214.04551696777344, -1.5],[-749.3884887695312, 215.1453857421875,0]],-22,6,0)
var cp5 =[-749.03265380859388-22, 213.430877685546888+6, 0]

var curve = createCurveSurface(cp1, cp5, [cp2,cp3,cp4]);
DRAW (COLOR(mattDarkOrange)(MAP(curve)(domain2)));

//Synapsy 7
var cp1 =[-752.65576171875-14, 213.56027221679688+18, 0]
var cp2 =controlsPointTranslation([[-752.202880859375, 211.87811279296875, 0],[-752.073486328125, 213.20443725585938, -1.5],[-752.073486328125, 213.81906127929688, -1.5],[-752.0411376953125, 215.2100830078125,0]],-14,18,0)
var cp3 =controlsPointTranslation([[-750.908935546875, 211.2311248779297, 0],[-750.8118896484375, 212.2663116455078, -2],[-750.71484375, 214.75718688964844, -2],[-750.6824951171875, 215.72767639160156,0]],-14,18,0)
var cp4 =controlsPointTranslation([[-749.5502319335938, 211.74871826171875, 0],[-749.5178833007812, 213.0103302001953, -1.5],[-749.5178833007812, 214.04551696777344, -1.5],[-749.3884887695312, 215.1453857421875,0]],-14,18,0)
var cp5 =[-749.03265380859388-14, 213.430877685546888+18, 0]

var curve = createCurveSurface(cp1, cp5, [cp2,cp3,cp4]);
DRAW (COLOR(mattDarkOrange)(MAP(curve)(domain2)));




